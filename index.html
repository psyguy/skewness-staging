<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="MH Manuel Haqiqatkhah">

<title>Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="Code documentations_files/libs/clipboard/clipboard.min.js"></script>
<script src="Code documentations_files/libs/quarto-html/quarto.js"></script>
<script src="Code documentations_files/libs/quarto-html/popper.min.js"></script>
<script src="Code documentations_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Code documentations_files/libs/quarto-html/anchor.min.js"></script>
<link href="Code documentations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Code documentations_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Code documentations_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Code documentations_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Code documentations_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Code documentations_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Code documentations_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="Code documentations_files/libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="Code documentations_files/libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-introduction" id="toc-sec-introduction" class="nav-link active" data-scroll-target="#sec-introduction"><span class="toc-section-number">0</span>  Introduction</a></li>
  <li><a href="#sec-components" id="toc-sec-components" class="nav-link" data-scroll-target="#sec-components"><span class="toc-section-number">1</span>  Core components</a>
  <ul>
  <li><a href="#sec-simulation-component" id="toc-sec-simulation-component" class="nav-link" data-scroll-target="#sec-simulation-component"><span class="toc-section-number">1.1</span>  The <em>Simulation</em> component</a>
  <ul>
  <li><a href="#sec-dgm-specifications" id="toc-sec-dgm-specifications" class="nav-link" data-scroll-target="#sec-dgm-specifications"><span class="toc-section-number">1.1.1</span>  Data-generating models specifications</a></li>
  <li><a href="#sec-general-dgm-wrappers" id="toc-sec-general-dgm-wrappers" class="nav-link" data-scroll-target="#sec-general-dgm-wrappers"><span class="toc-section-number">1.1.2</span>  General DGM wrappers</a></li>
  <li><a href="#sec-dataset-generation" id="toc-sec-dataset-generation" class="nav-link" data-scroll-target="#sec-dataset-generation"><span class="toc-section-number">1.1.3</span>  Dataset generation</a></li>
  </ul></li>
  <li><a href="#sec-analysis-component" id="toc-sec-analysis-component" class="nav-link" data-scroll-target="#sec-analysis-component"><span class="toc-section-number">1.2</span>  The <em>Analysis</em> component</a></li>
  <li><a href="#sec-harvesting-component" id="toc-sec-harvesting-component" class="nav-link" data-scroll-target="#sec-harvesting-component"><span class="toc-section-number">1.3</span>  The <em>Harvesting</em> component</a></li>
  <li><a href="#sec-reporting-component" id="toc-sec-reporting-component" class="nav-link" data-scroll-target="#sec-reporting-component"><span class="toc-section-number">1.4</span>  The <em>Reporting</em> component</a>
  <ul>
  <li><a href="#sec-report-clean-harvest" id="toc-sec-report-clean-harvest" class="nav-link" data-scroll-target="#sec-report-clean-harvest"><span class="toc-section-number">1.4.1</span>  Cleaning the harvested dataset</a></li>
  <li><a href="#sec-make-distribution-plots" id="toc-sec-make-distribution-plots" class="nav-link" data-scroll-target="#sec-make-distribution-plots"><span class="toc-section-number">1.4.2</span>  Making distribution plots of simulated datasets</a></li>
  <li><a href="#sec-report-estimation-plots" id="toc-sec-report-estimation-plots" class="nav-link" data-scroll-target="#sec-report-estimation-plots"><span class="toc-section-number">1.4.3</span>  Making plots of estimation results</a></li>
  <li><a href="#sec-report-caterpillar-plots" id="toc-sec-report-caterpillar-plots" class="nav-link" data-scroll-target="#sec-report-caterpillar-plots"><span class="toc-section-number">1.4.4</span>  Making plots of parameter estimates coverage</a></li>
  <li><a href="#making-plots-for-dgm-time-series" id="toc-making-plots-for-dgm-time-series" class="nav-link" data-scroll-target="#making-plots-for-dgm-time-series"><span class="toc-section-number">1.4.5</span>  Making plots for DGM time series</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-pipeline" id="toc-sec-pipeline" class="nav-link" data-scroll-target="#sec-pipeline"><span class="toc-section-number">2</span>  Pipeline</a>
  <ul>
  <li><a href="#sec-bookkeeping" id="toc-sec-bookkeeping" class="nav-link" data-scroll-target="#sec-bookkeeping"><span class="toc-section-number">2.1</span>  Book-keeping</a></li>
  <li><a href="#sec-pipeline-functions" id="toc-sec-pipeline-functions" class="nav-link" data-scroll-target="#sec-pipeline-functions"><span class="toc-section-number">2.2</span>  Pipeline functions</a></li>
  <li><a href="#sec-pipeline-code" id="toc-sec-pipeline-code" class="nav-link" data-scroll-target="#sec-pipeline-code"><span class="toc-section-number">2.3</span>  Pipeline code</a></li>
  </ul></li>
  <li><a href="#sec-simulation-results" id="toc-sec-simulation-results" class="nav-link" data-scroll-target="#sec-simulation-results"><span class="toc-section-number">3</span>  Simulation results</a>
  <ul>
  <li><a href="#plots-main-results" id="toc-plots-main-results" class="nav-link" data-scroll-target="#plots-main-results"><span class="toc-section-number">3.1</span>  Plots main results</a></li>
  <li><a href="#plots-of-mcmc-parameter-estimates-coverage" id="toc-plots-of-mcmc-parameter-estimates-coverage" class="nav-link" data-scroll-target="#plots-of-mcmc-parameter-estimates-coverage"><span class="toc-section-number">3.2</span>  Plots of MCMC parameter estimates coverage</a></li>
  </ul></li>
  <li><a href="#sec-additional-analyses-and-figures" id="toc-sec-additional-analyses-and-figures" class="nav-link" data-scroll-target="#sec-additional-analyses-and-figures"><span class="toc-section-number">4</span>  Additional figures and analyses</a>
  <ul>
  <li><a href="#sec-additional-DGM-time-series-plots" id="toc-sec-additional-DGM-time-series-plots" class="nav-link" data-scroll-target="#sec-additional-DGM-time-series-plots"><span class="toc-section-number">4.1</span>  DGM time series plots</a></li>
  <li><a href="#sec-profiles-of-simulated-datasets" id="toc-sec-profiles-of-simulated-datasets" class="nav-link" data-scroll-target="#sec-profiles-of-simulated-datasets"><span class="toc-section-number">4.2</span>  Profiles of the simulated datasets</a></li>
  <li><a href="#sec-cogito-data-analysis" id="toc-sec-cogito-data-analysis" class="nav-link" data-scroll-target="#sec-cogito-data-analysis"><span class="toc-section-number">4.3</span>  COGITO data analysis</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Reproducible codes</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>MH Manuel Haqiqatkhah </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="sec-introduction" class="level1" data-number="0">
<h1 data-number="0"><span class="header-section-number">0</span> Introduction</h1>
<p>This document contains the reproducible code for the manuscript <em>Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?</em> by <span class="citation" data-cites="haqiqatkhah_2022_SkewnessStagingDoes">Haqiqatkhah, Ryan, and Hamaker (<a href="#ref-haqiqatkhah_2022_SkewnessStagingDoes" role="doc-biblioref">2022</a>)</span>. Please cite this document with the following info:</p>
<blockquote class="blockquote">
<p>Haqiqatkhah, M. M., Ryan, O., &amp; Hamaker, E. L. (2022). <em>Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?</em> PsyArXiv. <a href="https://doi.org/10.31234/osf.io/myuvr" class="uri">https://doi.org/10.31234/osf.io/myuvr</a></p>
</blockquote>
<p>In this study, we simulated multilevel data from three data generating mechanisms (DGMs), namely, the AR(1), <span class="math inline">\(\chi^2\)</span>AR(1), BinAR(1), and PoDAR(1) models with different parameter sets. The simulation was conducted using the following modular pipeline design, inspired by Bien’s R package <code>simulator</code> <span class="citation" data-cites="bien_2016_SimulatorEngineStreamline">(<a href="#ref-bien_2016_SimulatorEngineStreamline" role="doc-biblioref">2016</a>)</span>, consisting of the following <strong>components</strong>:</p>
<ol type="A">
<li><em>Simulation</em>: generating the datasets</li>
<li><em>Analysis</em>: modeling the data</li>
<li><em>Harvesting</em>: collecting the relevant parameter estimates</li>
<li><em>Reporting</em>: making tables and plots</li>
</ol>
<p>And the components were placed in a <strong>pipeline</strong>, that managed:</p>
<ol type="1">
<li>Making the simulation design matrix that include all relevant conditions</li>
<li>Book-keeping data files belonging to each replication of each condition</li>
<li>Performing simulations in batch</li>
<li>Performing Analyses in batch</li>
<li>Collecting the data in batch</li>
</ol>
<p>This document is structured as follows. In <a href="#sec-components">Section&nbsp;1</a>, we explain the four components and the functions used therein. Then, in <a href="#sec-pipeline">Section&nbsp;2</a> we explain the wrapper functions used in the pipeline, and show how the pipeline was—and can be—executed. Then, in <a href="#sec-simulation-results">Section&nbsp;3</a>, we discuss how the harvested data was used to make the figures used in the paper (and others that were not included). Finally, in <a href="#sec-additional-analyses-and-figures">Section&nbsp;4</a> we discuss how supplementary plots were made and how the empirical data analysis [on COGITO data; <span class="citation" data-cites="schmiedek_2010_HundredDaysCognitive">Schmiedek, Lövdén, and Lindenberger (<a href="#ref-schmiedek_2010_HundredDaysCognitive" role="doc-biblioref">2010</a>)</span>] was done. Note that although the codes provided here are cleaned as much as possible, they are not necessarily succinctly written; some functions were written to accommodate the most general functionalities which turned out to be not necessary for the simulation study.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Addendum: Version 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Following a request from a reviewer to implement and run another set of analyses, some additional functions and adaptations have been made. These changes are specified with <code>v2</code> throughout this document and in codes and do not change the legacy code and text.</p>
</div>
</div>
<p>The <a href="https://github.com/psyguy/skewness-staging">GitHub <i class="fa-brands fa-github" aria-label="github"></i> repository of this study</a> contains all of the code necessary to run the study (in the <code>scripts</code> folder <a href="https://github.com/psyguy/skewness-staging/tree/main/scripts"><i class="fa-solid fa-globe" aria-label="globe"></i></a>). Furthermore, because running the whole study would take a huge amount of time (it took us more than 88 days on a 24-core server and produced 2.69 TB of data), the the raw and summarized datasets of the estimated parameters are provided in <code>simulation-files/harvests</code> <a href="https://github.com/psyguy/skewness-staging/tree/main/simulation-files/harvest-files"><i class="fa-solid fa-globe" aria-label="globe"></i></a>. To give an impression of the simulated datasets and the analysis output files, the <code>.rds</code> files of the first replication of the study are also provided in <code>simulation-files</code> folder <a href="https://github.com/psyguy/skewness-staging/tree/main/simulation-files"><i class="fa-solid fa-globe" aria-label="globe"></i></a>, and the <em>M</em>plus files of the first replication of the <span class="math inline">\(N=100, T=100\)</span> condition is provided in the <code>Mplus-files</code> folder <a href="https://github.com/psyguy/skewness-staging/tree/main/Mplus-files"><i class="fa-solid fa-globe" aria-label="globe"></i></a>. Finally, all the figures that can be generated based on the study results are provided in the <code>figures</code> folder <a href="https://github.com/psyguy/skewness-staging/tree/main/figures"><i class="fa-solid fa-globe" aria-label="globe"></i></a>. The figures are also referenced individually in <a href="#sec-simulation-results">Section&nbsp;3</a> and <a href="#sec-additional-analyses-and-figures">Section&nbsp;4</a> of this document.</p>
<p>To replicate the study from the scratch, you should first either clone the repository (using <code>git clone https://github.com/psyguy/skewness-staging.git</code>) or <a href="https://github.com/psyguy/skewness-staging/archive/refs/heads/main.zip">download the repository as a zip file <i class="fa-solid fa-download" aria-label="download"></i></a> and extract it on your machine. Then you can sequentially run the <code>.R</code> files you find in the <code>scripts</code> folder. Note that you would need to have a licensed version of <em>M</em>plus version 8.6 <span class="citation" data-cites="muthen_2017_MplusUserGuide">(<a href="#ref-muthen_2017_MplusUserGuide" role="doc-biblioref">Muthén and Muthén 2017</a>)</span> on your machine to run the whole study. Instead of running the scripts separately, if you have <a href="https://quarto.org/docs/get-started/">Quarto installed <i class="fa-solid fa-globe" aria-label="globe"></i></a>, you can also compile <code>Code documentations.qmd</code> located in the root directory using Quarto after setting the following variables to <code>TRUE</code>:</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-1_9371825e8b9a4f2a95545c5bbf41783c">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>study_RunPipeline <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>study_MakeMainPlots <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>study_MakeAdditionalPlots <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, in case you want to change the scripts (e.g., to run a smaller portion of the simulation, or try other parameters, etc.), you should look up the <code>kintr</code> parameters called in each chunk (with <code>&lt;&lt;some_param&gt;&gt;</code>) and find the corresponding code (under <code>## @knitr some_param</code>) in the <code>scripts</code> folder.</p>
</section>
<section id="sec-components" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Core components</h1>
<section id="sec-simulation-component" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-simulation-component"><span class="header-section-number">1.1</span> The <em>Simulation</em> component</h2>
<p>The Simulation component consists of three sets of functions:</p>
<ol type="i">
<li>Functions that implement the DGMs and generate univariate (<span class="math inline">\(N=1\)</span>) time series of length <span class="math inline">\(T\)</span> from the parameters given to them;</li>
<li>Wrappers that interface the DGM functions;</li>
<li>A wrapper to generate datasets (consisting on <span class="math inline">\(N\)</span> time series of length <span class="math inline">\(T\)</span>) with a given DGM</li>
</ol>
<section id="sec-dgm-specifications" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="sec-dgm-specifications"><span class="header-section-number">1.1.1</span> Data-generating models specifications</h3>
<p>First we define functions for each data-generating models (DGMs) that can produce univariate, single-subject (<span class="math inline">\(N=1\)</span>) time series of desired length <span class="math inline">\(T\)</span> (default: <code>T = 100</code>) with the two canonical parameters and a given random seed (default: <code>seed = 0</code>). All model(-implied) parameters are saved in a list (called <code>pa</code>).</p>
<p>For each model, the first observation (<span class="math inline">\(X_1\)</span>) is randomly drawn from the model-implied marginal distribution, to eliminate the need for removing the burn-in window in the beginning of the data. After the data is generated, in case the argument <code>only.ts</code> is set to be <code>TRUE</code>, the raw data (as a vector of length <code>T</code>) is returned. Otherwise, the function calculates empirical dynamic (<span class="math inline">\(\phi\)</span>) and marginal (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma^2\)</span>, and <span class="math inline">\(\gamma\)</span>) parameters based on the simulated data, and save it in a list (<code>Empirical.Parameters</code>). Furthermore, two <span class="math inline">\(\mathrm{\LaTeX{}}\)</span>-ready strings (<code>Model.Description</code> and <code>Model.Description.Short</code>) are made which include a summary of the model parameters (that can be used, e.g., in plots). Finally, in case <code>only.ts != TRUE</code>, the function returns a list consisting of the time series (stored in <code>x</code>), verbal description of the dataset (<code>Model.Description</code> and <code>Model.Description.Short</code>), theoretical (i.e., model-implied) parameters (<code>Model.Parameters</code>), and empirical (i.e., sample) estimated parameters (<code>Empirical.Parameters</code>).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">The AR(1) model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">The <span class="math inline">\(\chi^2\)</span>AR(1) model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">The BinAR(1) model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">The PoDAR(1) model</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The canonical parameters of the AR(1) model with normally distributed residuals (which we referred to as <code>NAR(1)</code> in the simulation) are the autoregressive parameter <span class="math inline">\(\phi\)</span> (default: <code>phi = 0.4</code>), mean <span class="math inline">\(\mu\)</span> (default: <code>Mean = 50</code>), and the marginal variance <span class="math inline">\(\sigma^2\)</span> (default: <code>var.marginal = 4</code>). Based on the marginal variance, the residual variance (<code>var.resid</code>) is calculated via <span class="math inline">\(\sigma^2_\epsilon = \sigma^2 (1 - \phi^2)\)</span>.</p>
<section id="construction" class="level5" data-number="1.1.1.0.1">
<h5 data-number="1.1.1.0.1" class="anchored" data-anchor-id="construction"><span class="header-section-number">1.1.1.0.1</span> Construction</h5>
<p>The time series is constructed by first generating a zero-centered time series <span class="math inline">\(\tilde X_t\)</span> (<code>x_cent</code>). To do so, first the initial observation in the time series (<code>x_cent[1]</code>) is sampled from normal distribution with mean zero and a variance equal to the marginal variance of the model:</p>
<p><span class="math display">\[
\tilde X_1 \sim \mathcal{N}(0, \sigma^2)
\]</span></p>
<p>Then, the remainder of the time series is generated using the definition of the AR(1) model (note that here the residual variance is used in the normal distribution):</p>
<p><span class="math display">\[
\begin{aligned}
\tilde X_{t} &amp;= \phi \tilde X_{t-1} + \epsilon_{t} \\
\epsilon_{t} &amp;\sim \mathcal{N}(0, {\sigma^2_{\epsilon}})
\end{aligned}
\]</span></p>
<p>Finally, the mean is added to the centered zero-centered time series to reach the final time series with mean <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
X_t = \tilde X_t + \mu
\]</span></p>
</section>
<section id="code" class="level5" data-number="1.1.1.0.2">
<h5 data-number="1.1.1.0.2" class="anchored" data-anchor-id="code"><span class="header-section-number">1.1.1.0.2</span> Code</h5>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-4_9f104b3390a1abb4d1d7294dbc3e3b75">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>dgm_nar <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="do">## setting default seed if not given</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>phi)) pa<span class="sc">$</span>phi <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>Mean)) pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>var.marginal)) pa<span class="sc">$</span>var.marginal <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>var.resid)) pa<span class="sc">$</span>var.resid <span class="ot">&lt;-</span> pa<span class="sc">$</span>var.marginal <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>T)) pa<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>seed)) pa<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="do">## Making sure var.marginal and var.resid are correctly related</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>  pa<span class="sc">$</span>var.marginal <span class="ot">&lt;-</span> pa<span class="sc">$</span>var.resid <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="do">### first make time series centered around zero</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>  <span class="do">## drawing the first sample x_cent_1</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="fu">set.seed</span>(pa<span class="sc">$</span>seed)</span>
<span id="cb2-22"><a href="#cb2-22"></a>  x_cent <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, pa<span class="sc">$</span>T)</span>
<span id="cb2-23"><a href="#cb2-23"></a>  x_cent[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>                     <span class="at">mean =</span> <span class="dv">0</span>,</span>
<span id="cb2-25"><a href="#cb2-25"></a>                     <span class="at">sd =</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>var.marginal)</span>
<span id="cb2-26"><a href="#cb2-26"></a>  )</span>
<span id="cb2-27"><a href="#cb2-27"></a></span>
<span id="cb2-28"><a href="#cb2-28"></a>  <span class="do">## making the rest of the centered time series</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>pa<span class="sc">$</span>T){</span>
<span id="cb2-30"><a href="#cb2-30"></a></span>
<span id="cb2-31"><a href="#cb2-31"></a>    x_cent[t] <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi<span class="sc">*</span>x_cent[t<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb2-32"><a href="#cb2-32"></a>                                            <span class="at">mean =</span> <span class="dv">0</span>,</span>
<span id="cb2-33"><a href="#cb2-33"></a>                                            <span class="at">sd =</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>var.resid)</span>
<span id="cb2-34"><a href="#cb2-34"></a>    )</span>
<span id="cb2-35"><a href="#cb2-35"></a>  }</span>
<span id="cb2-36"><a href="#cb2-36"></a>  <span class="do">## adding the mean to the centered time series</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>  x <span class="ot">&lt;-</span> x_cent <span class="sc">+</span> pa<span class="sc">$</span>Mean</span>
<span id="cb2-38"><a href="#cb2-38"></a></span>
<span id="cb2-39"><a href="#cb2-39"></a>  <span class="do">## quick output of raw time series without book-keeping variables/parameters</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>only.ts))</span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="cf">if</span>(pa<span class="sc">$</span>only.ts<span class="sc">==</span><span class="cn">TRUE</span>) <span class="fu">return</span>(x)</span>
<span id="cb2-42"><a href="#cb2-42"></a></span>
<span id="cb2-43"><a href="#cb2-43"></a>  Empirical.Parameters <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x),</span>
<span id="cb2-44"><a href="#cb2-44"></a>                              <span class="at">Variance =</span> <span class="fu">var</span>(x),</span>
<span id="cb2-45"><a href="#cb2-45"></a>                              <span class="at">Skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x),</span>
<span id="cb2-46"><a href="#cb2-46"></a>                              <span class="at">AR =</span> <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]</span>
<span id="cb2-47"><a href="#cb2-47"></a>  )</span>
<span id="cb2-48"><a href="#cb2-48"></a></span>
<span id="cb2-49"><a href="#cb2-49"></a>  <span class="do">## making a LaTeX-ready list description of the model</span></span>
<span id="cb2-50"><a href="#cb2-50"></a>  Model.Description <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb2-51"><a href="#cb2-51"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb2-52"><a href="#cb2-52"></a>                              <span class="st">"("</span>,</span>
<span id="cb2-53"><a href="#cb2-53"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb2-54"><a href="#cb2-54"></a>                              <span class="st">")"</span>,</span>
<span id="cb2-55"><a href="#cb2-55"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb2-56"><a href="#cb2-56"></a>                              <span class="dv">0</span>,</span>
<span id="cb2-57"><a href="#cb2-57"></a>                              <span class="st">"("</span>,</span>
<span id="cb2-58"><a href="#cb2-58"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb2-59"><a href="#cb2-59"></a>                              <span class="st">")"</span>,</span>
<span id="cb2-60"><a href="#cb2-60"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">phi = "</span>,</span>
<span id="cb2-61"><a href="#cb2-61"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>phi,<span class="dv">2</span>),</span>
<span id="cb2-62"><a href="#cb2-62"></a>                              <span class="st">"("</span>,</span>
<span id="cb2-63"><a href="#cb2-63"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR,<span class="dv">2</span>),</span>
<span id="cb2-64"><a href="#cb2-64"></a>                              <span class="st">")"</span>,</span>
<span id="cb2-65"><a href="#cb2-65"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2_{marginal} = "</span>,</span>
<span id="cb2-66"><a href="#cb2-66"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>var.marginal,<span class="dv">2</span>),</span>
<span id="cb2-67"><a href="#cb2-67"></a>                              <span class="st">"("</span>,</span>
<span id="cb2-68"><a href="#cb2-68"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Variance,<span class="dv">2</span>),</span>
<span id="cb2-69"><a href="#cb2-69"></a>                              <span class="st">")"</span>,</span>
<span id="cb2-70"><a href="#cb2-70"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; T = "</span>,</span>
<span id="cb2-71"><a href="#cb2-71"></a>                              pa<span class="sc">$</span>T,</span>
<span id="cb2-72"><a href="#cb2-72"></a>                              <span class="st">"$"</span>)</span>
<span id="cb2-73"><a href="#cb2-73"></a></span>
<span id="cb2-74"><a href="#cb2-74"></a>  Model.Description.Short <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb2-75"><a href="#cb2-75"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb2-76"><a href="#cb2-76"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2_{</span><span class="sc">\\</span><span class="st">epsilon} = "</span>,</span>
<span id="cb2-77"><a href="#cb2-77"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>var.resid, <span class="dv">2</span>),</span>
<span id="cb2-78"><a href="#cb2-78"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">phi = "</span>,</span>
<span id="cb2-79"><a href="#cb2-79"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>phi, <span class="dv">2</span>),</span>
<span id="cb2-80"><a href="#cb2-80"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rightarrow"</span>,</span>
<span id="cb2-81"><a href="#cb2-81"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2 = "</span>,</span>
<span id="cb2-82"><a href="#cb2-82"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Variance,<span class="dv">2</span>),</span>
<span id="cb2-83"><a href="#cb2-83"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb2-84"><a href="#cb2-84"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb2-85"><a href="#cb2-85"></a>                                    <span class="st">"$"</span>)</span>
<span id="cb2-86"><a href="#cb2-86"></a></span>
<span id="cb2-87"><a href="#cb2-87"></a></span>
<span id="cb2-88"><a href="#cb2-88"></a>  <span class="do">## making the output object</span></span>
<span id="cb2-89"><a href="#cb2-89"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x,</span>
<span id="cb2-90"><a href="#cb2-90"></a>                 <span class="at">Model.Description =</span> Model.Description,</span>
<span id="cb2-91"><a href="#cb2-91"></a>                 <span class="at">Model.Description.Short =</span> Model.Description.Short,</span>
<span id="cb2-92"><a href="#cb2-92"></a>                 <span class="at">Model.Parameters =</span> pa,</span>
<span id="cb2-93"><a href="#cb2-93"></a>                 <span class="at">Empirical.Parameters =</span> Empirical.Parameters)</span>
<span id="cb2-94"><a href="#cb2-94"></a></span>
<span id="cb2-95"><a href="#cb2-95"></a>  <span class="fu">return</span>(output)</span>
<span id="cb2-96"><a href="#cb2-96"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The canonical parameters of the <span class="math inline">\(\chi^2\)</span>AR(1) model (which we referred to as <code>ChiAR(1)</code> in the simulation) are the autoregressive parameter <span class="math inline">\(\phi\)</span> (default: <code>phi = 0.4</code>), and degrees of freedom <span class="math inline">\(\nu\)</span> (default: <code>nu = 3</code>). We set the intercept to zero (<code>c = 0</code>).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="construction-1" class="level5" data-number="1.1.1.0.3">
<h5 data-number="1.1.1.0.3" class="anchored" data-anchor-id="construction-1"><span class="header-section-number">1.1.1.0.3</span> Construction</h5>
<p>Similar to the AR(1) model, we need to sample the first observation of the <span class="math inline">\(\chi^2\)</span>AR(1) model from its marginal distribution. However, since this model does not have a closed-form marginal distribution, as an approximation, we instead sample <code>x[1]</code> from a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(\nu\)</span> degrees of freedom:</p>
<p><span class="math display">\[
X_1 \sim \chi^2(\nu)
\]</span></p>
<p>Then, we generate the remainder of the time series using the definition of the <span class="math inline">\(\chi^2\)</span>AR(1) model:</p>
<p><span class="math display">\[
\begin{aligned}
X_{t} &amp;= c + \phi X_{t-1} + a_{t} \\
a_{t} &amp;\sim \chi^2(\nu).
\end{aligned}
\]</span></p>
</section>
<section id="code-1" class="level5" data-number="1.1.1.0.4">
<h5 data-number="1.1.1.0.4" class="anchored" data-anchor-id="code-1"><span class="header-section-number">1.1.1.0.4</span> Code</h5>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-5_6f5049e009b4ac4e5e973cf814c18e34">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>dgm_chiar <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="do">## setting default seed if not given</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>phi)) pa<span class="sc">$</span>phi <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>nu)) pa<span class="sc">$</span>nu <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>c)) pa<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>T)) pa<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>seed)) pa<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="do">## drawing the first sample x_1</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="fu">set.seed</span>(pa<span class="sc">$</span>seed)</span>
<span id="cb3-17"><a href="#cb3-17"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, pa<span class="sc">$</span>T)</span>
<span id="cb3-18"><a href="#cb3-18"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb3-19"><a href="#cb3-19"></a>                 <span class="at">df =</span> pa<span class="sc">$</span>Mean)</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="do">## making the rest of the time series</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>pa<span class="sc">$</span>T){</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a>    x[t] <span class="ot">&lt;-</span> pa<span class="sc">$</span>c <span class="sc">+</span> pa<span class="sc">$</span>phi<span class="sc">*</span>x[t<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rchisq</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb3-25"><a href="#cb3-25"></a>                                          <span class="at">df =</span> pa<span class="sc">$</span>nu)</span>
<span id="cb3-26"><a href="#cb3-26"></a>  }</span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a>  <span class="do">## quick output of raw time series without book-keeping variables/parameters</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>only.ts))</span>
<span id="cb3-30"><a href="#cb3-30"></a>    <span class="cf">if</span>(pa<span class="sc">$</span>only.ts<span class="sc">==</span><span class="cn">TRUE</span>) <span class="fu">return</span>(x)</span>
<span id="cb3-31"><a href="#cb3-31"></a></span>
<span id="cb3-32"><a href="#cb3-32"></a>  Empirical.Parameters <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x),</span>
<span id="cb3-33"><a href="#cb3-33"></a>                              <span class="at">Variance =</span> <span class="fu">var</span>(x),</span>
<span id="cb3-34"><a href="#cb3-34"></a>                              <span class="at">Skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x),</span>
<span id="cb3-35"><a href="#cb3-35"></a>                              <span class="at">AR =</span> <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]</span>
<span id="cb3-36"><a href="#cb3-36"></a>  )</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>  <span class="do">## making a LaTeX-ready list description of the model</span></span>
<span id="cb3-39"><a href="#cb3-39"></a>  Model.Description <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2AR(1):"</span>, <span class="co"># \\; with",</span></span>
<span id="cb3-40"><a href="#cb3-40"></a>                              <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb3-41"><a href="#cb3-41"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb3-42"><a href="#cb3-42"></a>                              <span class="st">"("</span>,</span>
<span id="cb3-43"><a href="#cb3-43"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb3-44"><a href="#cb3-44"></a>                              <span class="st">")"</span>,</span>
<span id="cb3-45"><a href="#cb3-45"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb3-46"><a href="#cb3-46"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb3-47"><a href="#cb3-47"></a>                              <span class="st">"("</span>,</span>
<span id="cb3-48"><a href="#cb3-48"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb3-49"><a href="#cb3-49"></a>                              <span class="st">")"</span>,</span>
<span id="cb3-50"><a href="#cb3-50"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">phi = "</span>,</span>
<span id="cb3-51"><a href="#cb3-51"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>phi,<span class="dv">2</span>),</span>
<span id="cb3-52"><a href="#cb3-52"></a>                              <span class="st">"("</span>,</span>
<span id="cb3-53"><a href="#cb3-53"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR,<span class="dv">2</span>),</span>
<span id="cb3-54"><a href="#cb3-54"></a>                              <span class="st">")"</span>,</span>
<span id="cb3-55"><a href="#cb3-55"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">nu = "</span>,</span>
<span id="cb3-56"><a href="#cb3-56"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>nu,<span class="dv">2</span>),</span>
<span id="cb3-57"><a href="#cb3-57"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; c = "</span>,</span>
<span id="cb3-58"><a href="#cb3-58"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>c,<span class="dv">3</span>),</span>
<span id="cb3-59"><a href="#cb3-59"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; T = "</span>,</span>
<span id="cb3-60"><a href="#cb3-60"></a>                              pa<span class="sc">$</span>T,</span>
<span id="cb3-61"><a href="#cb3-61"></a>                              <span class="st">"$"</span>)</span>
<span id="cb3-62"><a href="#cb3-62"></a></span>
<span id="cb3-63"><a href="#cb3-63"></a>  Model.Description.Short <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$c = "</span>,</span>
<span id="cb3-64"><a href="#cb3-64"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>c,<span class="dv">2</span>),</span>
<span id="cb3-65"><a href="#cb3-65"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">nu = "</span>,</span>
<span id="cb3-66"><a href="#cb3-66"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>nu, <span class="dv">2</span>),</span>
<span id="cb3-67"><a href="#cb3-67"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">phi = "</span>,</span>
<span id="cb3-68"><a href="#cb3-68"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>phi, <span class="dv">2</span>),</span>
<span id="cb3-69"><a href="#cb3-69"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rightarrow"</span>,</span>
<span id="cb3-70"><a href="#cb3-70"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb3-71"><a href="#cb3-71"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb3-72"><a href="#cb3-72"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2 = "</span>,</span>
<span id="cb3-73"><a href="#cb3-73"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Variance,<span class="dv">2</span>),</span>
<span id="cb3-74"><a href="#cb3-74"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb3-75"><a href="#cb3-75"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb3-76"><a href="#cb3-76"></a>                                    <span class="st">"$"</span>)</span>
<span id="cb3-77"><a href="#cb3-77"></a>  <span class="do">## making the output object</span></span>
<span id="cb3-78"><a href="#cb3-78"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x,</span>
<span id="cb3-79"><a href="#cb3-79"></a>                 <span class="at">Model.Description =</span> Model.Description,</span>
<span id="cb3-80"><a href="#cb3-80"></a>                 <span class="at">Model.Description.Short =</span> Model.Description.Short,</span>
<span id="cb3-81"><a href="#cb3-81"></a>                 <span class="at">Model.Parameters =</span> pa,</span>
<span id="cb3-82"><a href="#cb3-82"></a>                 <span class="at">Empirical.Parameters =</span> Empirical.Parameters)</span>
<span id="cb3-83"><a href="#cb3-83"></a></span>
<span id="cb3-84"><a href="#cb3-84"></a>  <span class="fu">return</span>(output)</span>
<span id="cb3-85"><a href="#cb3-85"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The canonical parameters of the BinAR(1) model (which we referred to as <code>BinAR(1)</code> in the simulation) are the survival probability <span class="math inline">\(\alpha\)</span> (default: <code>alpha = 0.5</code>) and the revival probability <span class="math inline">\(\beta\)</span> (default: <code>beta = 0.4</code>). By default, the maximum value on scale <span class="math inline">\(k\)</span> was set to <code>k = 10</code>.</p>
<section id="construction-2" class="level5" data-number="1.1.1.0.5">
<h5 data-number="1.1.1.0.5" class="anchored" data-anchor-id="construction-2"><span class="header-section-number">1.1.1.0.5</span> Construction</h5>
<p>We first calculate the <span class="math inline">\(\theta\)</span> parameter, which characterizes the marginal distribution of the BinaR(1) model:</p>
<p><span class="math display">\[
\theta = \frac{k \beta}{1-(\alpha-\beta)}
\]</span> Then we draw <span class="math inline">\(X_1\)</span> (<code>x[1]</code>) from the marginal distribution of the model:</p>
<p><span class="math display">\[
X_1 \sim Binom(k, \theta)
\]</span></p>
<p>The rest of time series is generated sequentially, for each time point <span class="math inline">\(t\)</span>, by drawing values for the number of survived (<code>S_t[t]</code>) and revived (<code>R_t[t]</code>) elements of the BinAR(1) model based on the previous observations (<span class="math inline">\(X_{t-1}\)</span>), and then adding them:</p>
<p><span class="math display">\[
\begin{aligned}
S_{t} &amp;\sim Binom(X_{t-1}, \alpha) \\
R_t &amp;\sim Binom(k -X_{t-1}, \beta) \\
X_{t} &amp;= S_t + R_t
\end{aligned}
\]</span></p>
</section>
<section id="code-2" class="level5" data-number="1.1.1.0.6">
<h5 data-number="1.1.1.0.6" class="anchored" data-anchor-id="code-2"><span class="header-section-number">1.1.1.0.6</span> Code</h5>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-6_ca071e8cb2f50dcca4ea9906233fcc03">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>dgm_binar <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="do">## setting default seed if not given</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>alpha)) pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>beta)) pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>T)) pa<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>seed)) pa<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="do">## making other parameters</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>  pa<span class="sc">$</span>rho <span class="ot">&lt;-</span> pa<span class="sc">$</span>alpha <span class="sc">-</span> pa<span class="sc">$</span>beta</span>
<span id="cb4-16"><a href="#cb4-16"></a>  pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> pa<span class="sc">$</span>beta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pa<span class="sc">$</span>rho)</span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a>  <span class="do">## drawing the first sample x_1</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>  <span class="fu">set.seed</span>(pa<span class="sc">$</span>seed)</span>
<span id="cb4-21"><a href="#cb4-21"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, pa<span class="sc">$</span>T)</span>
<span id="cb4-22"><a href="#cb4-22"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-23"><a href="#cb4-23"></a>                 <span class="at">size =</span> pa<span class="sc">$</span>k ,</span>
<span id="cb4-24"><a href="#cb4-24"></a>                 <span class="at">prob =</span> pa<span class="sc">$</span>theta)</span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="do">## making the rest of the time series</span></span>
<span id="cb4-27"><a href="#cb4-27"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>pa<span class="sc">$</span>T){</span>
<span id="cb4-28"><a href="#cb4-28"></a>    S_t <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-29"><a href="#cb4-29"></a>                  <span class="at">size =</span> x[t<span class="dv">-1</span>],</span>
<span id="cb4-30"><a href="#cb4-30"></a>                  <span class="at">prob =</span> pa<span class="sc">$</span>alpha)</span>
<span id="cb4-31"><a href="#cb4-31"></a>    R_t <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-32"><a href="#cb4-32"></a>                  <span class="at">size =</span> pa<span class="sc">$</span>k <span class="sc">-</span> x[t<span class="dv">-1</span>],</span>
<span id="cb4-33"><a href="#cb4-33"></a>                  <span class="at">prob =</span> pa<span class="sc">$</span>beta)</span>
<span id="cb4-34"><a href="#cb4-34"></a>    x[t] <span class="ot">&lt;-</span> S_t <span class="sc">+</span> R_t</span>
<span id="cb4-35"><a href="#cb4-35"></a>  }</span>
<span id="cb4-36"><a href="#cb4-36"></a></span>
<span id="cb4-37"><a href="#cb4-37"></a>  <span class="do">## quick output of raw time series without book-keeping variables/parameters</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>only.ts))</span>
<span id="cb4-39"><a href="#cb4-39"></a>    <span class="cf">if</span>(pa<span class="sc">$</span>only.ts<span class="sc">==</span><span class="cn">TRUE</span>) <span class="fu">return</span>(x)</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a>  Empirical.Parameters <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x),</span>
<span id="cb4-42"><a href="#cb4-42"></a>                              <span class="at">Variance =</span> <span class="fu">var</span>(x),</span>
<span id="cb4-43"><a href="#cb4-43"></a>                              <span class="at">Skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x),</span>
<span id="cb4-44"><a href="#cb4-44"></a>                              <span class="at">AR =</span> <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]</span>
<span id="cb4-45"><a href="#cb4-45"></a>  )</span>
<span id="cb4-46"><a href="#cb4-46"></a></span>
<span id="cb4-47"><a href="#cb4-47"></a>  <span class="do">## making a LaTeX-ready list description of the model</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>  Model.Description <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$BinAR(1):"</span>,</span>
<span id="cb4-49"><a href="#cb4-49"></a>                              <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb4-50"><a href="#cb4-50"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb4-51"><a href="#cb4-51"></a>                              <span class="st">"("</span>,</span>
<span id="cb4-52"><a href="#cb4-52"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb4-53"><a href="#cb4-53"></a>                              <span class="st">")"</span>,</span>
<span id="cb4-54"><a href="#cb4-54"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb4-55"><a href="#cb4-55"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb4-56"><a href="#cb4-56"></a>                              <span class="st">"("</span>,</span>
<span id="cb4-57"><a href="#cb4-57"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb4-58"><a href="#cb4-58"></a>                              <span class="st">")"</span>,</span>
<span id="cb4-59"><a href="#cb4-59"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rho = "</span>,</span>
<span id="cb4-60"><a href="#cb4-60"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>rho,<span class="dv">3</span>),</span>
<span id="cb4-61"><a href="#cb4-61"></a>                              <span class="st">"("</span>,</span>
<span id="cb4-62"><a href="#cb4-62"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR,<span class="dv">2</span>),</span>
<span id="cb4-63"><a href="#cb4-63"></a>                              <span class="st">")"</span>,</span>
<span id="cb4-64"><a href="#cb4-64"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">alpha = "</span>,</span>
<span id="cb4-65"><a href="#cb4-65"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>alpha,<span class="dv">2</span>),</span>
<span id="cb4-66"><a href="#cb4-66"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">beta = "</span>,</span>
<span id="cb4-67"><a href="#cb4-67"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>beta,<span class="dv">2</span>),</span>
<span id="cb4-68"><a href="#cb4-68"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">theta = "</span>,</span>
<span id="cb4-69"><a href="#cb4-69"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>theta,<span class="dv">3</span>),</span>
<span id="cb4-70"><a href="#cb4-70"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; T = "</span>,</span>
<span id="cb4-71"><a href="#cb4-71"></a>                              pa<span class="sc">$</span>T,</span>
<span id="cb4-72"><a href="#cb4-72"></a>                              <span class="st">"$"</span>)</span>
<span id="cb4-73"><a href="#cb4-73"></a></span>
<span id="cb4-74"><a href="#cb4-74"></a>  Model.Description.Short <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$k ="</span>,</span>
<span id="cb4-75"><a href="#cb4-75"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>k,<span class="dv">2</span>),</span>
<span id="cb4-76"><a href="#cb4-76"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">alpha = "</span>,</span>
<span id="cb4-77"><a href="#cb4-77"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>alpha,<span class="dv">2</span>),</span>
<span id="cb4-78"><a href="#cb4-78"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">beta = "</span>,</span>
<span id="cb4-79"><a href="#cb4-79"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>beta,<span class="dv">2</span>),</span>
<span id="cb4-80"><a href="#cb4-80"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rightarrow"</span>,</span>
<span id="cb4-81"><a href="#cb4-81"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rho = "</span>,</span>
<span id="cb4-82"><a href="#cb4-82"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR, <span class="dv">2</span>),</span>
<span id="cb4-83"><a href="#cb4-83"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb4-84"><a href="#cb4-84"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb4-85"><a href="#cb4-85"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2 = "</span>,</span>
<span id="cb4-86"><a href="#cb4-86"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Variance,<span class="dv">2</span>),</span>
<span id="cb4-87"><a href="#cb4-87"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb4-88"><a href="#cb4-88"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb4-89"><a href="#cb4-89"></a>                                    <span class="st">"$"</span>)</span>
<span id="cb4-90"><a href="#cb4-90"></a>  <span class="do">## making the output object</span></span>
<span id="cb4-91"><a href="#cb4-91"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x,</span>
<span id="cb4-92"><a href="#cb4-92"></a>                 <span class="at">Model.Description =</span> Model.Description,</span>
<span id="cb4-93"><a href="#cb4-93"></a>                 <span class="at">Model.Description.Short =</span> Model.Description.Short,</span>
<span id="cb4-94"><a href="#cb4-94"></a>                 <span class="at">Model.Parameters =</span> pa,</span>
<span id="cb4-95"><a href="#cb4-95"></a>                 <span class="at">Empirical.Parameters =</span> Empirical.Parameters)</span>
<span id="cb4-96"><a href="#cb4-96"></a></span>
<span id="cb4-97"><a href="#cb4-97"></a>  <span class="fu">return</span>(output)</span>
<span id="cb4-98"><a href="#cb4-98"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>The canonical parameters of the PoDAR(1) model (which we referred to as <code>PoDAR(1)</code> in the simulation) are the persistence probability <span class="math inline">\(\tau\)</span> (default: <code>tau = 0.7</code>) and the average rate <span class="math inline">\(\lambda\)</span> (default: <code>lambda = 0.5</code>).</p>
<section id="construction-3" class="level5" data-number="1.1.1.0.7">
<h5 data-number="1.1.1.0.7" class="anchored" data-anchor-id="construction-3"><span class="header-section-number">1.1.1.0.7</span> Construction</h5>
<p>To generate the time series, we first draw the first observation <span class="math inline">\(X_1\)</span> (<code>x[1]</code>) from a Poisson distribution with rate <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[
X_1 \sim Poisson(\lambda)
\]</span></p>
<p>And generate the rest of the time series by first drawing <span class="math inline">\(Z_t\)</span> from a Poisson distribution with rate <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(P_t\)</span> from a binomial distribution with size probability of success <span class="math inline">\(\tau\)</span> (that is equivalent to a Bernoulli distribution with probability <span class="math inline">\(\tau\)</span>). Then, we calculate <span class="math inline">\(X_t\)</span> based on the previous observation (<code>x[t-1]</code>) and values of <span class="math inline">\(Z_t\)</span> (<code>Z_t[t]</code>) and <span class="math inline">\(P_t\)</span> (<code>P_t[t]</code>), using the definition of the PoDAR(1) model:</p>
<p><span class="math display">\[
\begin{aligned}
Z_t &amp;\sim Poisson(\lambda) \\
P_t &amp;\sim Binom(1, \tau) \\
X_t &amp;= P_t X_{t-1} + (1-P_t) Z_t
\end{aligned}
\]</span></p>
</section>
<section id="code-3" class="level5" data-number="1.1.1.0.8">
<h5 data-number="1.1.1.0.8" class="anchored" data-anchor-id="code-3"><span class="header-section-number">1.1.1.0.8</span> Code</h5>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-7_f5b8e0d8b0a07458adafe9bc78fbd885">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>dgm_podar <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="do">## setting default seed if not given</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>tau)) pa<span class="sc">$</span>tau <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>lambda)) pa<span class="sc">$</span>lambda <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>T)) pa<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>seed)) pa<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="do">## drawing the first sample x_1</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">set.seed</span>(pa<span class="sc">$</span>seed)</span>
<span id="cb5-17"><a href="#cb5-17"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, pa<span class="sc">$</span>T)</span>
<span id="cb5-18"><a href="#cb5-18"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb5-19"><a href="#cb5-19"></a>                <span class="at">lambda =</span> pa<span class="sc">$</span>lambda)</span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="do">## making the rest of the time series</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>pa<span class="sc">$</span>T){</span>
<span id="cb5-23"><a href="#cb5-23"></a>    V_t <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb5-24"><a href="#cb5-24"></a>                  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb5-25"><a href="#cb5-25"></a>                  <span class="at">prob =</span> pa<span class="sc">$</span>tau)</span>
<span id="cb5-26"><a href="#cb5-26"></a>    Z_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb5-27"><a href="#cb5-27"></a>                 <span class="at">lambda =</span> pa<span class="sc">$</span>lambda)</span>
<span id="cb5-28"><a href="#cb5-28"></a>    x[t] <span class="ot">&lt;-</span> V_t<span class="sc">*</span>x[t<span class="dv">-1</span>] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>V_t)<span class="sc">*</span>Z_t</span>
<span id="cb5-29"><a href="#cb5-29"></a>  }</span>
<span id="cb5-30"><a href="#cb5-30"></a></span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="do">## quick output of raw time series without book-keeping variables/parameters</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>only.ts))</span>
<span id="cb5-33"><a href="#cb5-33"></a>    <span class="cf">if</span>(pa<span class="sc">$</span>only.ts<span class="sc">==</span><span class="cn">TRUE</span>) <span class="fu">return</span>(x)</span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a>  Empirical.Parameters <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x),</span>
<span id="cb5-36"><a href="#cb5-36"></a>                              <span class="at">Variance =</span> <span class="fu">var</span>(x),</span>
<span id="cb5-37"><a href="#cb5-37"></a>                              <span class="at">Skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x),</span>
<span id="cb5-38"><a href="#cb5-38"></a>                              <span class="at">AR =</span> <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]</span>
<span id="cb5-39"><a href="#cb5-39"></a>  )</span>
<span id="cb5-40"><a href="#cb5-40"></a></span>
<span id="cb5-41"><a href="#cb5-41"></a>  <span class="do">## making a LaTeX-ready list description of the model</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>  Model.Description <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$PoDAR(1):"</span>,</span>
<span id="cb5-43"><a href="#cb5-43"></a>                              <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb5-44"><a href="#cb5-44"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb5-45"><a href="#cb5-45"></a>                              <span class="st">"("</span>,</span>
<span id="cb5-46"><a href="#cb5-46"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean,<span class="dv">2</span>),</span>
<span id="cb5-47"><a href="#cb5-47"></a>                              <span class="st">")"</span>,</span>
<span id="cb5-48"><a href="#cb5-48"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb5-49"><a href="#cb5-49"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb5-50"><a href="#cb5-50"></a>                              <span class="st">"("</span>,</span>
<span id="cb5-51"><a href="#cb5-51"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb5-52"><a href="#cb5-52"></a>                              <span class="st">")"</span>,</span>
<span id="cb5-53"><a href="#cb5-53"></a>                              <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">tau = "</span>,</span>
<span id="cb5-54"><a href="#cb5-54"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>tau,<span class="dv">3</span>),</span>
<span id="cb5-55"><a href="#cb5-55"></a>                              <span class="st">"("</span>,</span>
<span id="cb5-56"><a href="#cb5-56"></a>                              <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR,<span class="dv">2</span>),</span>
<span id="cb5-57"><a href="#cb5-57"></a>                              <span class="st">")"</span>,</span>
<span id="cb5-58"><a href="#cb5-58"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">lambda = "</span>,</span>
<span id="cb5-59"><a href="#cb5-59"></a>                              <span class="fu">round</span>(pa<span class="sc">$</span>lambda,<span class="dv">3</span>),</span>
<span id="cb5-60"><a href="#cb5-60"></a>                              <span class="st">",</span><span class="sc">\\</span><span class="st">; T = "</span>,</span>
<span id="cb5-61"><a href="#cb5-61"></a>                              pa<span class="sc">$</span>T,</span>
<span id="cb5-62"><a href="#cb5-62"></a>                              <span class="st">"$"</span>)</span>
<span id="cb5-63"><a href="#cb5-63"></a></span>
<span id="cb5-64"><a href="#cb5-64"></a></span>
<span id="cb5-65"><a href="#cb5-65"></a>  Model.Description.Short <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">lambda = "</span>,</span>
<span id="cb5-66"><a href="#cb5-66"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>lambda,<span class="dv">3</span>),</span>
<span id="cb5-67"><a href="#cb5-67"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">tau = "</span>,</span>
<span id="cb5-68"><a href="#cb5-68"></a>                                    <span class="fu">round</span>(pa<span class="sc">$</span>tau, <span class="dv">2</span>),</span>
<span id="cb5-69"><a href="#cb5-69"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rightarrow"</span>,</span>
<span id="cb5-70"><a href="#cb5-70"></a>                                    <span class="st">"</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">rho = "</span>,</span>
<span id="cb5-71"><a href="#cb5-71"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>AR, <span class="dv">2</span>),</span>
<span id="cb5-72"><a href="#cb5-72"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">mu = "</span>,</span>
<span id="cb5-73"><a href="#cb5-73"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb5-74"><a href="#cb5-74"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">sigma^2 = "</span>,</span>
<span id="cb5-75"><a href="#cb5-75"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Variance,<span class="dv">2</span>),</span>
<span id="cb5-76"><a href="#cb5-76"></a>                                    <span class="st">",</span><span class="sc">\\</span><span class="st">; </span><span class="sc">\\</span><span class="st">gamma = "</span>,</span>
<span id="cb5-77"><a href="#cb5-77"></a>                                    <span class="fu">round</span>(Empirical.Parameters<span class="sc">$</span>Skewness,<span class="dv">2</span>),</span>
<span id="cb5-78"><a href="#cb5-78"></a>                                    <span class="st">"$"</span>)</span>
<span id="cb5-79"><a href="#cb5-79"></a>  <span class="do">## making the output object</span></span>
<span id="cb5-80"><a href="#cb5-80"></a>  output <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x,</span>
<span id="cb5-81"><a href="#cb5-81"></a>                 <span class="at">Model.Description =</span> Model.Description,</span>
<span id="cb5-82"><a href="#cb5-82"></a>                 <span class="at">Model.Description.Short =</span> Model.Description.Short,</span>
<span id="cb5-83"><a href="#cb5-83"></a>                 <span class="at">Model.Parameters =</span> pa,</span>
<span id="cb5-84"><a href="#cb5-84"></a>                 <span class="at">Empirical.Parameters =</span> Empirical.Parameters)</span>
<span id="cb5-85"><a href="#cb5-85"></a></span>
<span id="cb5-86"><a href="#cb5-86"></a></span>
<span id="cb5-87"><a href="#cb5-87"></a>  <span class="fu">return</span>(output)</span>
<span id="cb5-88"><a href="#cb5-88"></a>}</span>
<span id="cb5-89"><a href="#cb5-89"></a></span>
<span id="cb5-90"><a href="#cb5-90"></a><span class="co"># General DGM wrappers ----------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</div>
</div>
</div>
</section>
<section id="sec-general-dgm-wrappers" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="sec-general-dgm-wrappers"><span class="header-section-number">1.1.2</span> General DGM wrappers</h3>
<p>Given that, in each model, two canonical parameters characterize the dynamic and marginal features of the generated time series, and given that we have analytic formulas that link the canonical parameters to the model-implied <span class="math inline">\(\phi\)</span>, <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma^2\)</span>, and <span class="math inline">\(\gamma\)</span>, we use a function (<code>dgm_parameterizer</code>) to calculate canonical parameters from two given parameters, and make a complete list of parameters (called <code>pa</code>). This list also includes non-parameter variables, importantly, the time series length <span class="math inline">\(T\)</span> (saved in <code>pa$T</code>) and the random seed used in the <code>dgm_*</code> functions (saved in <code>pa$seed</code>). A wrapper function (<code>dgm_generator</code>) is used as an interface to all <code>dgm_*</code> functions, which first makes sure the given parameters are sufficient for data generation, makes a complete parameter list <code>pa</code> with the help of <code>dgm_parameterizer</code>, and passes <code>pa</code> to the respective DGM generating function.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Parameter conversions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Wrapper around <code>dgm_*</code> functions</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The function <code>dgm_parameterizer</code> calculates canonical/model-implied parameters of a given DGM (specified using the <code>Model</code> argument) based on the parameters given to it as arguments, and saves them in a list of parameters (<code>pa</code>), which s returned by the function. The function makes sure that the set of parameters provided are sufficient to characterize the dynamic parameter of the model (i.e., the autoregression <span class="math inline">\(\phi\)</span>) and at least one of the marginal parameters (importantly, the mean <span class="math inline">\(\mu\)</span>) but giving default values to some parameters.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-8_f1167f9a0adebb5a1622c008060fe05c">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>dgm_parameterizer <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>Model)) pa<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="st">"ChiAR(1)"</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>phi)) pa<span class="sc">$</span>phi <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="do">## for NAR(1)</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"nar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"nar"</span>){</span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a>    <span class="do">## Calculating model parameters</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>    <span class="do">## if mean is given</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Mean)) {</span>
<span id="cb6-21"><a href="#cb6-21"></a>      <span class="co"># then from the mean formula</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>Mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-23"><a href="#cb6-23"></a>    }</span>
<span id="cb6-24"><a href="#cb6-24"></a>    <span class="do">## if mean is not given, we get it from the intercept</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>    <span class="cf">else</span>{</span>
<span id="cb6-26"><a href="#cb6-26"></a>      <span class="co"># set intercept to zero, if already not defined</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>c)) pa<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>      <span class="co"># then from the mean formula</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>c <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-30"><a href="#cb6-30"></a>    }</span>
<span id="cb6-31"><a href="#cb6-31"></a></span>
<span id="cb6-32"><a href="#cb6-32"></a>    <span class="do">## Now we certainly have the mean calculated</span></span>
<span id="cb6-33"><a href="#cb6-33"></a></span>
<span id="cb6-34"><a href="#cb6-34"></a>    <span class="do">## The within-person (marginal) variance is more interpretable. So</span></span>
<span id="cb6-35"><a href="#cb6-35"></a>    <span class="do">## we always calculate the residual variance based on the marginal</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>    <span class="do">## variance, unless var.resid is known BUT var.marginal is NOT.</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>var.resid) <span class="sc">&amp;</span> <span class="fu">is.null</span>(pa<span class="sc">$</span>var.marginal)) {</span>
<span id="cb6-38"><a href="#cb6-38"></a>      <span class="co"># from the marginal variance formula</span></span>
<span id="cb6-39"><a href="#cb6-39"></a>      pa<span class="sc">$</span>var.marginal <span class="ot">&lt;-</span> pa<span class="sc">$</span>var.resid <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb6-40"><a href="#cb6-40"></a>    }</span>
<span id="cb6-41"><a href="#cb6-41"></a>    <span class="do">## If none of them are known we first give var.marginal a default</span></span>
<span id="cb6-42"><a href="#cb6-42"></a>    <span class="do">## value and calculate var.resid based on that.</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(pa<span class="sc">$</span>var.resid) <span class="sc">&amp;</span> <span class="fu">is.null</span>(pa<span class="sc">$</span>var.marginal)) {</span>
<span id="cb6-44"><a href="#cb6-44"></a>      <span class="co"># we set a default value for the marginal variance</span></span>
<span id="cb6-45"><a href="#cb6-45"></a>      pa<span class="sc">$</span>var.marginal <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb6-46"><a href="#cb6-46"></a>    }</span>
<span id="cb6-47"><a href="#cb6-47"></a>    <span class="do">## Then, we calculate var.resid (again) with var.marginal to make</span></span>
<span id="cb6-48"><a href="#cb6-48"></a>    <span class="do">## sure that the marginal variance had been given more importance</span></span>
<span id="cb6-49"><a href="#cb6-49"></a>    pa<span class="sc">$</span>var.resid <span class="ot">&lt;-</span> pa<span class="sc">$</span>var.marginal <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb6-50"><a href="#cb6-50"></a></span>
<span id="cb6-51"><a href="#cb6-51"></a>    <span class="do">## Returning the parameter list</span></span>
<span id="cb6-52"><a href="#cb6-52"></a>    <span class="fu">return</span>(pa)</span>
<span id="cb6-53"><a href="#cb6-53"></a></span>
<span id="cb6-54"><a href="#cb6-54"></a>  }</span>
<span id="cb6-55"><a href="#cb6-55"></a></span>
<span id="cb6-56"><a href="#cb6-56"></a></span>
<span id="cb6-57"><a href="#cb6-57"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-58"><a href="#cb6-58"></a>  <span class="do">## for ChiAR(1)</span></span>
<span id="cb6-59"><a href="#cb6-59"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-60"><a href="#cb6-60"></a></span>
<span id="cb6-61"><a href="#cb6-61"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chiar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chiar"</span> <span class="sc">|</span></span>
<span id="cb6-62"><a href="#cb6-62"></a>     <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chi2ar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chi2ar"</span>){</span>
<span id="cb6-63"><a href="#cb6-63"></a></span>
<span id="cb6-64"><a href="#cb6-64"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-65"><a href="#cb6-65"></a></span>
<span id="cb6-66"><a href="#cb6-66"></a>    <span class="do">## Calculating model parameters</span></span>
<span id="cb6-67"><a href="#cb6-67"></a>    <span class="do">## if mean and skewness are given</span></span>
<span id="cb6-68"><a href="#cb6-68"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Mean) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Skewness)) {</span>
<span id="cb6-69"><a href="#cb6-69"></a>      <span class="co"># from the skewness formula</span></span>
<span id="cb6-70"><a href="#cb6-70"></a>      pa<span class="sc">$</span>nu <span class="ot">&lt;-</span></span>
<span id="cb6-71"><a href="#cb6-71"></a>        <span class="dv">8</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">^</span> <span class="dv">3</span> <span class="sc">/</span> ((pa<span class="sc">$</span>Skewness <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span></span>
<span id="cb6-72"><a href="#cb6-72"></a>                                                           <span class="dv">3</span>) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb6-73"><a href="#cb6-73"></a>      <span class="co"># then from the mean formula</span></span>
<span id="cb6-74"><a href="#cb6-74"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>Mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi) <span class="sc">-</span> pa<span class="sc">$</span>nu</span>
<span id="cb6-75"><a href="#cb6-75"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-76"><a href="#cb6-76"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-77"><a href="#cb6-77"></a>    }</span>
<span id="cb6-78"><a href="#cb6-78"></a>    <span class="do">## if mean and skewness are not given at the same time, we use c</span></span>
<span id="cb6-79"><a href="#cb6-79"></a>    <span class="do">## and one other parameter</span></span>
<span id="cb6-80"><a href="#cb6-80"></a>    <span class="cf">else</span>{</span>
<span id="cb6-81"><a href="#cb6-81"></a></span>
<span id="cb6-82"><a href="#cb6-82"></a>      <span class="co"># set intercept to zero, if already not defined</span></span>
<span id="cb6-83"><a href="#cb6-83"></a>      <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>c)) pa<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-84"><a href="#cb6-84"></a></span>
<span id="cb6-85"><a href="#cb6-85"></a>      <span class="do">## if mean is given</span></span>
<span id="cb6-86"><a href="#cb6-86"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Mean)) {</span>
<span id="cb6-87"><a href="#cb6-87"></a>        <span class="co"># then from the mean formula</span></span>
<span id="cb6-88"><a href="#cb6-88"></a>        pa<span class="sc">$</span>nu <span class="ot">&lt;-</span> pa<span class="sc">$</span>Mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi) <span class="sc">-</span> pa<span class="sc">$</span>c</span>
<span id="cb6-89"><a href="#cb6-89"></a>        <span class="co"># from the skewness formula</span></span>
<span id="cb6-90"><a href="#cb6-90"></a>        pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span></span>
<span id="cb6-91"><a href="#cb6-91"></a>          <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">^</span> <span class="fl">1.5</span> <span class="sc">/</span> (<span class="fu">sqrt</span>(pa<span class="sc">$</span>nu <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span></span>
<span id="cb6-92"><a href="#cb6-92"></a>                                                             <span class="dv">3</span>))</span>
<span id="cb6-93"><a href="#cb6-93"></a>        <span class="co"># returning the parameter list</span></span>
<span id="cb6-94"><a href="#cb6-94"></a>        <span class="fu">return</span>(pa)</span>
<span id="cb6-95"><a href="#cb6-95"></a>      }</span>
<span id="cb6-96"><a href="#cb6-96"></a></span>
<span id="cb6-97"><a href="#cb6-97"></a>      <span class="do">## if skewness is given</span></span>
<span id="cb6-98"><a href="#cb6-98"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Skewness)) {</span>
<span id="cb6-99"><a href="#cb6-99"></a>        <span class="co"># from the skewness formula</span></span>
<span id="cb6-100"><a href="#cb6-100"></a>        pa<span class="sc">$</span>nu <span class="ot">&lt;-</span></span>
<span id="cb6-101"><a href="#cb6-101"></a>          <span class="dv">8</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">^</span> <span class="dv">3</span> <span class="sc">/</span> ((pa<span class="sc">$</span>Skewness <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span></span>
<span id="cb6-102"><a href="#cb6-102"></a>                                                             <span class="dv">3</span>) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb6-103"><a href="#cb6-103"></a>        <span class="co"># then from the mean formula</span></span>
<span id="cb6-104"><a href="#cb6-104"></a>        pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> (pa<span class="sc">$</span>c <span class="sc">+</span> pa<span class="sc">$</span>nu) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-105"><a href="#cb6-105"></a>        <span class="co"># returning the parameter list</span></span>
<span id="cb6-106"><a href="#cb6-106"></a>        <span class="fu">return</span>(pa)</span>
<span id="cb6-107"><a href="#cb6-107"></a>      }</span>
<span id="cb6-108"><a href="#cb6-108"></a></span>
<span id="cb6-109"><a href="#cb6-109"></a>      <span class="do">## if nu is given</span></span>
<span id="cb6-110"><a href="#cb6-110"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>nu)){</span>
<span id="cb6-111"><a href="#cb6-111"></a>        <span class="co"># from the mean formula</span></span>
<span id="cb6-112"><a href="#cb6-112"></a>        pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> (pa<span class="sc">$</span>c <span class="sc">+</span> pa<span class="sc">$</span>nu)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pa<span class="sc">$</span>phi)</span>
<span id="cb6-113"><a href="#cb6-113"></a>        <span class="co"># from the skewness formula</span></span>
<span id="cb6-114"><a href="#cb6-114"></a>        pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span></span>
<span id="cb6-115"><a href="#cb6-115"></a>          <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">^</span> <span class="fl">1.5</span> <span class="sc">/</span> (<span class="fu">sqrt</span>(pa<span class="sc">$</span>nu <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi <span class="sc">^</span></span>
<span id="cb6-116"><a href="#cb6-116"></a>                                                             <span class="dv">3</span>))</span>
<span id="cb6-117"><a href="#cb6-117"></a>        <span class="co"># returning the parameter list</span></span>
<span id="cb6-118"><a href="#cb6-118"></a>        <span class="fu">return</span>(pa)</span>
<span id="cb6-119"><a href="#cb6-119"></a>      }</span>
<span id="cb6-120"><a href="#cb6-120"></a></span>
<span id="cb6-121"><a href="#cb6-121"></a>    }</span>
<span id="cb6-122"><a href="#cb6-122"></a></span>
<span id="cb6-123"><a href="#cb6-123"></a></span>
<span id="cb6-124"><a href="#cb6-124"></a>  }</span>
<span id="cb6-125"><a href="#cb6-125"></a></span>
<span id="cb6-126"><a href="#cb6-126"></a></span>
<span id="cb6-127"><a href="#cb6-127"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-128"><a href="#cb6-128"></a>  <span class="do">## for BinAR(1)</span></span>
<span id="cb6-129"><a href="#cb6-129"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-130"><a href="#cb6-130"></a></span>
<span id="cb6-131"><a href="#cb6-131"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"binar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"binar"</span>) {</span>
<span id="cb6-132"><a href="#cb6-132"></a></span>
<span id="cb6-133"><a href="#cb6-133"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(pa<span class="sc">$</span>k))</span>
<span id="cb6-134"><a href="#cb6-134"></a>      pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-135"><a href="#cb6-135"></a></span>
<span id="cb6-136"><a href="#cb6-136"></a>    <span class="do">## Calculating model parameters</span></span>
<span id="cb6-137"><a href="#cb6-137"></a></span>
<span id="cb6-138"><a href="#cb6-138"></a>    <span class="do">## if mean is given</span></span>
<span id="cb6-139"><a href="#cb6-139"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Mean)) {</span>
<span id="cb6-140"><a href="#cb6-140"></a>      <span class="co"># from skewness formula: m = k*theta</span></span>
<span id="cb6-141"><a href="#cb6-141"></a>      pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> pa<span class="sc">$</span>Mean <span class="sc">/</span> pa<span class="sc">$</span>k</span>
<span id="cb6-142"><a href="#cb6-142"></a>      <span class="do">## we then calculate skewness based on theta</span></span>
<span id="cb6-143"><a href="#cb6-143"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> pa<span class="sc">$</span>theta) <span class="sc">/</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta))</span>
<span id="cb6-144"><a href="#cb6-144"></a>      <span class="do">## we then calculate beta based on theta and phi</span></span>
<span id="cb6-145"><a href="#cb6-145"></a>      pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-146"><a href="#cb6-146"></a>      <span class="co"># then we calculate alpha</span></span>
<span id="cb6-147"><a href="#cb6-147"></a>      pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi <span class="sc">+</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-148"><a href="#cb6-148"></a>      <span class="co"># finally we calculate k*beta, which is equivalent to c</span></span>
<span id="cb6-149"><a href="#cb6-149"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-150"><a href="#cb6-150"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-151"><a href="#cb6-151"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-152"><a href="#cb6-152"></a>    }</span>
<span id="cb6-153"><a href="#cb6-153"></a></span>
<span id="cb6-154"><a href="#cb6-154"></a>    <span class="do">## if skewness is given</span></span>
<span id="cb6-155"><a href="#cb6-155"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Skewness)) {</span>
<span id="cb6-156"><a href="#cb6-156"></a>      <span class="co"># from skewness formula: skewness = (1-2*theta)/sqrt(k*theta*(1-theta))</span></span>
<span id="cb6-157"><a href="#cb6-157"></a>      <span class="co"># it is easier to write with ks = k*(skewness^2)</span></span>
<span id="cb6-158"><a href="#cb6-158"></a>      ks <span class="ot">&lt;-</span> pa<span class="sc">$</span>k<span class="sc">*</span>pa<span class="sc">$</span>Skewness<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-159"><a href="#cb6-159"></a>      pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> (ks <span class="sc">+</span> <span class="dv">4</span> <span class="sc">-</span></span>
<span id="cb6-160"><a href="#cb6-160"></a>                     <span class="fu">sqrt</span>(ks <span class="sc">*</span> (ks <span class="sc">+</span> <span class="dv">4</span>))) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> ks <span class="sc">+</span> <span class="dv">8</span>)</span>
<span id="cb6-161"><a href="#cb6-161"></a>      <span class="co"># The above formula only gives theta &lt; 0.5, thus for negative skewness</span></span>
<span id="cb6-162"><a href="#cb6-162"></a>      <span class="co"># we must use 1-theta instead</span></span>
<span id="cb6-163"><a href="#cb6-163"></a>      <span class="cf">if</span>(pa<span class="sc">$</span>Skewness <span class="sc">&lt;</span> <span class="dv">0</span>) pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-164"><a href="#cb6-164"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-165"><a href="#cb6-165"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-166"><a href="#cb6-166"></a>      <span class="co"># we then calculate beta based on theta and phi</span></span>
<span id="cb6-167"><a href="#cb6-167"></a>      pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-168"><a href="#cb6-168"></a>      <span class="co"># then we calculate alpha</span></span>
<span id="cb6-169"><a href="#cb6-169"></a>      pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi <span class="sc">+</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-170"><a href="#cb6-170"></a>      <span class="co"># finally we calculate k*beta, which is equivalent to c</span></span>
<span id="cb6-171"><a href="#cb6-171"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-172"><a href="#cb6-172"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-173"><a href="#cb6-173"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-174"><a href="#cb6-174"></a>    }</span>
<span id="cb6-175"><a href="#cb6-175"></a></span>
<span id="cb6-176"><a href="#cb6-176"></a>    <span class="do">## if theta is given</span></span>
<span id="cb6-177"><a href="#cb6-177"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>theta)) {</span>
<span id="cb6-178"><a href="#cb6-178"></a>      <span class="co"># from theta formula</span></span>
<span id="cb6-179"><a href="#cb6-179"></a>      pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-180"><a href="#cb6-180"></a>      <span class="co"># from beta formula</span></span>
<span id="cb6-181"><a href="#cb6-181"></a>      pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi <span class="sc">+</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-182"><a href="#cb6-182"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-183"><a href="#cb6-183"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-184"><a href="#cb6-184"></a>      <span class="co"># we then calculate skewness based on theta</span></span>
<span id="cb6-185"><a href="#cb6-185"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> pa<span class="sc">$</span>theta) <span class="sc">/</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta))</span>
<span id="cb6-186"><a href="#cb6-186"></a>      <span class="co"># finally we calculate k*beta, which is equivalent to c</span></span>
<span id="cb6-187"><a href="#cb6-187"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-188"><a href="#cb6-188"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-189"><a href="#cb6-189"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-190"><a href="#cb6-190"></a>    }</span>
<span id="cb6-191"><a href="#cb6-191"></a></span>
<span id="cb6-192"><a href="#cb6-192"></a>    <span class="do">## if alpha is given</span></span>
<span id="cb6-193"><a href="#cb6-193"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>alpha)) {</span>
<span id="cb6-194"><a href="#cb6-194"></a>      <span class="co"># from beta formula</span></span>
<span id="cb6-195"><a href="#cb6-195"></a>      pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> pa<span class="sc">$</span>alpha <span class="sc">-</span> pa<span class="sc">$</span>phi</span>
<span id="cb6-196"><a href="#cb6-196"></a>      <span class="co"># from theta formula</span></span>
<span id="cb6-197"><a href="#cb6-197"></a>      pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> pa<span class="sc">$</span>beta <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-198"><a href="#cb6-198"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-199"><a href="#cb6-199"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-200"><a href="#cb6-200"></a>      <span class="co"># we then calculate skewness based on theta</span></span>
<span id="cb6-201"><a href="#cb6-201"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> pa<span class="sc">$</span>theta) <span class="sc">/</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta))</span>
<span id="cb6-202"><a href="#cb6-202"></a>      <span class="co"># finally we calculate k*beta, which is equivalent to c</span></span>
<span id="cb6-203"><a href="#cb6-203"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-204"><a href="#cb6-204"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-205"><a href="#cb6-205"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-206"><a href="#cb6-206"></a>    }</span>
<span id="cb6-207"><a href="#cb6-207"></a></span>
<span id="cb6-208"><a href="#cb6-208"></a>    <span class="do">## if beta is given</span></span>
<span id="cb6-209"><a href="#cb6-209"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>beta)) {</span>
<span id="cb6-210"><a href="#cb6-210"></a>      <span class="co"># from beta formula</span></span>
<span id="cb6-211"><a href="#cb6-211"></a>      pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi <span class="sc">+</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-212"><a href="#cb6-212"></a>      <span class="co"># from theta formula</span></span>
<span id="cb6-213"><a href="#cb6-213"></a>      pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> pa<span class="sc">$</span>beta <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-214"><a href="#cb6-214"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-215"><a href="#cb6-215"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-216"><a href="#cb6-216"></a>      <span class="co"># we then calculate skewness based on theta</span></span>
<span id="cb6-217"><a href="#cb6-217"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> pa<span class="sc">$</span>theta) <span class="sc">/</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta))</span>
<span id="cb6-218"><a href="#cb6-218"></a>      <span class="co"># finally we calculate k*beta, which is equivalent to c</span></span>
<span id="cb6-219"><a href="#cb6-219"></a>      pa<span class="sc">$</span>c <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-220"><a href="#cb6-220"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-221"><a href="#cb6-221"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-222"><a href="#cb6-222"></a>    }</span>
<span id="cb6-223"><a href="#cb6-223"></a></span>
<span id="cb6-224"><a href="#cb6-224"></a>    <span class="do">## if intercept given</span></span>
<span id="cb6-225"><a href="#cb6-225"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>c)) {</span>
<span id="cb6-226"><a href="#cb6-226"></a>      <span class="co"># from intercept formula c = k*beta</span></span>
<span id="cb6-227"><a href="#cb6-227"></a>      pa<span class="sc">$</span>beta <span class="ot">&lt;-</span> pa<span class="sc">$</span>c <span class="sc">/</span> pa<span class="sc">$</span>k</span>
<span id="cb6-228"><a href="#cb6-228"></a>      <span class="co"># from beta formula</span></span>
<span id="cb6-229"><a href="#cb6-229"></a>      pa<span class="sc">$</span>alpha <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi <span class="sc">+</span> pa<span class="sc">$</span>beta</span>
<span id="cb6-230"><a href="#cb6-230"></a>      <span class="co"># from theta formula</span></span>
<span id="cb6-231"><a href="#cb6-231"></a>      pa<span class="sc">$</span>theta <span class="ot">&lt;-</span> pa<span class="sc">$</span>beta <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>phi)</span>
<span id="cb6-232"><a href="#cb6-232"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-233"><a href="#cb6-233"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta</span>
<span id="cb6-234"><a href="#cb6-234"></a>      <span class="co"># we then calculate skewness based on theta</span></span>
<span id="cb6-235"><a href="#cb6-235"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> pa<span class="sc">$</span>theta) <span class="sc">/</span> <span class="fu">sqrt</span>(pa<span class="sc">$</span>k <span class="sc">*</span> pa<span class="sc">$</span>theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pa<span class="sc">$</span>theta))</span>
<span id="cb6-236"><a href="#cb6-236"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-237"><a href="#cb6-237"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-238"><a href="#cb6-238"></a>    }</span>
<span id="cb6-239"><a href="#cb6-239"></a></span>
<span id="cb6-240"><a href="#cb6-240"></a>  }</span>
<span id="cb6-241"><a href="#cb6-241"></a></span>
<span id="cb6-242"><a href="#cb6-242"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-243"><a href="#cb6-243"></a>  <span class="do">## for PoDAR(1)</span></span>
<span id="cb6-244"><a href="#cb6-244"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb6-245"><a href="#cb6-245"></a></span>
<span id="cb6-246"><a href="#cb6-246"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"podar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"podar"</span>) {</span>
<span id="cb6-247"><a href="#cb6-247"></a></span>
<span id="cb6-248"><a href="#cb6-248"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(pa<span class="sc">$</span>k))</span>
<span id="cb6-249"><a href="#cb6-249"></a>      pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb6-250"><a href="#cb6-250"></a></span>
<span id="cb6-251"><a href="#cb6-251"></a>    <span class="co"># phi and tau are the same, then if tau is defined, it overrules phi</span></span>
<span id="cb6-252"><a href="#cb6-252"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>tau)) pa<span class="sc">$</span>phi <span class="ot">&lt;-</span> pa<span class="sc">$</span>tau</span>
<span id="cb6-253"><a href="#cb6-253"></a>    <span class="co"># and if tau is not defined, then tau will get the value of phi</span></span>
<span id="cb6-254"><a href="#cb6-254"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>tau)) pa<span class="sc">$</span>tau <span class="ot">&lt;-</span> pa<span class="sc">$</span>phi</span>
<span id="cb6-255"><a href="#cb6-255"></a>    <span class="co"># DAR(1) intercept is zero</span></span>
<span id="cb6-256"><a href="#cb6-256"></a>    pa<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-257"><a href="#cb6-257"></a></span>
<span id="cb6-258"><a href="#cb6-258"></a>    <span class="do">## Calculating model parameters</span></span>
<span id="cb6-259"><a href="#cb6-259"></a></span>
<span id="cb6-260"><a href="#cb6-260"></a>    <span class="do">## if mean is given</span></span>
<span id="cb6-261"><a href="#cb6-261"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Mean)) {</span>
<span id="cb6-262"><a href="#cb6-262"></a>      <span class="co"># mean of Poisson is lambda</span></span>
<span id="cb6-263"><a href="#cb6-263"></a>      pa<span class="sc">$</span>lambda <span class="ot">&lt;-</span> pa<span class="sc">$</span>Mean</span>
<span id="cb6-264"><a href="#cb6-264"></a>      <span class="do">## we then calculate skewness based on lambda</span></span>
<span id="cb6-265"><a href="#cb6-265"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> pa<span class="sc">$</span>lambda<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb6-266"><a href="#cb6-266"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-267"><a href="#cb6-267"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-268"><a href="#cb6-268"></a>    }</span>
<span id="cb6-269"><a href="#cb6-269"></a></span>
<span id="cb6-270"><a href="#cb6-270"></a>    <span class="do">## if skewness is given</span></span>
<span id="cb6-271"><a href="#cb6-271"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>Skewness)) {</span>
<span id="cb6-272"><a href="#cb6-272"></a>      <span class="co"># from skewness formula: skewness = 1/sqrt(lambda)</span></span>
<span id="cb6-273"><a href="#cb6-273"></a>      pa<span class="sc">$</span>lambda <span class="ot">&lt;-</span> pa<span class="sc">$</span>Skewness<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb6-274"><a href="#cb6-274"></a>      <span class="co"># we then calculate mean based on theta</span></span>
<span id="cb6-275"><a href="#cb6-275"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>lambda</span>
<span id="cb6-276"><a href="#cb6-276"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-277"><a href="#cb6-277"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-278"><a href="#cb6-278"></a>    }</span>
<span id="cb6-279"><a href="#cb6-279"></a></span>
<span id="cb6-280"><a href="#cb6-280"></a>    <span class="do">## if lambda is given</span></span>
<span id="cb6-281"><a href="#cb6-281"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pa<span class="sc">$</span>lambda)) {</span>
<span id="cb6-282"><a href="#cb6-282"></a>      <span class="co"># mean of Poisson is lambda</span></span>
<span id="cb6-283"><a href="#cb6-283"></a>      pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> pa<span class="sc">$</span>lambda</span>
<span id="cb6-284"><a href="#cb6-284"></a>      <span class="do">## we then calculate skewness based on lambda</span></span>
<span id="cb6-285"><a href="#cb6-285"></a>      pa<span class="sc">$</span>Skewness <span class="ot">&lt;-</span> pa<span class="sc">$</span>lambda<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb6-286"><a href="#cb6-286"></a>      <span class="co"># returning the parameter list</span></span>
<span id="cb6-287"><a href="#cb6-287"></a>      <span class="fu">return</span>(pa)</span>
<span id="cb6-288"><a href="#cb6-288"></a>    }</span>
<span id="cb6-289"><a href="#cb6-289"></a>  }</span>
<span id="cb6-290"><a href="#cb6-290"></a></span>
<span id="cb6-291"><a href="#cb6-291"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The function <code>dgm_generator</code> gets a set of parameters (either as separate arguments, or a list of parameters, like the one returned by <code>dgm_parameterizer</code>), saves them in a list called <code>pa</code>. It checks whether <span class="math inline">\(\phi\)</span> is included in the list (if not, sets the default value <code>pa$phi = 0.2</code>), and checks if at least one other parameter (which, together with <span class="math inline">\(\phi\)</span>, is required to characterize the marginal properties of the DGMs) is calculated for it (if not, it sets the default value <code>pa$Mean = 5</code> for <span class="math inline">\(\mu\)</span>). Furthermore, if the DGM name, time series length, and the random seed are not provided, it gives them default values (respectively: <code>Model = "ChiAR(1)"</code>, <code>T = 100</code>, and <code>seed = 0</code>) and adds them to <code>pa</code>.</p>
<p>Then, it passes the <code>pa</code> list to <code>dgm_parameterizer</code> to do the necessary conversions to complete the list of canonical and model-implied parameters. Finally, given the model name, it checks if non-canonical parameters <span class="math inline">\(k\)</span> and <span class="math inline">\(c\)</span> are set (otherwise assigns appropriate defaults to them), and passes the complete parameter list to the respective DGM function.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-9_87877ba946c18c270fb6bf329f4254f7">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>dgm_generator <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>  pa <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(pa<span class="sc">$</span>pa)) pa <span class="ot">&lt;-</span> pa<span class="sc">$</span>pa</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="do">## setting default seed if not given</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>Model)) pa<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="st">"ChiAR(1)"</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>phi)) pa<span class="sc">$</span>phi <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="co"># if no model parameter is given, then mean is set to a default 5</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(pa<span class="sc">$</span>Mean) <span class="sc">&amp;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>Skewness) <span class="sc">&amp;</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>c) <span class="sc">&amp;</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>nu) <span class="sc">&amp;</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>alpha) <span class="sc">&amp;</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>beta) <span class="sc">&amp;</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>      <span class="fu">is.null</span>(pa<span class="sc">$</span>theta)</span>
<span id="cb7-18"><a href="#cb7-18"></a>  ) pa<span class="sc">$</span>Mean <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="co"># if(is.null(pa$Mean)) pa$Variance &lt;- 10</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="co"># if(is.null(pa$Skewness)) pa$Skewness &lt;- 3</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>T)) pa<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>seed)) pa<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>only.ts)) pa<span class="sc">$</span>only.ts <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb7-25"><a href="#cb7-25"></a></span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="do">## If you set `pa$only.ts` parameter as TRUE, the dgm_ functions produce only</span></span>
<span id="cb7-27"><a href="#cb7-27"></a>  <span class="do">## the raw time series (a single numeric vector) which is way lighter and way</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="do">## faster:</span></span>
<span id="cb7-29"><a href="#cb7-29"></a></span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="co"># pa$only.ts &lt;- TRUE</span></span>
<span id="cb7-31"><a href="#cb7-31"></a></span>
<span id="cb7-32"><a href="#cb7-32"></a></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="do">## calculating model parameters</span></span>
<span id="cb7-34"><a href="#cb7-34"></a>  pa <span class="ot">&lt;-</span> <span class="fu">dgm_parameterizer</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-35"><a href="#cb7-35"></a></span>
<span id="cb7-36"><a href="#cb7-36"></a>  <span class="do">### making models</span></span>
<span id="cb7-37"><a href="#cb7-37"></a></span>
<span id="cb7-38"><a href="#cb7-38"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-39"><a href="#cb7-39"></a>  <span class="do">## NAR(1)</span></span>
<span id="cb7-40"><a href="#cb7-40"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-41"><a href="#cb7-41"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"nar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"nar"</span>){</span>
<span id="cb7-42"><a href="#cb7-42"></a>    <span class="co"># default maximum scale value</span></span>
<span id="cb7-43"><a href="#cb7-43"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-44"><a href="#cb7-44"></a>    <span class="do">## %% Generating the data</span></span>
<span id="cb7-45"><a href="#cb7-45"></a>    o <span class="ot">&lt;-</span> <span class="fu">dgm_nar</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-46"><a href="#cb7-46"></a>  }</span>
<span id="cb7-47"><a href="#cb7-47"></a></span>
<span id="cb7-48"><a href="#cb7-48"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-49"><a href="#cb7-49"></a>  <span class="do">## ChiAR(1)</span></span>
<span id="cb7-50"><a href="#cb7-50"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-51"><a href="#cb7-51"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chiar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chiar"</span> <span class="sc">|</span></span>
<span id="cb7-52"><a href="#cb7-52"></a>     <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chi2ar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"chi2ar"</span>){</span>
<span id="cb7-53"><a href="#cb7-53"></a>    <span class="co"># default maximum scale value</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-55"><a href="#cb7-55"></a>    <span class="do">## %% Generating the data</span></span>
<span id="cb7-56"><a href="#cb7-56"></a>    o <span class="ot">&lt;-</span> <span class="fu">dgm_chiar</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-57"><a href="#cb7-57"></a>  }</span>
<span id="cb7-58"><a href="#cb7-58"></a></span>
<span id="cb7-59"><a href="#cb7-59"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-60"><a href="#cb7-60"></a>  <span class="do">## BinAR(1)</span></span>
<span id="cb7-61"><a href="#cb7-61"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-62"><a href="#cb7-62"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"binar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"binar"</span>){</span>
<span id="cb7-63"><a href="#cb7-63"></a>    <span class="co"># default maximum scale value</span></span>
<span id="cb7-64"><a href="#cb7-64"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-65"><a href="#cb7-65"></a>    <span class="do">## %% Generating the data</span></span>
<span id="cb7-66"><a href="#cb7-66"></a>    o <span class="ot">&lt;-</span> <span class="fu">dgm_binar</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-67"><a href="#cb7-67"></a>  }</span>
<span id="cb7-68"><a href="#cb7-68"></a></span>
<span id="cb7-69"><a href="#cb7-69"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-70"><a href="#cb7-70"></a>  <span class="do">## DAR(1)</span></span>
<span id="cb7-71"><a href="#cb7-71"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-72"><a href="#cb7-72"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"dar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"dar"</span>){</span>
<span id="cb7-73"><a href="#cb7-73"></a>    <span class="co"># default maximum scale value</span></span>
<span id="cb7-74"><a href="#cb7-74"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-75"><a href="#cb7-75"></a>    <span class="do">## %% Generating the data</span></span>
<span id="cb7-76"><a href="#cb7-76"></a>    o <span class="ot">&lt;-</span> <span class="fu">dgm_dar</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-77"><a href="#cb7-77"></a>  }</span>
<span id="cb7-78"><a href="#cb7-78"></a></span>
<span id="cb7-79"><a href="#cb7-79"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-80"><a href="#cb7-80"></a>  <span class="do">## PoDAR(1)</span></span>
<span id="cb7-81"><a href="#cb7-81"></a>  <span class="do">## %%%%%%%%%%%%</span></span>
<span id="cb7-82"><a href="#cb7-82"></a>  <span class="cf">if</span>(<span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"podar(1)"</span> <span class="sc">|</span> <span class="fu">tolower</span>(pa<span class="sc">$</span>Model) <span class="sc">==</span> <span class="st">"podar"</span>){</span>
<span id="cb7-83"><a href="#cb7-83"></a>    <span class="co"># default maximum scale value</span></span>
<span id="cb7-84"><a href="#cb7-84"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(pa<span class="sc">$</span>k)) pa<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-85"><a href="#cb7-85"></a>    <span class="do">## %% Generating the data</span></span>
<span id="cb7-86"><a href="#cb7-86"></a>    o <span class="ot">&lt;-</span> <span class="fu">dgm_podar</span>(<span class="at">pa =</span> pa)</span>
<span id="cb7-87"><a href="#cb7-87"></a>  }</span>
<span id="cb7-88"><a href="#cb7-88"></a></span>
<span id="cb7-89"><a href="#cb7-89"></a>  <span class="do">## Also allow a data frame output</span></span>
<span id="cb7-90"><a href="#cb7-90"></a>  <span class="co"># if(!is.null(p$as.dataframe) &amp; p$as.dataframe){</span></span>
<span id="cb7-91"><a href="#cb7-91"></a>  <span class="co">#</span></span>
<span id="cb7-92"><a href="#cb7-92"></a>  <span class="co"># }</span></span>
<span id="cb7-93"><a href="#cb7-93"></a></span>
<span id="cb7-94"><a href="#cb7-94"></a>  <span class="fu">return</span>(o)</span>
<span id="cb7-95"><a href="#cb7-95"></a>}</span>
<span id="cb7-96"><a href="#cb7-96"></a></span>
<span id="cb7-97"><a href="#cb7-97"></a></span>
<span id="cb7-98"><a href="#cb7-98"></a><span class="co"># Dataset generation ------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-dataset-generation" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="sec-dataset-generation"><span class="header-section-number">1.1.3</span> Dataset generation</h3>
<p>The machinery described above can be used to generate individual (<span class="math inline">\(N=1\)</span>) time series. However, for the simulation study, we need datasets comprising of multiple (<span class="math inline">\(N=25, 50, 100\)</span>) individuals. As we discussed in the paper, in our study, all individuals in a dataset of a DGM share the same autoregressive parameter (<span class="math inline">\(\phi_i=0.4\)</span>) and the individual differences are only in the individual means (<span class="math inline">\(\mathbb{\mu} = [\mu_1 , \mu_2, \dots, \mu_N]\)</span>). Thus, we write a function (<code>dgm_make.sample</code>) that can generate, for each DGM, a dataset of <span class="math inline">\(N\)</span> individuals based on an <span class="math inline">\(N\)</span>-dimensional vector of individual means, all with the same <span class="math inline">\(\phi_i\)</span>. We then need to find the appropriate parameters for the level-2 distributions (Gaussian and <span class="math inline">\(\chi^2\)</span> distributions) for each DGM, such that the we get a considerable proportion of individuals with considerably high skewness while respecting the lower and upper bounds of values supported by each model. Finally, with a wrapper function (<code>make_datasets</code>), we facilitate making dataset by automatically generating the means vector suitable for each DGM.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Making individual datasets</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Determining level-2 distribution parameters</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Automate dataset generation</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The function <code>dgm_make.sample</code> generates a dataset of time series of length <code>T</code> with the autoregressive parameter <code>phi</code> from a desired DGM (determined by the <code>Model</code> argument) given a vector of means (passed as the argument <code>Means</code>). The length of <code>Means</code> determine the number of individuals in the dataset (<code>N &lt;- length(Means)</code>). If <code>Means</code> is not provided, a randomly generated vector of <span class="math inline">\(N = 100\)</span> is used as default. Since each individual time series is generated with a random seed, we need a vector of <code>N</code> unique seeds, which can be provided using the <code>seeds</code> argument. In case <code>seeds</code> is not provided, it is generated based on the provided means (<code>seeds.from.means</code>), and if it is a scalar, the seeds vector is created by adding the scalar to the <code>seeds.from.means</code> (which would allow generating different datasets with the same mean distributions).</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-10_a2c06994fef46e61013c30589c7221a9">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>dgm_make.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Model =</span> <span class="st">"ChiAR(1)"</span>,</span>
<span id="cb8-2"><a href="#cb8-2"></a>                            <span class="at">Means =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>                            <span class="at">T =</span> <span class="dv">100</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                            <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                            <span class="at">Phis =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                            <span class="at">seeds =</span> <span class="cn">NULL</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>){</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(Means)</span>
<span id="cb8-10"><a href="#cb8-10"></a>  seeds.from.means <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">*</span>N<span class="sc">*</span>Means</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(seeds)) seeds <span class="ot">&lt;-</span> seeds.from.means</span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="cf">if</span>(<span class="fu">length</span>(seeds)<span class="sc">&lt;=</span><span class="dv">1</span>) seeds <span class="ot">&lt;-</span> seeds <span class="sc">+</span> seeds.from.means</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">subject =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">each =</span> T),</span>
<span id="cb8-16"><a href="#cb8-16"></a>                   <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T, <span class="at">times =</span> N),</span>
<span id="cb8-17"><a href="#cb8-17"></a>                   <span class="at">x =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N<span class="sc">*</span>T))</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="cf">if</span>(<span class="fu">length</span>(Phis) <span class="sc">!=</span> N) Phis <span class="ot">&lt;-</span> <span class="fu">rep</span>(phi, N)</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb8-23"><a href="#cb8-23"></a>    x <span class="ot">&lt;-</span> <span class="fu">dgm_generator</span>(</span>
<span id="cb8-24"><a href="#cb8-24"></a>      <span class="at">Model =</span> Model,</span>
<span id="cb8-25"><a href="#cb8-25"></a>      <span class="at">only.ts =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-26"><a href="#cb8-26"></a>      <span class="at">T =</span> T,</span>
<span id="cb8-27"><a href="#cb8-27"></a>      <span class="at">phi =</span> Phis[s],</span>
<span id="cb8-28"><a href="#cb8-28"></a>      <span class="at">Mean =</span> Means[s],</span>
<span id="cb8-29"><a href="#cb8-29"></a>      <span class="at">seed =</span> seeds[s])</span>
<span id="cb8-30"><a href="#cb8-30"></a></span>
<span id="cb8-31"><a href="#cb8-31"></a>    df<span class="sc">$</span>x[((s<span class="dv">-1</span>)<span class="sc">*</span>T <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(s<span class="sc">*</span>T)] <span class="ot">&lt;-</span> x</span>
<span id="cb8-32"><a href="#cb8-32"></a>  }</span>
<span id="cb8-33"><a href="#cb8-33"></a></span>
<span id="cb8-34"><a href="#cb8-34"></a>  <span class="fu">return</span>(df)</span>
<span id="cb8-35"><a href="#cb8-35"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>For each alternative DGM—the <span class="math inline">\(\chi^2\)</span>AR(1), BinAR(1), and PoDAR(1) models—we should determine appropriate parameters for the level-2 distribution of means such that we have enough skewness in the generated datasets. To do so, we make a function (<code>Mean.vs.Skewness</code>) to help us experiment with different values for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> (of the Gaussian level-2 distribution) and <span class="math inline">\(\nu\)</span> (of the <span class="math inline">\(\chi^2\)</span> level-2 distribution) for each alternative DGM. Note that we start by generating more than enough samples for each distribution (<span class="math inline">\(10 \times N\)</span>) and subsample <span class="math inline">\(N\)</span> values after applying the model-specific lower and upper bounds.</p>
<p>We notice that we get the desired distribution of skewness with the following parameters:</p>
<table class="table">
<caption>Parameters of level-2 distribution of means</caption>
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(\mu\)</span></th>
<th><span class="math inline">\(\sigma^2\)</span></th>
<th><span class="math inline">\(\nu\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\chi^2\)</span>AR(1)</td>
<td>10</td>
<td>10</td>
<td>5</td>
</tr>
<tr class="even">
<td>BinAR(1)</td>
<td>2</td>
<td>1</td>
<td>2.9</td>
</tr>
<tr class="odd">
<td>PoDAR(1)</td>
<td>4</td>
<td>4</td>
<td>1.5</td>
</tr>
</tbody>
</table>
<p>Giving us the following distributions:</p>
<p><img src="additional-files/Mean_vs_Skewness.png" class="img-fluid"></p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>We then use a wrapper (<code>make_datasets</code>) around <code>dgm_make.sample</code> that generates datasets for all four DGMs with the appropriate level-2 parameters specified above. Note that here we first generate more than enough (i.e., <span class="math inline">\(2 \times N\)</span>) samples of means to make sure we end up with <span class="math inline">\(N\)</span> samples after applying the upper and lower bounds. The datasets are then saved, with some additional variables in separate <code>.rds</code> files, using wrapper functions described in <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Addendum: Version 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>By setting <code>version = "v2"</code> in <code>make_datasets</code> (now the default), the vector of <code>Phis</code> is randomly drawn from <span class="math inline">\(\mathcal{N}(0.4, \sqrt{0.1})\)</span>. More specifically, like the means, <span class="math inline">\(2 \times N\)</span> values of <span class="math inline">\(\phi\)</span> are generated, the values not between 0 and 1 are removed, and <span class="math inline">\(N\)</span> values are randomly drawn from the remaining.</p>
<p>The function returns a list in this case, which contain the generated dataset <code>dataset</code>, and the vectors of means <code>Means</code> and <span class="math inline">\(\phi\)</span>s <code>Phis</code> used to generate it.</p>
</div>
</div>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-13_b09fff7b89f3a68a03b140b05e814887">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>make_datasets <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Model =</span> <span class="st">"DAR"</span>,</span>
<span id="cb9-2"><a href="#cb9-2"></a>                          <span class="at">T =</span> <span class="dv">100</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>                          <span class="at">N =</span> <span class="dv">100</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>                          <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                          <span class="at">l2.distribution =</span> <span class="st">"Gaussian"</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>                          <span class="at">uSeed =</span> <span class="dv">0</span>,</span>
<span id="cb9-7"><a href="#cb9-7"></a>                          <span class="at">version =</span> <span class="st">"v2"</span>) {</span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="co"># save global seed of the global env and set it back before leaving</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  seed.old <span class="ot">&lt;-</span> .Random.seed</span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">on.exit</span>({</span>
<span id="cb9-11"><a href="#cb9-11"></a>    .Random.seed <span class="ot">&lt;&lt;-</span> seed.old</span>
<span id="cb9-12"><a href="#cb9-12"></a>  })</span>
<span id="cb9-13"><a href="#cb9-13"></a>  <span class="fu">set.seed</span>(uSeed)</span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(Model) <span class="sc">==</span> <span class="st">"nar"</span>) {</span>
<span id="cb9-16"><a href="#cb9-16"></a>    model.name <span class="ot">&lt;-</span> <span class="st">"NAR"</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    lower_bound <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>    upper_bound <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    lev2.Mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>    lev2.Variance <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>    chi2.df <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>  }</span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(Model) <span class="sc">==</span> <span class="st">"chiar"</span> <span class="sc">|</span> <span class="fu">tolower</span>(Model) <span class="sc">==</span> <span class="st">"chi2ar"</span>) {</span>
<span id="cb9-25"><a href="#cb9-25"></a>    model.name <span class="ot">&lt;-</span> <span class="st">"Chi2AR"</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>    lower_bound <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>    upper_bound <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>    lev2.Mean <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>    lev2.Variance <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>    chi2.df <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>  }</span>
<span id="cb9-32"><a href="#cb9-32"></a></span>
<span id="cb9-33"><a href="#cb9-33"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(Model) <span class="sc">==</span> <span class="st">"binar"</span>) {</span>
<span id="cb9-34"><a href="#cb9-34"></a>    model.name <span class="ot">&lt;-</span> <span class="st">"BinAR"</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>    lower_bound <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>    upper_bound <span class="ot">&lt;-</span> k</span>
<span id="cb9-37"><a href="#cb9-37"></a>    lev2.Mean <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-38"><a href="#cb9-38"></a>    lev2.Variance <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-39"><a href="#cb9-39"></a>    chi2.df <span class="ot">&lt;-</span> <span class="fl">2.9</span></span>
<span id="cb9-40"><a href="#cb9-40"></a>  }</span>
<span id="cb9-41"><a href="#cb9-41"></a></span>
<span id="cb9-42"><a href="#cb9-42"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(Model) <span class="sc">==</span> <span class="st">"podar"</span>) {</span>
<span id="cb9-43"><a href="#cb9-43"></a>    model.name <span class="ot">&lt;-</span> <span class="st">"PoDAR"</span></span>
<span id="cb9-44"><a href="#cb9-44"></a>    lower_bound <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-45"><a href="#cb9-45"></a>    upper_bound <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-46"><a href="#cb9-46"></a>    lev2.Mean <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-47"><a href="#cb9-47"></a>    lev2.Variance <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-48"><a href="#cb9-48"></a>    chi2.df <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb9-49"><a href="#cb9-49"></a>  }</span>
<span id="cb9-50"><a href="#cb9-50"></a></span>
<span id="cb9-51"><a href="#cb9-51"></a>  <span class="co"># sampling within-person mean from level 2 distribution</span></span>
<span id="cb9-52"><a href="#cb9-52"></a>  <span class="cf">if</span> (l2.distribution <span class="sc">==</span> <span class="st">"Gaussian"</span>)</span>
<span id="cb9-53"><a href="#cb9-53"></a>    Means <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> N, lev2.Mean, <span class="fu">sqrt</span>(lev2.Variance))</span>
<span id="cb9-54"><a href="#cb9-54"></a>  <span class="cf">if</span> (l2.distribution <span class="sc">==</span> <span class="st">"Chi2"</span>)</span>
<span id="cb9-55"><a href="#cb9-55"></a>    Means <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">2</span> <span class="sc">*</span> N, chi2.df)</span>
<span id="cb9-56"><a href="#cb9-56"></a></span>
<span id="cb9-57"><a href="#cb9-57"></a>  <span class="co"># removing out-of-bounds means</span></span>
<span id="cb9-58"><a href="#cb9-58"></a>  Means[Means <span class="sc">&lt;</span> lower_bound] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-59"><a href="#cb9-59"></a>  Means[Means <span class="sc">&gt;</span> upper_bound] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-60"><a href="#cb9-60"></a></span>
<span id="cb9-61"><a href="#cb9-61"></a>  <span class="co"># keeping N samples from the in-bound means</span></span>
<span id="cb9-62"><a href="#cb9-62"></a>  Means <span class="ot">&lt;-</span> Means <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">sample</span>(N)</span>
<span id="cb9-63"><a href="#cb9-63"></a></span>
<span id="cb9-64"><a href="#cb9-64"></a>  <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb9-65"><a href="#cb9-65"></a>  Phis <span class="ot">&lt;-</span> <span class="fu">rep</span>(phi, N)</span>
<span id="cb9-66"><a href="#cb9-66"></a></span>
<span id="cb9-67"><a href="#cb9-67"></a>  <span class="do">## Implementing v2</span></span>
<span id="cb9-68"><a href="#cb9-68"></a>  <span class="cf">if</span>(version <span class="sc">==</span> <span class="st">"v2"</span>){</span>
<span id="cb9-69"><a href="#cb9-69"></a>    <span class="co"># sampling within-person phis</span></span>
<span id="cb9-70"><a href="#cb9-70"></a>    Phis <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> N, phi, <span class="fl">0.1</span>)</span>
<span id="cb9-71"><a href="#cb9-71"></a></span>
<span id="cb9-72"><a href="#cb9-72"></a>    <span class="co"># removing out-of-bounds phis</span></span>
<span id="cb9-73"><a href="#cb9-73"></a>    Phis[Phis <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-74"><a href="#cb9-74"></a>    Phis[Phis <span class="sc">&gt;=</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-75"><a href="#cb9-75"></a></span>
<span id="cb9-76"><a href="#cb9-76"></a>    <span class="co"># keeping N samples from the in-bound means</span></span>
<span id="cb9-77"><a href="#cb9-77"></a>    Phis <span class="ot">&lt;-</span> Phis <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">sample</span>(N)</span>
<span id="cb9-78"><a href="#cb9-78"></a>  }</span>
<span id="cb9-79"><a href="#cb9-79"></a></span>
<span id="cb9-80"><a href="#cb9-80"></a>  <span class="co"># Making a dataframe using dgm_make.sample</span></span>
<span id="cb9-81"><a href="#cb9-81"></a>  sample_df <span class="ot">&lt;-</span> <span class="fu">dgm_make.sample</span>(</span>
<span id="cb9-82"><a href="#cb9-82"></a>    <span class="at">Model =</span> Model,</span>
<span id="cb9-83"><a href="#cb9-83"></a>    <span class="at">Means =</span> Means,</span>
<span id="cb9-84"><a href="#cb9-84"></a>    <span class="at">T =</span> T,</span>
<span id="cb9-85"><a href="#cb9-85"></a>    <span class="at">Phis =</span> Phis,</span>
<span id="cb9-86"><a href="#cb9-86"></a>    <span class="at">seeds =</span> <span class="cn">NULL</span></span>
<span id="cb9-87"><a href="#cb9-87"></a>  )</span>
<span id="cb9-88"><a href="#cb9-88"></a></span>
<span id="cb9-89"><a href="#cb9-89"></a>  <span class="cf">if</span>(version <span class="sc">==</span> <span class="st">"v2"</span>) <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">dataset =</span> sample_df,</span>
<span id="cb9-90"><a href="#cb9-90"></a>                                  <span class="at">Means =</span> Means,</span>
<span id="cb9-91"><a href="#cb9-91"></a>                                  <span class="at">Phis =</span> Phis))</span>
<span id="cb9-92"><a href="#cb9-92"></a>  <span class="fu">return</span>(sample_df)</span>
<span id="cb9-93"><a href="#cb9-93"></a></span>
<span id="cb9-94"><a href="#cb9-94"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-analysis-component" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-analysis-component"><span class="header-section-number">1.2</span> The <em>Analysis</em> component</h2>
<p>We analyzed each dataset with AR(1) models with fixed and random residual variance using <em>M</em>plus v. 8.1 <span class="citation" data-cites="muthen_2017_MplusUserGuide">(<a href="#ref-muthen_2017_MplusUserGuide" role="doc-biblioref">Muthén and Muthén 2017</a>)</span>. To interface <em>M</em>plus from R, we used the package <code>MplusAutomation</code> <span class="citation" data-cites="hallquist_2018_MplusAutomationPackageFacilitating">(<a href="#ref-hallquist_2018_MplusAutomationPackageFacilitating" role="doc-biblioref">Hallquist and Wiley 2018</a>)</span> and wrote a function (<code>run_MplusAutomation</code>) that for each iteration of each condition would save the dataset as a <code>.dat</code> file, generate the <code>.inp</code> input script for the desired analysis type, and run the model for that dataset. <em>M</em>plus then saves the output files (<code>.out</code> and <code>.gh5</code>). After the analysis, <code>run_MplusAutomation</code> extracts parameter estimates and returns them in an <code>R</code> object, which, with some additional variables, are saved in separate <code>.rds</code> files using wrapper functions described in <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Addendum: Version 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <code>v2</code>, to make the analysis and data storage more efficient, <code>run_MplusAutomation</code> removes the <em>M</em>plus files generated by <code>MplusAutomation::mplusModeler</code> (<code>.inp</code>, <code>.dat</code>, <code>.out</code>, and <code>.gh5</code>), and drops <code>$results$gh5</code> from <code>mplusModeler</code>’s output (which would save a lot of space).</p>
</div>
</div>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-14_c98dbc03660f130816be960b34699508">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>run_MplusAutomation <span class="ot">&lt;-</span> <span class="cf">function</span>(df,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                                <span class="at">PROCESSORS =</span> <span class="dv">2</span>,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                                <span class="at">CHAINS =</span> <span class="dv">2</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                                <span class="at">THIN =</span> <span class="dv">2</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                                <span class="at">BITERATIONS.min =</span> <span class="dv">2000</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                                <span class="at">BITERATIONS.max =</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>                                  BITERATIONS.min <span class="sc">*</span> BITERATION.minmax.factor,</span>
<span id="cb10-8"><a href="#cb10-8"></a>                                <span class="at">BITERATION.minmax.factor =</span> <span class="fl">2.5</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>                                <span class="at">out.folder =</span> <span class="st">"Mplus-files/"</span>,</span>
<span id="cb10-10"><a href="#cb10-10"></a>                                <span class="at">model_what =</span> <span class="st">"resid.random"</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>                                <span class="at">file.name =</span> <span class="fu">Sys.Date</span>(),</span>
<span id="cb10-12"><a href="#cb10-12"></a>                                <span class="at">remove.files =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>                                <span class="at">drop.gh5 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-14"><a href="#cb10-14"></a>                                <span class="at">version =</span> <span class="st">"v2"</span>) {</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a>  inp.name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(out.folder,</span>
<span id="cb10-17"><a href="#cb10-17"></a>                     file.name)</span>
<span id="cb10-18"><a href="#cb10-18"></a></span>
<span id="cb10-19"><a href="#cb10-19"></a>  MplusAutomation<span class="sc">::</span><span class="fu">prepareMplusData</span>(df,</span>
<span id="cb10-20"><a href="#cb10-20"></a>                                    <span class="fu">paste0</span>(inp.name, <span class="st">".dat"</span>))</span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a>  VARIABLE <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"CLUSTER = subject;</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="st">                      LAGGED = x(1);</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="st">                      TINTERVAL = t(1);"</span>)</span>
<span id="cb10-25"><a href="#cb10-25"></a></span>
<span id="cb10-26"><a href="#cb10-26"></a>  ANALYSIS  <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb10-27"><a href="#cb10-27"></a>    <span class="st">"TYPE = TWOLEVEL RANDOM;</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="st">    ESTIMATOR = BAYES;</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="st">    PROCESSORS = {PROCESSORS};</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="st">    CHAINS = {CHAINS};</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="st">    THIN = {THIN};</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="st">    BITERATIONS = {BITERATIONS.max}({BITERATIONS.min});"</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>  )</span>
<span id="cb10-34"><a href="#cb10-34"></a></span>
<span id="cb10-35"><a href="#cb10-35"></a>  PLOT <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"TYPE = PLOT3;</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="st">                     FACTORS = ALL (500);"</span>)</span>
<span id="cb10-37"><a href="#cb10-37"></a></span>
<span id="cb10-38"><a href="#cb10-38"></a></span>
<span id="cb10-39"><a href="#cb10-39"></a>  <span class="cf">if</span> (model_what <span class="sc">==</span> <span class="st">"resid.random"</span>)</span>
<span id="cb10-40"><a href="#cb10-40"></a>    model_string <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"%WITHIN%</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="st">    phi | x ON x&amp;1;</span></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="st">    logv | x;</span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="st">    %BETWEEN%</span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="st">    x phi logv WITH x phi logv;"</span>)</span>
<span id="cb10-45"><a href="#cb10-45"></a></span>
<span id="cb10-46"><a href="#cb10-46"></a>  <span class="cf">if</span> (model_what <span class="sc">==</span> <span class="st">"resid.fixed"</span>)</span>
<span id="cb10-47"><a href="#cb10-47"></a>    model_string <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"%WITHIN%</span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="st">    phi | x ON x&amp;1;</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="st">    %BETWEEN%</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="st">    x phi WITH x phi;"</span>)</span>
<span id="cb10-51"><a href="#cb10-51"></a></span>
<span id="cb10-52"><a href="#cb10-52"></a></span>
<span id="cb10-53"><a href="#cb10-53"></a>  <span class="cf">if</span> (model_what <span class="sc">==</span> <span class="st">"within.between"</span>) {</span>
<span id="cb10-54"><a href="#cb10-54"></a>    model_string <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"%WITHIN%</span></span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="st">    x;</span></span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="st">    %BETWEEN%</span></span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="st">    x;"</span>)</span>
<span id="cb10-58"><a href="#cb10-58"></a>    VARIABLE <span class="ot">&lt;-</span> <span class="st">"CLUSTER = subject;"</span></span>
<span id="cb10-59"><a href="#cb10-59"></a>    PLOT <span class="ot">&lt;-</span> <span class="st">"TYPE = PLOT3;"</span></span>
<span id="cb10-60"><a href="#cb10-60"></a></span>
<span id="cb10-61"><a href="#cb10-61"></a>  }</span>
<span id="cb10-62"><a href="#cb10-62"></a></span>
<span id="cb10-63"><a href="#cb10-63"></a></span>
<span id="cb10-64"><a href="#cb10-64"></a>  model.ar1 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb10-65"><a href="#cb10-65"></a>    <span class="at">TITLE =</span> inp.name,</span>
<span id="cb10-66"><a href="#cb10-66"></a>    <span class="at">rdata =</span> df,</span>
<span id="cb10-67"><a href="#cb10-67"></a>    <span class="at">usevariables =</span> <span class="fu">c</span>(<span class="st">"subject"</span>, <span class="st">"t"</span>, <span class="st">"x"</span>),</span>
<span id="cb10-68"><a href="#cb10-68"></a>    <span class="at">VARIABLE =</span> VARIABLE,</span>
<span id="cb10-69"><a href="#cb10-69"></a>    <span class="at">ANALYSIS =</span> ANALYSIS,</span>
<span id="cb10-70"><a href="#cb10-70"></a>    <span class="at">MODEL =</span> model_string,</span>
<span id="cb10-71"><a href="#cb10-71"></a>    <span class="at">OUTPUT =</span> <span class="st">"TECH1 TECH2 TECH3 TECH8 FSCOMPARISON STANDARDIZED STDYX STDY;"</span>,</span>
<span id="cb10-72"><a href="#cb10-72"></a>    <span class="at">PLOT =</span> PLOT</span>
<span id="cb10-73"><a href="#cb10-73"></a>  )</span>
<span id="cb10-74"><a href="#cb10-74"></a></span>
<span id="cb10-75"><a href="#cb10-75"></a></span>
<span id="cb10-76"><a href="#cb10-76"></a>  fit.ar1 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(</span>
<span id="cb10-77"><a href="#cb10-77"></a>    model.ar1,</span>
<span id="cb10-78"><a href="#cb10-78"></a>    <span class="at">check =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-79"><a href="#cb10-79"></a>    <span class="at">modelout =</span> <span class="fu">paste0</span>(inp.name, <span class="st">".inp"</span>),</span>
<span id="cb10-80"><a href="#cb10-80"></a>    <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-81"><a href="#cb10-81"></a>    <span class="at">run =</span> 1L</span>
<span id="cb10-82"><a href="#cb10-82"></a>  )</span>
<span id="cb10-83"><a href="#cb10-83"></a></span>
<span id="cb10-84"><a href="#cb10-84"></a>  <span class="co"># Adapting for v2 implementation:</span></span>
<span id="cb10-85"><a href="#cb10-85"></a>  <span class="cf">if</span>(version <span class="sc">==</span> <span class="st">"v2"</span>) remove.files <span class="ot">&lt;-</span> drop.gh5 <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb10-86"><a href="#cb10-86"></a></span>
<span id="cb10-87"><a href="#cb10-87"></a>  <span class="co"># Removing Mplus files generated by the R function</span></span>
<span id="cb10-88"><a href="#cb10-88"></a>  <span class="cf">if</span> (remove.files <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-89"><a href="#cb10-89"></a>    remove.files <span class="ot">&lt;-</span> <span class="fu">file.remove</span>(<span class="fu">file.path</span>(</span>
<span id="cb10-90"><a href="#cb10-90"></a>      out.folder,</span>
<span id="cb10-91"><a href="#cb10-91"></a>      <span class="fu">dir</span>(</span>
<span id="cb10-92"><a href="#cb10-92"></a>        <span class="at">path =</span> out.folder,</span>
<span id="cb10-93"><a href="#cb10-93"></a>        <span class="at">pattern =</span> file.name,</span>
<span id="cb10-94"><a href="#cb10-94"></a>        <span class="at">ignore.case =</span> <span class="cn">TRUE</span></span>
<span id="cb10-95"><a href="#cb10-95"></a>      )</span>
<span id="cb10-96"><a href="#cb10-96"></a>    ))</span>
<span id="cb10-97"><a href="#cb10-97"></a></span>
<span id="cb10-98"><a href="#cb10-98"></a>  <span class="co"># Dropping gh5 from the R object</span></span>
<span id="cb10-99"><a href="#cb10-99"></a>  <span class="cf">if</span>(drop.gh5 <span class="sc">==</span> <span class="cn">TRUE</span>) fit.ar1<span class="sc">$</span>results<span class="sc">$</span>gh5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-100"><a href="#cb10-100"></a></span>
<span id="cb10-101"><a href="#cb10-101"></a>  <span class="fu">return</span>(fit.ar1)</span>
<span id="cb10-102"><a href="#cb10-102"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In each analysis, we simulated two MCMC chains (<code>CHAINS = 2</code>), and to reduce autocorrelation in the estimated parameters, by defining <code>THIN = 5</code> we asked <em>M</em>plus to save every 5th sample. By setting <code>BITERATIONS = 5000(2000)</code>, we made sure to have between 2000 to 5000 samples (after thinning) for each parameter from each chain. <em>M</em>plus considers the first half of each chain as burn-in samples and discards them, thus, in total, we got at least 2000 “independent” samples from both chains combined. Finally, with <code>FACTORS = ALL (500)</code> we asked <em>M</em>plus to draw 500 samples for each individuals when estimating level-1 parameters. We visually inspected the traceplots and autocorrelation plots of parameter estimates and of a sample of analyzed datasets and good convergence was observed. Furthermore, to make sure the number of iterations and thinning used in the analyses provide sufficiently accurate estimates, we re-analyzed two replications of each alternative DGM with Gaussian and <span class="math inline">\(\chi^2\)</span>-distributed means with <span class="math inline">\(N=100\)</span> and <span class="math inline">\(T=100\)</span> with <code>BITERATIONS = 12500(5000)</code> and <code>THIN = 20</code>, which led to estimates of the parameters of interest (<code>unstd X.WITH.PHI</code>, <code>unstd Variances.PHI</code>, and <code>stdyx X.WITH.PHI</code>) almost identical (up to the third decimal) to those estimated with <code>BITERATIONS = 5000(2000)</code> and <code>THIN = 5</code> (see below).</p>
<p>The generated input files looked like the following. Note that the <code>TITLE</code> and <code>DATA</code> strings in the <code>.inp</code> files are unique to the dataset being analyzed and included the unique dataset seed <code>uSeed</code> (passed to <code>make_datasets</code> to generate datasets), the number of individuals in the dataset <code>N</code>, the length of the time series <code>T</code>, the model types used (<code>resid.fixed</code> or <code>resid.random</code>), and the replication number <code>Rep</code> (see <a href="#sec-bookkeeping">Section&nbsp;2.1</a> for further details).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Fixed residual variance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Random residual variance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Comparing different <code>ANALYSIS</code> parameters</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>By estimating the covariances between mean and autoregression (<code>x phi WITH x phi</code> under the <code>BETWEEN%</code> command), the following <em>M</em>plus script runs an AR(1) with random effect mean and autoregressive parameter but with fixed effect residual variance.</p>
<div class="cell" data-file="scripts/Mplus-input_fixed-resid.inp" data-hash="Code-documentations_cache/html/Mplus-input_fixed-resid_017aba40e461e5e6ea1e398a5351fc9a">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource inp number-lines code-with-copy"><code class="sourceCode"><span id="cb11-1"><a href="#cb11-1"></a>TITLE:</span>
<span id="cb11-2"><a href="#cb11-2"></a>fit_uSeed-000000_N-100_T-100_type-resid.fixed_Rep-1</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>DATA:</span>
<span id="cb11-5"><a href="#cb11-5"></a>FILE = "fit_uSeed-000000_N-100_T-100_type-resid.fixed_Rep-1.dat";</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>VARIABLE:</span>
<span id="cb11-8"><a href="#cb11-8"></a>NAMES = subject t x;</span>
<span id="cb11-9"><a href="#cb11-9"></a>MISSING=.;</span>
<span id="cb11-10"><a href="#cb11-10"></a>CLUSTER = subject;</span>
<span id="cb11-11"><a href="#cb11-11"></a>LAGGED = x(1);</span>
<span id="cb11-12"><a href="#cb11-12"></a>TINTERVAL = t(1);</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a>ANALYSIS:</span>
<span id="cb11-15"><a href="#cb11-15"></a>TYPE = TWOLEVEL RANDOM;</span>
<span id="cb11-16"><a href="#cb11-16"></a>ESTIMATOR = BAYES;</span>
<span id="cb11-17"><a href="#cb11-17"></a>PROCESSORS = 1;</span>
<span id="cb11-18"><a href="#cb11-18"></a>CHAINS = 2;</span>
<span id="cb11-19"><a href="#cb11-19"></a>THIN = 5;</span>
<span id="cb11-20"><a href="#cb11-20"></a>BITERATIONS = 5000(2000);</span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a>MODEL:</span>
<span id="cb11-23"><a href="#cb11-23"></a>%WITHIN%</span>
<span id="cb11-24"><a href="#cb11-24"></a>phi | x ON x&amp;1;</span>
<span id="cb11-25"><a href="#cb11-25"></a>%BETWEEN%</span>
<span id="cb11-26"><a href="#cb11-26"></a>x phi WITH x phi;</span>
<span id="cb11-27"><a href="#cb11-27"></a></span>
<span id="cb11-28"><a href="#cb11-28"></a>OUTPUT:</span>
<span id="cb11-29"><a href="#cb11-29"></a>TECH1 TECH2 TECH3 TECH8 FSCOMPARISON STANDARDIZED STDYX STDY;</span>
<span id="cb11-30"><a href="#cb11-30"></a></span>
<span id="cb11-31"><a href="#cb11-31"></a>PLOT:</span>
<span id="cb11-32"><a href="#cb11-32"></a>TYPE = PLOT3;</span>
<span id="cb11-33"><a href="#cb11-33"></a>FACTORS = ALL (500);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>By estimating the logarithm of the residual variance at level 1 (by <code>logv | x</code> under the <code>%WITHIN%</code> command) and estimating the covariances between the level-2 mean, autoregression, and residual variance (<code>x phi logv WITH x phi logv</code> under the <code>%BETWEEN%</code> command), the following <em>M</em>plus script runs an AR(1) model with random effect mean, autoregressive parameter, and residual variance.</p>
<div class="cell" data-file="scripts/Mplus-input_random-resid.inp" data-hash="Code-documentations_cache/html/Mplus-input_random-resid_05dbc9fd19d17347c5514ed267ab47e2">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource inp number-lines code-with-copy"><code class="sourceCode"><span id="cb12-1"><a href="#cb12-1"></a>TITLE:</span>
<span id="cb12-2"><a href="#cb12-2"></a>fit_uSeed-000000_N-100_T-100_type-resid.random_Rep-1</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a>DATA:</span>
<span id="cb12-5"><a href="#cb12-5"></a>FILE = "fit_uSeed-000000_N-100_T-100_type-resid.random_Rep-1.dat";</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>VARIABLE:</span>
<span id="cb12-8"><a href="#cb12-8"></a>NAMES = subject t x;</span>
<span id="cb12-9"><a href="#cb12-9"></a>MISSING=.;</span>
<span id="cb12-10"><a href="#cb12-10"></a>CLUSTER = subject;</span>
<span id="cb12-11"><a href="#cb12-11"></a>LAGGED = x(1);</span>
<span id="cb12-12"><a href="#cb12-12"></a>TINTERVAL = t(1);</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a>ANALYSIS:</span>
<span id="cb12-15"><a href="#cb12-15"></a>TYPE = TWOLEVEL RANDOM;</span>
<span id="cb12-16"><a href="#cb12-16"></a>ESTIMATOR = BAYES;</span>
<span id="cb12-17"><a href="#cb12-17"></a>PROCESSORS = 1;</span>
<span id="cb12-18"><a href="#cb12-18"></a>CHAINS = 2;</span>
<span id="cb12-19"><a href="#cb12-19"></a>THIN = 5;</span>
<span id="cb12-20"><a href="#cb12-20"></a>BITERATIONS = 5000(2000);</span>
<span id="cb12-21"><a href="#cb12-21"></a></span>
<span id="cb12-22"><a href="#cb12-22"></a>MODEL:</span>
<span id="cb12-23"><a href="#cb12-23"></a>%WITHIN%</span>
<span id="cb12-24"><a href="#cb12-24"></a>phi | x ON x&amp;1;</span>
<span id="cb12-25"><a href="#cb12-25"></a>logv | x;</span>
<span id="cb12-26"><a href="#cb12-26"></a>%BETWEEN%</span>
<span id="cb12-27"><a href="#cb12-27"></a>x phi logv WITH x phi logv;</span>
<span id="cb12-28"><a href="#cb12-28"></a></span>
<span id="cb12-29"><a href="#cb12-29"></a>OUTPUT:</span>
<span id="cb12-30"><a href="#cb12-30"></a>TECH1 TECH2 TECH3 TECH8 FSCOMPARISON STANDARDIZED STDYX STDY;</span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a>PLOT:</span>
<span id="cb12-33"><a href="#cb12-33"></a>TYPE = PLOT3;</span>
<span id="cb12-34"><a href="#cb12-34"></a>FACTORS = ALL (500);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>The table below shows the estimated parameters of two replications of with <code>BITERATIONS = 5000(2000)</code> and <code>THIN = 5</code> (specified in the table with <code>2k x 5</code>) and <code>BITERATIONS = 12500(5000)</code> and <code>THIN = 20</code> (specified in the table with <code>5k x 20</code>). The relevant parameters (level-2 correlations <code>X.WITH.PHI  unstd</code>, covariances <code>X.WITH.PHI stdyx</code>, and variance <code>Variances.PHI unstd</code>) are highlighted with orange.</p>
<iframe width="700" height="500" src="./additional-files/hyperparameters.html" title="Quarto Documentation"></iframe>
</div>
</div>
</div>
</section>
<section id="sec-harvesting-component" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sec-harvesting-component"><span class="header-section-number">1.3</span> The <em>Harvesting</em> component</h2>
<p>Extracting parameter estimates of individual analyses</p>
<p>The function <code>fit_extract</code> gets an <code>.rds</code> file generated by <code>do_fit_doFuture</code> (see <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>)—which includes book-keeping information and Mplus output object that was generated by <code>run_MplusAutomation</code> (see <a href="#sec-analysis-component">Section&nbsp;1.2</a>)—and extracts the <code>unstandardized</code> and <code>stdyx.standardized</code> <em>M</em>plus parameter estimates and stores them, along with the additional book-keeping information, in a dataframe.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-17_966977f57686b2722f980805722aacf6">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>fit_extract <span class="ot">&lt;-</span> <span class="cf">function</span>(rds.file){</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>  m <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(rds.file)</span>
<span id="cb13-4"><a href="#cb13-4"></a>  est.par <span class="ot">&lt;-</span> m[[<span class="st">"fit.Dataset"</span>]][[<span class="st">"results"</span>]][[<span class="st">"parameters"</span>]]</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="co"># make empty dataframe for NAs</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  empty <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">19</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="fu">colnames</span>(empty) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"uSeed"</span>, <span class="st">"type"</span>, <span class="st">"l2.dist"</span>, <span class="st">"Model"</span>, <span class="st">"N"</span>, <span class="st">"phi"</span>, <span class="st">"T"</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>                       <span class="st">"Rep"</span>, <span class="st">"standardization"</span>, <span class="st">"est"</span>, <span class="st">"posterior_sd"</span>, <span class="st">"pval"</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>                       <span class="st">"lower_2.5ci"</span>, <span class="st">"upper_2.5ci"</span>, <span class="st">"sig"</span>, <span class="st">"BetweenWithin"</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>                       <span class="st">"param.name"</span>, <span class="st">"fit.ElapsedTime"</span>, <span class="st">"fit.File"</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="cf">if</span>(<span class="fu">length</span>(est.par) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(empty)</span>
<span id="cb13-14"><a href="#cb13-14"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(est.par[[<span class="st">"unstandardized"</span>]])) <span class="fu">return</span>(empty)</span>
<span id="cb13-15"><a href="#cb13-15"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(est.par[[<span class="st">"stdyx.standardized"</span>]])) <span class="fu">return</span>(empty)</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a>  unstd <span class="ot">&lt;-</span> est.par[[<span class="st">"unstandardized"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="fu">mutate</span>(<span class="at">param.name =</span> <span class="fu">paste</span>(paramHeader,</span>
<span id="cb13-19"><a href="#cb13-19"></a>                              param,</span>
<span id="cb13-20"><a href="#cb13-20"></a>                              <span class="at">sep =</span> <span class="st">"."</span>)</span>
<span id="cb13-21"><a href="#cb13-21"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22"></a>    <span class="fu">select</span>(<span class="sc">-</span>paramHeader<span class="sc">:-</span>param) <span class="sc">%&gt;%</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>    <span class="fu">mutate</span>(<span class="at">standardization =</span> <span class="st">"unstd"</span>,</span>
<span id="cb13-24"><a href="#cb13-24"></a>           <span class="at">.before =</span> est)</span>
<span id="cb13-25"><a href="#cb13-25"></a>  stdyx <span class="ot">&lt;-</span> est.par[[<span class="st">"stdyx.standardized"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26"></a>    <span class="fu">mutate</span>(<span class="at">param.name =</span> <span class="fu">paste</span>(paramHeader,</span>
<span id="cb13-27"><a href="#cb13-27"></a>                              param,</span>
<span id="cb13-28"><a href="#cb13-28"></a>                              <span class="at">sep =</span> <span class="st">"."</span>)</span>
<span id="cb13-29"><a href="#cb13-29"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>    <span class="fu">select</span>(<span class="sc">-</span>paramHeader<span class="sc">:-</span>param) <span class="sc">%&gt;%</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>    <span class="fu">mutate</span>(<span class="at">standardization =</span> <span class="st">"stdyx"</span>,</span>
<span id="cb13-32"><a href="#cb13-32"></a>           <span class="at">.before =</span> est)</span>
<span id="cb13-33"><a href="#cb13-33"></a></span>
<span id="cb13-34"><a href="#cb13-34"></a>  m<span class="sc">$</span>fit.Dataset <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-35"><a href="#cb13-35"></a></span>
<span id="cb13-36"><a href="#cb13-36"></a>  res <span class="ot">&lt;-</span> unstd <span class="sc">%&gt;%</span></span>
<span id="cb13-37"><a href="#cb13-37"></a>    <span class="fu">rbind</span>(stdyx) <span class="sc">%&gt;%</span></span>
<span id="cb13-38"><a href="#cb13-38"></a>    <span class="fu">mutate</span>(<span class="at">fit.ElapsedTime =</span> (<span class="fu">difftime</span>(m[[<span class="st">"fit.EndTime"</span>]],</span>
<span id="cb13-39"><a href="#cb13-39"></a>                                       m[[<span class="st">"fit.StartTime"</span>]],</span>
<span id="cb13-40"><a href="#cb13-40"></a>                                       <span class="at">units=</span><span class="st">"mins"</span>)</span>
<span id="cb13-41"><a href="#cb13-41"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-42"><a href="#cb13-42"></a>      <span class="fu">as.numeric</span>(),</span>
<span id="cb13-43"><a href="#cb13-43"></a>    <span class="at">fit.File =</span> <span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, m<span class="sc">$</span>fit.File)) <span class="sc">%&gt;%</span></span>
<span id="cb13-44"><a href="#cb13-44"></a>    <span class="fu">mutate</span>(<span class="at">uSeed =</span> m<span class="sc">$</span>uSeed,</span>
<span id="cb13-45"><a href="#cb13-45"></a>           <span class="at">type =</span> m<span class="sc">$</span>type,</span>
<span id="cb13-46"><a href="#cb13-46"></a>           <span class="at">l2.dist =</span> m<span class="sc">$</span>l2.dist,</span>
<span id="cb13-47"><a href="#cb13-47"></a>           <span class="at">Model =</span> m<span class="sc">$</span>Model,</span>
<span id="cb13-48"><a href="#cb13-48"></a>           <span class="at">N =</span> m<span class="sc">$</span>N,</span>
<span id="cb13-49"><a href="#cb13-49"></a>           <span class="at">phi =</span> m<span class="sc">$</span>phi,</span>
<span id="cb13-50"><a href="#cb13-50"></a>           <span class="at">T =</span> m<span class="sc">$</span>T,</span>
<span id="cb13-51"><a href="#cb13-51"></a>           <span class="at">Rep =</span> m<span class="sc">$</span>Rep,</span>
<span id="cb13-52"><a href="#cb13-52"></a>           <span class="at">.before =</span> standardization</span>
<span id="cb13-53"><a href="#cb13-53"></a>    )</span>
<span id="cb13-54"><a href="#cb13-54"></a></span>
<span id="cb13-55"><a href="#cb13-55"></a>  <span class="fu">return</span>(res)</span>
<span id="cb13-56"><a href="#cb13-56"></a></span>
<span id="cb13-57"><a href="#cb13-57"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-reporting-component" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="sec-reporting-component"><span class="header-section-number">1.4</span> The <em>Reporting</em> component</h2>
<p>This component includes a function that clean the harvested dataset (and extract the relevant information) and functions to generate dataset profile plots, results figures, and parameter estimates coverage plots.</p>
<p>Given that the figures contain customized typefaces (from the <code>CMU Serif</code> and <code>Merriweather</code> font families), we need to make load the fonts:</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-18_c21d72bce93184d0b34edd267b808d90">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># Check the current search path for fonts</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="fu">font_paths</span>()</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; [1] "C:\\Windows\\Fonts"</span></span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># List available font files in the search path</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>f <span class="ot">&lt;-</span> <span class="fu">font_files</span>()</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">font_add</span>(<span class="st">"CMU Classical Serif"</span>, <span class="st">"cmunci.ttf"</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="fu">font_add</span>(<span class="st">"CMU Serif Upright Italic"</span>, <span class="st">"cmunui.ttf"</span>)</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="fu">font_add</span>(<span class="st">"CMU Serif"</span>, <span class="st">"cmunrm.ttf"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="fu">font_add</span>(<span class="st">"Merriweather Regular"</span>, <span class="st">"Merriweather-Regular.ttf"</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="fu">font_add</span>(<span class="st">"Merriweather Light"</span>, <span class="st">"Merriweather Light.ttf"</span>)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="fu">font_families</span>()</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="do">## automatically use showtext for new devices</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb14-21"><a href="#cb14-21"></a></span>
<span id="cb14-22"><a href="#cb14-22"></a></span>
<span id="cb14-23"><a href="#cb14-23"></a>p.colors <span class="ot">&lt;-</span></span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"YlOrBr"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)]</span>
<span id="cb14-25"><a href="#cb14-25"></a></span>
<span id="cb14-26"><a href="#cb14-26"></a>palette_nar <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"YlOrBr"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)]</span>
<span id="cb14-27"><a href="#cb14-27"></a>palette_chiar <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"GnBu"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)]</span>
<span id="cb14-28"><a href="#cb14-28"></a>palette_binar <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"YlGn"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)]</span>
<span id="cb14-29"><a href="#cb14-29"></a>palette_podar <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"BuPu"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)]</span>
<span id="cb14-30"><a href="#cb14-30"></a></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co"># Pair plots --------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="sec-report-clean-harvest" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="sec-report-clean-harvest"><span class="header-section-number">1.4.1</span> Cleaning the harvested dataset</h3>
<p>Given that the output of <code>fit_extract</code> has too much information in it, the function <code>harvest_cleanup</code> extracts the relevant parameter estimates—the point estimates and the upper and lower 2.5 crediblity intervals of level-2 covariance (<code>unstd X.WITH.PHI)</code>, level-2 correlation (<code>stdyx X.WITH.PHI</code>), and fixed-effect autoregressive parameter at level 2 (<code>unstd Means.PHI</code>)—cleans the datasets and makes it <em>tidy</em>, and calculates the outcomes of interest, namely, the (absolute) average estimates, mean absolute and squared error, root mean squared error, estimation bias and variance, number and percentage of of non-converged datasets, and the percentages of significantly positive or negative or non-significant parameter estimates.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-19_6aaafd77ec1b4bff1490b9c6f04beeef">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>harvest_cleanup <span class="ot">&lt;-</span> <span class="cf">function</span>(harv,</span>
<span id="cb15-2"><a href="#cb15-2"></a>                            <span class="at">return.abridged =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>  d_abridged <span class="ot">&lt;-</span> harv <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="fu">mutate</span>(<span class="at">std_parname =</span> <span class="fu">paste</span>(standardization, param.name)) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="fu">filter</span>(std_parname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"stdyx X.WITH.PHI"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>                              <span class="st">"unstd X.WITH.PHI"</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>                              <span class="st">"unstd Means.PHI"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="fu">select</span>(<span class="sc">-</span>standardization) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-12"><a href="#cb15-12"></a>      <span class="at">parameter =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-13"><a href="#cb15-13"></a>        std_parname  <span class="sc">==</span> <span class="st">"stdyx X.WITH.PHI"</span> <span class="sc">~</span> <span class="st">"Correlation"</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>        std_parname  <span class="sc">==</span> <span class="st">"unstd X.WITH.PHI"</span> <span class="sc">~</span> <span class="st">"Covariance"</span>,</span>
<span id="cb15-15"><a href="#cb15-15"></a>        std_parname  <span class="sc">==</span> <span class="st">"unstd Means.PHI"</span> <span class="sc">~</span> <span class="st">"Fixed.Phi"</span>,</span>
<span id="cb15-16"><a href="#cb15-16"></a>      ),</span>
<span id="cb15-17"><a href="#cb15-17"></a>      <span class="at">.after =</span> Rep</span>
<span id="cb15-18"><a href="#cb15-18"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="fu">select</span>(uSeed<span class="sc">:</span>sig) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-21"><a href="#cb15-21"></a>      <span class="at">true.value =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-22"><a href="#cb15-22"></a>        parameter <span class="sc">==</span> <span class="st">"Correlation"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb15-23"><a href="#cb15-23"></a>        parameter <span class="sc">==</span> <span class="st">"Covariance"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb15-24"><a href="#cb15-24"></a>        parameter <span class="sc">==</span> <span class="st">"Fixed.Phi"</span> <span class="sc">~</span> <span class="fl">0.4</span></span>
<span id="cb15-25"><a href="#cb15-25"></a>      ),</span>
<span id="cb15-26"><a href="#cb15-26"></a>      <span class="at">.after =</span> sig</span>
<span id="cb15-27"><a href="#cb15-27"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28"></a>    <span class="fu">mutate</span>(<span class="at">l2.X.Model =</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(l2.dist, Model)),</span>
<span id="cb15-29"><a href="#cb15-29"></a>           <span class="at">.before =</span> N) <span class="sc">%&gt;%</span></span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-31"><a href="#cb15-31"></a>      <span class="at">sign.X.sig =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-32"><a href="#cb15-32"></a>        upper_2<span class="fl">.5</span>ci <span class="sc">&lt;</span> true.value <span class="sc">~</span> <span class="st">"Negative"</span>,</span>
<span id="cb15-33"><a href="#cb15-33"></a>        lower_2<span class="fl">.5</span>ci <span class="sc">&gt;</span> true.value <span class="sc">~</span> <span class="st">"Positive"</span>,</span>
<span id="cb15-34"><a href="#cb15-34"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Zero"</span></span>
<span id="cb15-35"><a href="#cb15-35"></a>      )</span>
<span id="cb15-36"><a href="#cb15-36"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb15-37"><a href="#cb15-37"></a>    <span class="fu">group_by</span>(type,</span>
<span id="cb15-38"><a href="#cb15-38"></a>             l2.X.Model,</span>
<span id="cb15-39"><a href="#cb15-39"></a>             N,</span>
<span id="cb15-40"><a href="#cb15-40"></a>             T,</span>
<span id="cb15-41"><a href="#cb15-41"></a>             parameter) <span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-43"><a href="#cb15-43"></a>      <span class="at">mean.est =</span> <span class="fu">mean</span>(est),</span>
<span id="cb15-44"><a href="#cb15-44"></a>      <span class="at">mean.abs.est =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(est)),</span>
<span id="cb15-45"><a href="#cb15-45"></a>      <span class="at">MAE =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(est <span class="sc">-</span> true.value)),</span>
<span id="cb15-46"><a href="#cb15-46"></a>      <span class="at">MSE =</span> <span class="fu">mean</span>((est <span class="sc">-</span> true.value) <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb15-47"><a href="#cb15-47"></a>      <span class="at">RMSE =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((est <span class="sc">-</span> true.value) <span class="sc">^</span> <span class="dv">2</span>)),</span>
<span id="cb15-48"><a href="#cb15-48"></a>      <span class="at">Bias =</span> <span class="fu">mean</span>(est) <span class="sc">-</span> true.value,</span>
<span id="cb15-49"><a href="#cb15-49"></a>      <span class="at">Variance =</span> <span class="fu">var</span>(est),</span>
<span id="cb15-50"><a href="#cb15-50"></a>      <span class="at">n.converged.datasets =</span> <span class="fu">n</span>(),</span>
<span id="cb15-51"><a href="#cb15-51"></a>      <span class="at">nonconverged.percent =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> (<span class="dv">1000</span> <span class="sc">-</span> <span class="fu">n</span>()) <span class="sc">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb15-52"><a href="#cb15-52"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb15-53"><a href="#cb15-53"></a>    <span class="fu">arrange</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb15-54"><a href="#cb15-54"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-55"><a href="#cb15-55"></a>    <span class="fu">group_by</span>(type,</span>
<span id="cb15-56"><a href="#cb15-56"></a>             N,</span>
<span id="cb15-57"><a href="#cb15-57"></a>             T,</span>
<span id="cb15-58"><a href="#cb15-58"></a>             l2.dist,</span>
<span id="cb15-59"><a href="#cb15-59"></a>             Model) <span class="sc">%&gt;%</span></span>
<span id="cb15-60"><a href="#cb15-60"></a>    <span class="fu">mutate</span>(<span class="at">ord =</span> <span class="fu">order</span>(est) <span class="sc">-</span> <span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-61"><a href="#cb15-61"></a>    <span class="fu">group_by</span>(sign.X.sig,</span>
<span id="cb15-62"><a href="#cb15-62"></a>             <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-63"><a href="#cb15-63"></a>    <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">n</span>() <span class="sc">/</span> n.converged.datasets, <span class="dv">1</span>),</span>
<span id="cb15-64"><a href="#cb15-64"></a>           <span class="at">.after =</span> sign.X.sig) <span class="sc">%&gt;%</span></span>
<span id="cb15-65"><a href="#cb15-65"></a>    <span class="fu">relocate</span>(sign.X.sig<span class="sc">:</span>nonconverged.percent,</span>
<span id="cb15-66"><a href="#cb15-66"></a>             <span class="at">.after =</span> parameter) <span class="sc">%&gt;%</span></span>
<span id="cb15-67"><a href="#cb15-67"></a>    <span class="fu">relocate</span>(est,</span>
<span id="cb15-68"><a href="#cb15-68"></a>             <span class="at">.after =</span> percent)</span>
<span id="cb15-69"><a href="#cb15-69"></a></span>
<span id="cb15-70"><a href="#cb15-70"></a>  <span class="fu">levels</span>(d_abridged<span class="sc">$</span>sign.X.sig) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb15-71"><a href="#cb15-71"></a>    <span class="st">"Significant negative estimates"</span>,</span>
<span id="cb15-72"><a href="#cb15-72"></a>    <span class="st">"Non-significant estimates"</span>,</span>
<span id="cb15-73"><a href="#cb15-73"></a>    <span class="st">"Significant positive estimates"</span></span>
<span id="cb15-74"><a href="#cb15-74"></a>  )</span>
<span id="cb15-75"><a href="#cb15-75"></a></span>
<span id="cb15-76"><a href="#cb15-76"></a>  <span class="cf">if</span>(return.abridged <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="fu">return</span>(d_abridged)</span>
<span id="cb15-77"><a href="#cb15-77"></a></span>
<span id="cb15-78"><a href="#cb15-78"></a>  d_summary <span class="ot">&lt;-</span> d_abridged <span class="sc">%&gt;%</span></span>
<span id="cb15-79"><a href="#cb15-79"></a>    <span class="fu">select</span>(type<span class="sc">:</span>nonconverged.percent) <span class="sc">%&gt;%</span></span>
<span id="cb15-80"><a href="#cb15-80"></a>    <span class="fu">select</span>(<span class="sc">-</span>Rep, <span class="sc">-</span>est) <span class="sc">%&gt;%</span></span>
<span id="cb15-81"><a href="#cb15-81"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-82"><a href="#cb15-82"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Type-1 error</span><span class="st">`</span> <span class="ot">=</span> percent,</span>
<span id="cb15-83"><a href="#cb15-83"></a>           <span class="at">.after =</span> Variance</span>
<span id="cb15-84"><a href="#cb15-84"></a>    )</span>
<span id="cb15-85"><a href="#cb15-85"></a></span>
<span id="cb15-86"><a href="#cb15-86"></a></span>
<span id="cb15-87"><a href="#cb15-87"></a>  d_important <span class="ot">&lt;-</span> d_summary[<span class="fu">with</span>(d_summary,</span>
<span id="cb15-88"><a href="#cb15-88"></a>                                <span class="fu">order</span>(type,</span>
<span id="cb15-89"><a href="#cb15-89"></a>                                      l2.X.Model,</span>
<span id="cb15-90"><a href="#cb15-90"></a>                                      parameter,</span>
<span id="cb15-91"><a href="#cb15-91"></a>                                      N,</span>
<span id="cb15-92"><a href="#cb15-92"></a>                                      T)), ] <span class="sc">%&gt;%</span></span>
<span id="cb15-93"><a href="#cb15-93"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Model name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(Model, <span class="st">"(1)"</span>),</span>
<span id="cb15-94"><a href="#cb15-94"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"NAR(1)"</span>,</span>
<span id="cb15-95"><a href="#cb15-95"></a>                                            <span class="st">"Chi2AR(1)"</span>,</span>
<span id="cb15-96"><a href="#cb15-96"></a>                                            <span class="st">"BinAR(1)"</span>,</span>
<span id="cb15-97"><a href="#cb15-97"></a>                                            <span class="st">"PoDAR(1)"</span>)</span>
<span id="cb15-98"><a href="#cb15-98"></a>    ),</span>
<span id="cb15-99"><a href="#cb15-99"></a>    <span class="st">`</span><span class="at">Means distribution</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(l2.dist, <span class="st">"-distributed means"</span>),</span>
<span id="cb15-100"><a href="#cb15-100"></a>    <span class="at">Resid =</span> <span class="fu">case_when</span>(type <span class="sc">==</span> <span class="st">"resid.fixed"</span> <span class="sc">~</span> <span class="st">"`Fixed Residual Variance`"</span>,</span>
<span id="cb15-101"><a href="#cb15-101"></a>                      type <span class="sc">==</span> <span class="st">"resid.random"</span> <span class="sc">~</span> <span class="st">"`Random Residual Variance`"</span>),</span>
<span id="cb15-102"><a href="#cb15-102"></a>    <span class="at">.after =</span> l2.X.Model)</span>
<span id="cb15-103"><a href="#cb15-103"></a></span>
<span id="cb15-104"><a href="#cb15-104"></a>  <span class="fu">levels</span>(d_important<span class="sc">$</span><span class="st">`</span><span class="at">Model name</span><span class="st">`</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">NAR(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"AR(1)"</span>,</span>
<span id="cb15-105"><a href="#cb15-105"></a>                                        <span class="st">`</span><span class="at">Chi2AR(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$AR(1)"</span>),</span>
<span id="cb15-106"><a href="#cb15-106"></a>                                        <span class="st">`</span><span class="at">BinAR(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"BinAR(1)"</span>,</span>
<span id="cb15-107"><a href="#cb15-107"></a>                                        <span class="st">`</span><span class="at">PoDAR(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"PoDAR(1)"</span>)</span>
<span id="cb15-108"><a href="#cb15-108"></a></span>
<span id="cb15-109"><a href="#cb15-109"></a>  <span class="fu">return</span>(d_important)</span>
<span id="cb15-110"><a href="#cb15-110"></a></span>
<span id="cb15-111"><a href="#cb15-111"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-make-distribution-plots" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="sec-make-distribution-plots"><span class="header-section-number">1.4.2</span> Making distribution plots of simulated datasets</h3>
<p>These functions visualize datasets (simulated or empirical) by generating individual histograms and pairplots of summary statistics of datasets, and a function to generate (and combine) these two plots for any given dataset simulated by <code>do_sim_parallel</code> in the pipeline (see <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Individual histograms</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Pairplots of summary statistics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Profile plots of simulated datasets</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>The function <code>plot_histograms</code> makes person histograms of the individuals in a dataset (stored as dataframes) and arranges them based on individual means.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-20_13212be408c63689f25cb72885f9a6b2">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>plot_histograms <span class="ot">&lt;-</span> <span class="cf">function</span>(d,</span>
<span id="cb16-2"><a href="#cb16-2"></a>                            <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>                            <span class="at">nrow.facet =</span> <span class="dv">20</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>                            <span class="at">p.colors =</span> <span class="fu">c</span>(<span class="st">"#FE9929"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>                                         <span class="st">"#CC4C02"</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>                                         <span class="st">"#662506"</span>)) {</span>
<span id="cb16-7"><a href="#cb16-7"></a>  fill_col <span class="ot">&lt;-</span> p.colors[<span class="dv">2</span>]</span>
<span id="cb16-8"><a href="#cb16-8"></a>  x.range <span class="ot">&lt;-</span> d<span class="sc">$</span>x <span class="sc">%&gt;%</span> <span class="fu">range</span>()</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="fu">mutate</span>(<span class="at">mm =</span> <span class="fu">mean</span>(x)) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(mm)) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb16-15"><a href="#cb16-15"></a>               <span class="at">y =</span> ..ndensity..)) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> binwidth,</span>
<span id="cb16-17"><a href="#cb16-17"></a>                   <span class="at">fill =</span> fill_col,</span>
<span id="cb16-18"><a href="#cb16-18"></a>                   <span class="at">center =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">reorder</span>(subject, mm),</span>
<span id="cb16-20"><a href="#cb16-20"></a>               <span class="at">nrow =</span> nrow.facet) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb16-22"><a href="#cb16-22"></a>               <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="fu">ggtitle</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>    <span class="fu">theme</span>(</span>
<span id="cb16-26"><a href="#cb16-26"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-27"><a href="#cb16-27"></a>      <span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb16-28"><a href="#cb16-28"></a>      <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-29"><a href="#cb16-29"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-30"><a href="#cb16-30"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-31"><a href="#cb16-31"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-32"><a href="#cb16-32"></a>    )</span>
<span id="cb16-33"><a href="#cb16-33"></a></span>
<span id="cb16-34"><a href="#cb16-34"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>The function <code>plot_pairplots</code> calculates the mean, variance, and skewness of each individual in a dataset (stored as dataframes) and generates pairplots of their joint distribution.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-21_209cd40fa3d015e755c69b45a277358a">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>plot_pairplots <span class="ot">&lt;-</span> <span class="cf">function</span>(d,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                           <span class="at">p.colors =</span> <span class="fu">c</span>(<span class="st">"#FE9929"</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>                                        <span class="st">"#CC4C02"</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                                        <span class="st">"#662506"</span>),</span>
<span id="cb17-5"><a href="#cb17-5"></a>                           <span class="at">rel_title =</span> <span class="dv">2</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>                           <span class="at">rel_lines =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-7"><a href="#cb17-7"></a>                           <span class="at">rel_dots =</span> <span class="dv">3</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                           <span class="at">bins =</span> <span class="dv">30</span>) {</span>
<span id="cb17-9"><a href="#cb17-9"></a>  color_hist <span class="ot">&lt;-</span> p.colors[<span class="dv">2</span>]</span>
<span id="cb17-10"><a href="#cb17-10"></a>  color_scatter <span class="ot">&lt;-</span> p.colors[<span class="dv">1</span>]</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="fu">summarise</span>(</span>
<span id="cb17-15"><a href="#cb17-15"></a>      <span class="at">Mean =</span> <span class="fu">mean</span>(x,</span>
<span id="cb17-16"><a href="#cb17-16"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-17"><a href="#cb17-17"></a>      <span class="at">Variance =</span> <span class="fu">var</span>(x,</span>
<span id="cb17-18"><a href="#cb17-18"></a>                     <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-19"><a href="#cb17-19"></a>      <span class="at">Skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x,</span>
<span id="cb17-20"><a href="#cb17-20"></a>                                   <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-21"><a href="#cb17-21"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb17-23"><a href="#cb17-23"></a></span>
<span id="cb17-24"><a href="#cb17-24"></a>  cors <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb17-25"><a href="#cb17-25"></a>    <span class="fu">select</span>(Mean, Variance, Skewness) <span class="sc">%&gt;%</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>    correlation<span class="sc">::</span><span class="fu">correlation</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-28"><a href="#cb17-28"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-29"><a href="#cb17-29"></a>      <span class="at">value =</span> <span class="fu">round</span>(r, <span class="dv">3</span>),</span>
<span id="cb17-30"><a href="#cb17-30"></a>      <span class="at">significance =</span> <span class="fu">cut</span>(</span>
<span id="cb17-31"><a href="#cb17-31"></a>        p,</span>
<span id="cb17-32"><a href="#cb17-32"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb17-33"><a href="#cb17-33"></a>        <span class="at">include.lowest =</span> T,</span>
<span id="cb17-34"><a href="#cb17-34"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'***'</span>, <span class="st">'**'</span>, <span class="st">'*'</span>, <span class="st">''</span>)</span>
<span id="cb17-35"><a href="#cb17-35"></a>      ),</span>
<span id="cb17-36"><a href="#cb17-36"></a>      <span class="at">string =</span> <span class="fu">paste0</span>(value, significance)</span>
<span id="cb17-37"><a href="#cb17-37"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb17-38"><a href="#cb17-38"></a>    <span class="fu">select</span>(<span class="sc">-</span>r<span class="sc">:-</span>n_Obs)</span>
<span id="cb17-39"><a href="#cb17-39"></a></span>
<span id="cb17-40"><a href="#cb17-40"></a>  margin.thing <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb17-41"><a href="#cb17-41"></a></span>
<span id="cb17-42"><a href="#cb17-42"></a>  <span class="do">##  Correlations</span></span>
<span id="cb17-43"><a href="#cb17-43"></a></span>
<span id="cb17-44"><a href="#cb17-44"></a>  p_cor_Mean.Variance <span class="ot">&lt;-</span></span>
<span id="cb17-45"><a href="#cb17-45"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-46"><a href="#cb17-46"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb17-47"><a href="#cb17-47"></a>      <span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Variance)),</span>
<span id="cb17-48"><a href="#cb17-48"></a>      <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Mean)),</span>
<span id="cb17-49"><a href="#cb17-49"></a>      <span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb17-50"><a href="#cb17-50"></a>        <span class="st">"Corr:"</span>,</span>
<span id="cb17-51"><a href="#cb17-51"></a>        cors <span class="sc">%&gt;%</span></span>
<span id="cb17-52"><a href="#cb17-52"></a>          <span class="fu">filter</span>(Parameter1 <span class="sc">==</span> <span class="st">"Mean"</span>,</span>
<span id="cb17-53"><a href="#cb17-53"></a>                 Parameter2 <span class="sc">==</span> <span class="st">"Variance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-54"><a href="#cb17-54"></a>          <span class="fu">pull</span>(string)</span>
<span id="cb17-55"><a href="#cb17-55"></a>      )</span>
<span id="cb17-56"><a href="#cb17-56"></a>    )) <span class="sc">+</span></span>
<span id="cb17-57"><a href="#cb17-57"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-58"><a href="#cb17-58"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-59"><a href="#cb17-59"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(rel_title)),</span>
<span id="cb17-60"><a href="#cb17-60"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-61"><a href="#cb17-61"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-62"><a href="#cb17-62"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-63"><a href="#cb17-63"></a>    )</span>
<span id="cb17-64"><a href="#cb17-64"></a></span>
<span id="cb17-65"><a href="#cb17-65"></a>  p_cor_Mean.Skewness <span class="ot">&lt;-</span></span>
<span id="cb17-66"><a href="#cb17-66"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-67"><a href="#cb17-67"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb17-68"><a href="#cb17-68"></a>      <span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Skewness)),</span>
<span id="cb17-69"><a href="#cb17-69"></a>      <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Mean)),</span>
<span id="cb17-70"><a href="#cb17-70"></a>      <span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb17-71"><a href="#cb17-71"></a>        <span class="st">"Corr:"</span>,</span>
<span id="cb17-72"><a href="#cb17-72"></a>        cors <span class="sc">%&gt;%</span></span>
<span id="cb17-73"><a href="#cb17-73"></a>          <span class="fu">filter</span>(Parameter1 <span class="sc">==</span> <span class="st">"Mean"</span>,</span>
<span id="cb17-74"><a href="#cb17-74"></a>                 Parameter2 <span class="sc">==</span> <span class="st">"Skewness"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-75"><a href="#cb17-75"></a>          <span class="fu">pull</span>(string)</span>
<span id="cb17-76"><a href="#cb17-76"></a>      )</span>
<span id="cb17-77"><a href="#cb17-77"></a>    )) <span class="sc">+</span></span>
<span id="cb17-78"><a href="#cb17-78"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-79"><a href="#cb17-79"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-80"><a href="#cb17-80"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(rel_title)),</span>
<span id="cb17-81"><a href="#cb17-81"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-82"><a href="#cb17-82"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-83"><a href="#cb17-83"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-84"><a href="#cb17-84"></a>    )</span>
<span id="cb17-85"><a href="#cb17-85"></a></span>
<span id="cb17-86"><a href="#cb17-86"></a>  p_cor_Variance.Skewness <span class="ot">&lt;-</span></span>
<span id="cb17-87"><a href="#cb17-87"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-88"><a href="#cb17-88"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb17-89"><a href="#cb17-89"></a>      <span class="at">x =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Skewness)),</span>
<span id="cb17-90"><a href="#cb17-90"></a>      <span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">range</span>(d<span class="sc">$</span>Variance)),</span>
<span id="cb17-91"><a href="#cb17-91"></a>      <span class="at">label =</span> <span class="fu">paste</span>(</span>
<span id="cb17-92"><a href="#cb17-92"></a>        <span class="st">"Corr:"</span>,</span>
<span id="cb17-93"><a href="#cb17-93"></a>        cors <span class="sc">%&gt;%</span></span>
<span id="cb17-94"><a href="#cb17-94"></a>          <span class="fu">filter</span>(Parameter1 <span class="sc">==</span> <span class="st">"Variance"</span>,</span>
<span id="cb17-95"><a href="#cb17-95"></a>                 Parameter2 <span class="sc">==</span> <span class="st">"Skewness"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-96"><a href="#cb17-96"></a>          <span class="fu">pull</span>(string)</span>
<span id="cb17-97"><a href="#cb17-97"></a>      )</span>
<span id="cb17-98"><a href="#cb17-98"></a>    )) <span class="sc">+</span></span>
<span id="cb17-99"><a href="#cb17-99"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-100"><a href="#cb17-100"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-101"><a href="#cb17-101"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(rel_title)),</span>
<span id="cb17-102"><a href="#cb17-102"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-103"><a href="#cb17-103"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-104"><a href="#cb17-104"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-105"><a href="#cb17-105"></a>    )</span>
<span id="cb17-106"><a href="#cb17-106"></a></span>
<span id="cb17-107"><a href="#cb17-107"></a>  <span class="do">## Histograms</span></span>
<span id="cb17-108"><a href="#cb17-108"></a></span>
<span id="cb17-109"><a href="#cb17-109"></a>  p_mean <span class="ot">&lt;-</span></span>
<span id="cb17-110"><a href="#cb17-110"></a>    d <span class="sc">%&gt;%</span></span>
<span id="cb17-111"><a href="#cb17-111"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Mean)) <span class="sc">+</span></span>
<span id="cb17-112"><a href="#cb17-112"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> color_hist,</span>
<span id="cb17-113"><a href="#cb17-113"></a>                   <span class="at">bins =</span> bins) <span class="sc">+</span></span>
<span id="cb17-114"><a href="#cb17-114"></a>    <span class="fu">ggtitle</span>(<span class="st">"Mean"</span>) <span class="sc">+</span></span>
<span id="cb17-115"><a href="#cb17-115"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-116"><a href="#cb17-116"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-117"><a href="#cb17-117"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb17-118"><a href="#cb17-118"></a>        <span class="at">size =</span> <span class="fu">rel</span>(rel_title),</span>
<span id="cb17-119"><a href="#cb17-119"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-120"><a href="#cb17-120"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> margin.thing,</span>
<span id="cb17-121"><a href="#cb17-121"></a>                        <span class="at">b =</span> <span class="sc">-</span>margin.thing)</span>
<span id="cb17-122"><a href="#cb17-122"></a>      ),</span>
<span id="cb17-123"><a href="#cb17-123"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-124"><a href="#cb17-124"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-125"><a href="#cb17-125"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-126"><a href="#cb17-126"></a>    )</span>
<span id="cb17-127"><a href="#cb17-127"></a></span>
<span id="cb17-128"><a href="#cb17-128"></a>  p_variance <span class="ot">&lt;-</span></span>
<span id="cb17-129"><a href="#cb17-129"></a>    d <span class="sc">%&gt;%</span></span>
<span id="cb17-130"><a href="#cb17-130"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Variance)) <span class="sc">+</span></span>
<span id="cb17-131"><a href="#cb17-131"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> color_hist,</span>
<span id="cb17-132"><a href="#cb17-132"></a>                   <span class="at">bins =</span> bins) <span class="sc">+</span></span>
<span id="cb17-133"><a href="#cb17-133"></a>    <span class="fu">ggtitle</span>(<span class="st">"Variance"</span>) <span class="sc">+</span></span>
<span id="cb17-134"><a href="#cb17-134"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-135"><a href="#cb17-135"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-136"><a href="#cb17-136"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb17-137"><a href="#cb17-137"></a>        <span class="at">size =</span> <span class="fu">rel</span>(rel_title),</span>
<span id="cb17-138"><a href="#cb17-138"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-139"><a href="#cb17-139"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> margin.thing,</span>
<span id="cb17-140"><a href="#cb17-140"></a>                        <span class="at">b =</span> <span class="sc">-</span>margin.thing)</span>
<span id="cb17-141"><a href="#cb17-141"></a>      ),</span>
<span id="cb17-142"><a href="#cb17-142"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-143"><a href="#cb17-143"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-144"><a href="#cb17-144"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-145"><a href="#cb17-145"></a>    )</span>
<span id="cb17-146"><a href="#cb17-146"></a></span>
<span id="cb17-147"><a href="#cb17-147"></a>  p_skewness <span class="ot">&lt;-</span></span>
<span id="cb17-148"><a href="#cb17-148"></a>    d <span class="sc">%&gt;%</span></span>
<span id="cb17-149"><a href="#cb17-149"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Skewness)) <span class="sc">+</span></span>
<span id="cb17-150"><a href="#cb17-150"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> color_hist,</span>
<span id="cb17-151"><a href="#cb17-151"></a>                   <span class="at">bins =</span> bins) <span class="sc">+</span></span>
<span id="cb17-152"><a href="#cb17-152"></a>    <span class="fu">ggtitle</span>(<span class="st">"Skewness"</span>) <span class="sc">+</span></span>
<span id="cb17-153"><a href="#cb17-153"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb17-154"><a href="#cb17-154"></a>      <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb17-155"><a href="#cb17-155"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-156"><a href="#cb17-156"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-157"><a href="#cb17-157"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb17-158"><a href="#cb17-158"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-159"><a href="#cb17-159"></a>    ) <span class="sc">+</span></span>
<span id="cb17-160"><a href="#cb17-160"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb17-161"><a href="#cb17-161"></a>      <span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb17-162"><a href="#cb17-162"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-163"><a href="#cb17-163"></a>      <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb17-164"><a href="#cb17-164"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-165"><a href="#cb17-165"></a>    ) <span class="sc">+</span></span>
<span id="cb17-166"><a href="#cb17-166"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb17-167"><a href="#cb17-167"></a>      <span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb17-168"><a href="#cb17-168"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-169"><a href="#cb17-169"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb17-170"><a href="#cb17-170"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-171"><a href="#cb17-171"></a>    ) <span class="sc">+</span></span>
<span id="cb17-172"><a href="#cb17-172"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-173"><a href="#cb17-173"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-174"><a href="#cb17-174"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb17-175"><a href="#cb17-175"></a>        <span class="at">size =</span> <span class="fu">rel</span>(rel_title),</span>
<span id="cb17-176"><a href="#cb17-176"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-177"><a href="#cb17-177"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> margin.thing,</span>
<span id="cb17-178"><a href="#cb17-178"></a>                        <span class="at">b =</span> <span class="sc">-</span>margin.thing)</span>
<span id="cb17-179"><a href="#cb17-179"></a>      ),</span>
<span id="cb17-180"><a href="#cb17-180"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-181"><a href="#cb17-181"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-182"><a href="#cb17-182"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-183"><a href="#cb17-183"></a>    )</span>
<span id="cb17-184"><a href="#cb17-184"></a></span>
<span id="cb17-185"><a href="#cb17-185"></a>  <span class="do">## scatter plots</span></span>
<span id="cb17-186"><a href="#cb17-186"></a></span>
<span id="cb17-187"><a href="#cb17-187"></a>  p_scatter_Mean.Variance <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb17-188"><a href="#cb17-188"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Mean,</span>
<span id="cb17-189"><a href="#cb17-189"></a>               <span class="at">y =</span> Variance)) <span class="sc">+</span></span>
<span id="cb17-190"><a href="#cb17-190"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb17-191"><a href="#cb17-191"></a>      <span class="at">color =</span> color_scatter,</span>
<span id="cb17-192"><a href="#cb17-192"></a>      <span class="at">shape =</span> <span class="st">"bullet"</span>,</span>
<span id="cb17-193"><a href="#cb17-193"></a>      <span class="at">alpha =</span> <span class="fl">0.85</span>,</span>
<span id="cb17-194"><a href="#cb17-194"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_dots)</span>
<span id="cb17-195"><a href="#cb17-195"></a>    ) <span class="sc">+</span></span>
<span id="cb17-196"><a href="#cb17-196"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-197"><a href="#cb17-197"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-198"><a href="#cb17-198"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-199"><a href="#cb17-199"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-200"><a href="#cb17-200"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-201"><a href="#cb17-201"></a>    )</span>
<span id="cb17-202"><a href="#cb17-202"></a></span>
<span id="cb17-203"><a href="#cb17-203"></a></span>
<span id="cb17-204"><a href="#cb17-204"></a></span>
<span id="cb17-205"><a href="#cb17-205"></a>  p_scatter_Mean.Skewness <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb17-206"><a href="#cb17-206"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Mean,</span>
<span id="cb17-207"><a href="#cb17-207"></a>               <span class="at">y =</span> Skewness)) <span class="sc">+</span></span>
<span id="cb17-208"><a href="#cb17-208"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-209"><a href="#cb17-209"></a>      <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb17-210"><a href="#cb17-210"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-211"><a href="#cb17-211"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-212"><a href="#cb17-212"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb17-213"><a href="#cb17-213"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-214"><a href="#cb17-214"></a>    ) <span class="sc">+</span></span>
<span id="cb17-215"><a href="#cb17-215"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-216"><a href="#cb17-216"></a>      <span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb17-217"><a href="#cb17-217"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-218"><a href="#cb17-218"></a>      <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb17-219"><a href="#cb17-219"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-220"><a href="#cb17-220"></a>    ) <span class="sc">+</span></span>
<span id="cb17-221"><a href="#cb17-221"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-222"><a href="#cb17-222"></a>      <span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb17-223"><a href="#cb17-223"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-224"><a href="#cb17-224"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb17-225"><a href="#cb17-225"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-226"><a href="#cb17-226"></a>    ) <span class="sc">+</span></span>
<span id="cb17-227"><a href="#cb17-227"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb17-228"><a href="#cb17-228"></a>      <span class="at">color =</span> color_scatter,</span>
<span id="cb17-229"><a href="#cb17-229"></a>      <span class="at">shape =</span> <span class="st">"bullet"</span>,</span>
<span id="cb17-230"><a href="#cb17-230"></a>      <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb17-231"><a href="#cb17-231"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_dots)</span>
<span id="cb17-232"><a href="#cb17-232"></a>    ) <span class="sc">+</span></span>
<span id="cb17-233"><a href="#cb17-233"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-234"><a href="#cb17-234"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb17-235"><a href="#cb17-235"></a></span>
<span id="cb17-236"><a href="#cb17-236"></a></span>
<span id="cb17-237"><a href="#cb17-237"></a></span>
<span id="cb17-238"><a href="#cb17-238"></a>  p_scatter_Variance.Skewness <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb17-239"><a href="#cb17-239"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Variance,</span>
<span id="cb17-240"><a href="#cb17-240"></a>               <span class="at">y =</span> Skewness)) <span class="sc">+</span></span>
<span id="cb17-241"><a href="#cb17-241"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-242"><a href="#cb17-242"></a>      <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb17-243"><a href="#cb17-243"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-244"><a href="#cb17-244"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-245"><a href="#cb17-245"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb17-246"><a href="#cb17-246"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-247"><a href="#cb17-247"></a>    ) <span class="sc">+</span></span>
<span id="cb17-248"><a href="#cb17-248"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-249"><a href="#cb17-249"></a>      <span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb17-250"><a href="#cb17-250"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-251"><a href="#cb17-251"></a>      <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb17-252"><a href="#cb17-252"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-253"><a href="#cb17-253"></a>    ) <span class="sc">+</span></span>
<span id="cb17-254"><a href="#cb17-254"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb17-255"><a href="#cb17-255"></a>      <span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb17-256"><a href="#cb17-256"></a>      <span class="at">color =</span> <span class="st">"gray45"</span>,</span>
<span id="cb17-257"><a href="#cb17-257"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb17-258"><a href="#cb17-258"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_lines)</span>
<span id="cb17-259"><a href="#cb17-259"></a>    ) <span class="sc">+</span></span>
<span id="cb17-260"><a href="#cb17-260"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb17-261"><a href="#cb17-261"></a>      <span class="at">color =</span> color_scatter,</span>
<span id="cb17-262"><a href="#cb17-262"></a>      <span class="at">shape =</span> <span class="st">"bullet"</span>,</span>
<span id="cb17-263"><a href="#cb17-263"></a>      <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb17-264"><a href="#cb17-264"></a>      <span class="at">size =</span> <span class="fu">rel</span>(rel_dots)</span>
<span id="cb17-265"><a href="#cb17-265"></a>    ) <span class="sc">+</span></span>
<span id="cb17-266"><a href="#cb17-266"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb17-267"><a href="#cb17-267"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-268"><a href="#cb17-268"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-269"><a href="#cb17-269"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-270"><a href="#cb17-270"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb17-271"><a href="#cb17-271"></a>    )</span>
<span id="cb17-272"><a href="#cb17-272"></a></span>
<span id="cb17-273"><a href="#cb17-273"></a>  <span class="do">## Putting plots together</span></span>
<span id="cb17-274"><a href="#cb17-274"></a></span>
<span id="cb17-275"><a href="#cb17-275"></a>  p_pairplots <span class="ot">&lt;-</span></span>
<span id="cb17-276"><a href="#cb17-276"></a>    (p_mean <span class="sc">+</span> p_cor_Mean.Variance <span class="sc">+</span> p_cor_Mean.Skewness) <span class="sc">/</span></span>
<span id="cb17-277"><a href="#cb17-277"></a>    (p_scatter_Mean.Variance <span class="sc">+</span> p_variance <span class="sc">+</span> p_cor_Variance.Skewness) <span class="sc">/</span></span>
<span id="cb17-278"><a href="#cb17-278"></a>    (p_scatter_Mean.Skewness <span class="sc">+</span> p_scatter_Variance.Skewness <span class="sc">+</span> p_skewness) <span class="sc">&amp;</span></span>
<span id="cb17-279"><a href="#cb17-279"></a>    <span class="co"># plot_layout(guides = "collect") &amp;</span></span>
<span id="cb17-280"><a href="#cb17-280"></a>    <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb17-281"><a href="#cb17-281"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb17-282"><a href="#cb17-282"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(rel_title) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb17-283"><a href="#cb17-283"></a>    ))</span>
<span id="cb17-284"><a href="#cb17-284"></a></span>
<span id="cb17-285"><a href="#cb17-285"></a>  <span class="do">## Returning the 3x3 pairplots</span></span>
<span id="cb17-286"><a href="#cb17-286"></a>  p_pairplots</span>
<span id="cb17-287"><a href="#cb17-287"></a></span>
<span id="cb17-288"><a href="#cb17-288"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>The function <code>plot_dataset.profile</code> gets a simulated object (generated by <code>do_sim_parallel</code>) and combines individual histograms and pairplots in a single figure.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-22_427d6afe7643496a093da49facd1d325">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>plot_dataset.profile <span class="ot">&lt;-</span> <span class="cf">function</span>(sim.object,</span>
<span id="cb18-2"><a href="#cb18-2"></a>                                 <span class="at">p.colors =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-3"><a href="#cb18-3"></a>                                 <span class="at">title_l2.dist =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb18-4"><a href="#cb18-4"></a>  d_sim <span class="ot">&lt;-</span> sim.object<span class="sc">$</span>sim.Dataset</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>  l2.distr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sim.object<span class="sc">$</span>l2.dist <span class="sc">==</span> <span class="st">"Chi2"</span>,</span>
<span id="cb18-7"><a href="#cb18-7"></a>                     <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$"</span>,</span>
<span id="cb18-8"><a href="#cb18-8"></a>                     <span class="st">"Gaussian"</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>  model <span class="ot">&lt;-</span> sim.object<span class="sc">$</span>Model</span>
<span id="cb18-10"><a href="#cb18-10"></a>  title <span class="ot">&lt;-</span> model</span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a>  binwidth <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"NAR"</span>) {</span>
<span id="cb18-14"><a href="#cb18-14"></a>    title <span class="ot">&lt;-</span> <span class="st">"AR"</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>    palette_color <span class="ot">&lt;-</span> palette_nar</span>
<span id="cb18-16"><a href="#cb18-16"></a>  }</span>
<span id="cb18-17"><a href="#cb18-17"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"Chi2AR"</span>) {</span>
<span id="cb18-18"><a href="#cb18-18"></a>    title <span class="ot">&lt;-</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$AR"</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>    palette_color <span class="ot">&lt;-</span> palette_chiar</span>
<span id="cb18-20"><a href="#cb18-20"></a>  }</span>
<span id="cb18-21"><a href="#cb18-21"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"BinAR"</span>)</span>
<span id="cb18-22"><a href="#cb18-22"></a>    palette_color <span class="ot">&lt;-</span> palette_binar</span>
<span id="cb18-23"><a href="#cb18-23"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"PoDAR"</span>)</span>
<span id="cb18-24"><a href="#cb18-24"></a>    palette_color <span class="ot">&lt;-</span> palette_podar</span>
<span id="cb18-25"><a href="#cb18-25"></a></span>
<span id="cb18-26"><a href="#cb18-26"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(p.colors))</span>
<span id="cb18-27"><a href="#cb18-27"></a>    p.colors <span class="ot">&lt;-</span> palette_color</span>
<span id="cb18-28"><a href="#cb18-28"></a></span>
<span id="cb18-29"><a href="#cb18-29"></a>  title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(title,</span>
<span id="cb18-30"><a href="#cb18-30"></a>                  <span class="st">"(1)"</span>,</span>
<span id="cb18-31"><a href="#cb18-31"></a>                  <span class="st">" $</span><span class="sc">\\</span><span class="st">phantom{</span><span class="sc">\\</span><span class="st">chi^2}$"</span>)</span>
<span id="cb18-32"><a href="#cb18-32"></a></span>
<span id="cb18-33"><a href="#cb18-33"></a>  <span class="cf">if</span> (title_l2.dist)</span>
<span id="cb18-34"><a href="#cb18-34"></a>    title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(l2.distr,</span>
<span id="cb18-35"><a href="#cb18-35"></a>                    <span class="st">"-distributed means"</span>,</span>
<span id="cb18-36"><a href="#cb18-36"></a>                    <span class="st">" $</span><span class="sc">\\</span><span class="st">phantom{</span><span class="sc">\\</span><span class="st">chi^2}$"</span>)</span>
<span id="cb18-37"><a href="#cb18-37"></a></span>
<span id="cb18-38"><a href="#cb18-38"></a></span>
<span id="cb18-39"><a href="#cb18-39"></a>  p_out <span class="ot">&lt;-</span>  <span class="fu">plot_histograms</span>(</span>
<span id="cb18-40"><a href="#cb18-40"></a>    <span class="at">d =</span> d_sim,</span>
<span id="cb18-41"><a href="#cb18-41"></a>    <span class="at">binwidth =</span> binwidth,</span>
<span id="cb18-42"><a href="#cb18-42"></a>    <span class="at">nrow.facet =</span> <span class="dv">10</span>,</span>
<span id="cb18-43"><a href="#cb18-43"></a>    <span class="at">p.colors =</span> p.colors</span>
<span id="cb18-44"><a href="#cb18-44"></a>  ) <span class="sc">+</span></span>
<span id="cb18-45"><a href="#cb18-45"></a>    <span class="fu">plot_spacer</span>() <span class="sc">+</span></span>
<span id="cb18-46"><a href="#cb18-46"></a>    <span class="fu">plot_pairplots</span>(<span class="at">d =</span> d_sim,</span>
<span id="cb18-47"><a href="#cb18-47"></a>                   <span class="at">p.colors =</span> p.colors) <span class="sc">+</span></span>
<span id="cb18-48"><a href="#cb18-48"></a>    <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.05</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb18-49"><a href="#cb18-49"></a>    <span class="fu">plot_annotation</span>(</span>
<span id="cb18-50"><a href="#cb18-50"></a>      <span class="at">title =</span> <span class="fu">TeX</span>(title),</span>
<span id="cb18-51"><a href="#cb18-51"></a>      <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb18-52"><a href="#cb18-52"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">2.5</span>),</span>
<span id="cb18-53"><a href="#cb18-53"></a>                                  <span class="at">family =</span> <span class="st">"CMU Serif"</span>),</span>
<span id="cb18-54"><a href="#cb18-54"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_blank</span>()</span>
<span id="cb18-55"><a href="#cb18-55"></a>      )</span>
<span id="cb18-56"><a href="#cb18-56"></a>    )</span>
<span id="cb18-57"><a href="#cb18-57"></a></span>
<span id="cb18-58"><a href="#cb18-58"></a>  p_out <span class="sc">%&gt;%</span> <span class="fu">wrap_elements</span>()</span>
<span id="cb18-59"><a href="#cb18-59"></a></span>
<span id="cb18-60"><a href="#cb18-60"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We also write the function <code>save_dataset_profile</code> to put together two dataset profile plots to get to plots similar to those in Figures S1, S2, S4, and S5 in the Supplemental Materials, and save the final figure as a PDF file.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-23_e688c6864f250ccff9f753a8a2a7ec63">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>save_dataset_profile <span class="ot">&lt;-</span> <span class="cf">function</span>(upper,</span>
<span id="cb19-2"><a href="#cb19-2"></a>                                 lower,</span>
<span id="cb19-3"><a href="#cb19-3"></a>                                 <span class="at">file.name =</span> <span class="st">"Dataset profile"</span>,</span>
<span id="cb19-4"><a href="#cb19-4"></a>                                 <span class="at">path =</span> <span class="st">"figures"</span>,</span>
<span id="cb19-5"><a href="#cb19-5"></a>                                 <span class="at">title =</span> <span class="cn">NULL</span>) {</span>
<span id="cb19-6"><a href="#cb19-6"></a>  p_profiles <span class="ot">&lt;-</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>    (</span>
<span id="cb19-8"><a href="#cb19-8"></a>      <span class="fu">plot_dataset.profile</span>(upper, <span class="at">title_l2.dist =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>        <span class="fu">plot_spacer</span>() <span class="sc">/</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>        <span class="fu">plot_dataset.profile</span>(lower, <span class="at">title_l2.dist =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a>    ) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.02</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>    <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb19-14"><a href="#cb19-14"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb19-15"><a href="#cb19-15"></a>        <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">4</span>),</span>
<span id="cb19-16"><a href="#cb19-16"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-17"><a href="#cb19-17"></a>        <span class="at">family =</span> <span class="st">"CMU Serif"</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>      ),</span>
<span id="cb19-19"><a href="#cb19-19"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_blank</span>()</span>
<span id="cb19-20"><a href="#cb19-20"></a>    ))</span>
<span id="cb19-21"><a href="#cb19-21"></a></span>
<span id="cb19-22"><a href="#cb19-22"></a>  <span class="fu">ggsave</span>(</span>
<span id="cb19-23"><a href="#cb19-23"></a>    <span class="fu">paste0</span>(file.name,</span>
<span id="cb19-24"><a href="#cb19-24"></a>           <span class="st">".pdf"</span>),</span>
<span id="cb19-25"><a href="#cb19-25"></a>    p_profiles,</span>
<span id="cb19-26"><a href="#cb19-26"></a>    <span class="at">path =</span> path,</span>
<span id="cb19-27"><a href="#cb19-27"></a>    <span class="at">width =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">15</span>,</span>
<span id="cb19-28"><a href="#cb19-28"></a>    <span class="at">height =</span> <span class="fl">2.02</span> <span class="sc">*</span> <span class="fl">1.1</span> <span class="sc">*</span> <span class="dv">15</span>,</span>
<span id="cb19-29"><a href="#cb19-29"></a>    <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb19-30"><a href="#cb19-30"></a>  )</span>
<span id="cb19-31"><a href="#cb19-31"></a></span>
<span id="cb19-32"><a href="#cb19-32"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-report-estimation-plots" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="sec-report-estimation-plots"><span class="header-section-number">1.4.3</span> Making plots of estimation results</h3>
<p>The functions here make the main figures of the paper, which include aspects of model fit (e.g., estimation bias and RMSE, and Type-I error rates, etc.).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Plots for a given level-2 distribution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Combined plots of results</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>The function <code>plot_Model.x.Resid</code> makes a figure with two columns (for the models with fixed or random residual variance), that show the outcomes of a fit measure (e.g., bias) for all the four DGMs with a given level-2 distribution of means for different <span class="math inline">\(N\)</span>s and <span class="math inline">\(T\)</span>s.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-24_00f1013f336d69b1978d5e4c925de270">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>plot_Model.x.Resid <span class="ot">&lt;-</span> <span class="cf">function</span>(d_important,</span>
<span id="cb20-2"><a href="#cb20-2"></a>                               which.parameter,</span>
<span id="cb20-3"><a href="#cb20-3"></a>                               <span class="at">which.measure =</span> <span class="st">"Positive error"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>                               <span class="at">Means.dist =</span> <span class="fu">c</span>(<span class="st">"Gaussian"</span>, <span class="st">"Chi2"</span>),</span>
<span id="cb20-5"><a href="#cb20-5"></a>                               <span class="at">line.width =</span> <span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>                               <span class="at">font.scale =</span> <span class="dv">5</span>) {</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a>  ddd <span class="ot">&lt;-</span> d_important <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="fu">filter</span>(parameter <span class="sc">==</span> which.parameter)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"error"</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>             <span class="fu">tolower</span>(which.measure),</span>
<span id="cb20-14"><a href="#cb20-14"></a>             <span class="at">fixed =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb20-15"><a href="#cb20-15"></a>    ddd<span class="sc">$</span>value <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(which.measure)</span>
<span id="cb20-16"><a href="#cb20-16"></a>    ddd <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sign.X.sig <span class="sc">==</span> <span class="st">"Zero"</span>)</span>
<span id="cb20-17"><a href="#cb20-17"></a>    y.axis <span class="ot">&lt;-</span> which.measure</span>
<span id="cb20-18"><a href="#cb20-18"></a>  }</span>
<span id="cb20-19"><a href="#cb20-19"></a></span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"positive"</span>,</span>
<span id="cb20-22"><a href="#cb20-22"></a>            <span class="fu">tolower</span>(which.measure),</span>
<span id="cb20-23"><a href="#cb20-23"></a>            <span class="at">fixed =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb20-24"><a href="#cb20-24"></a>    which.measure <span class="ot">&lt;-</span> <span class="st">"Type-1 error"</span></span>
<span id="cb20-25"><a href="#cb20-25"></a>    ddd<span class="sc">$</span>value <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(which.measure)</span>
<span id="cb20-26"><a href="#cb20-26"></a>    ddd <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sign.X.sig <span class="sc">==</span> <span class="st">"Positive"</span>)</span>
<span id="cb20-27"><a href="#cb20-27"></a>    y.axis <span class="ot">&lt;-</span> <span class="st">"Positive error"</span></span>
<span id="cb20-28"><a href="#cb20-28"></a>  }</span>
<span id="cb20-29"><a href="#cb20-29"></a></span>
<span id="cb20-30"><a href="#cb20-30"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"negative"</span>,</span>
<span id="cb20-31"><a href="#cb20-31"></a>            <span class="fu">tolower</span>(which.measure),</span>
<span id="cb20-32"><a href="#cb20-32"></a>            <span class="at">fixed =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb20-33"><a href="#cb20-33"></a>    which.measure <span class="ot">&lt;-</span> <span class="st">"Type-1 error"</span></span>
<span id="cb20-34"><a href="#cb20-34"></a>    ddd<span class="sc">$</span>value <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(which.measure)</span>
<span id="cb20-35"><a href="#cb20-35"></a>    ddd <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sign.X.sig <span class="sc">==</span> <span class="st">"Negative"</span>)</span>
<span id="cb20-36"><a href="#cb20-36"></a>    y.axis <span class="ot">&lt;-</span> <span class="st">"Negative error"</span></span>
<span id="cb20-37"><a href="#cb20-37"></a>  }</span>
<span id="cb20-38"><a href="#cb20-38"></a></span>
<span id="cb20-39"><a href="#cb20-39"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"total"</span>,</span>
<span id="cb20-40"><a href="#cb20-40"></a>            <span class="fu">tolower</span>(which.measure),</span>
<span id="cb20-41"><a href="#cb20-41"></a>            <span class="at">fixed =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb20-42"><a href="#cb20-42"></a>    which.measure <span class="ot">&lt;-</span> <span class="st">"Type-1 error"</span></span>
<span id="cb20-43"><a href="#cb20-43"></a>    ddd<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> (ddd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(which.measure))</span>
<span id="cb20-44"><a href="#cb20-44"></a>    ddd <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sign.X.sig <span class="sc">==</span> <span class="st">"Zero"</span>)</span>
<span id="cb20-45"><a href="#cb20-45"></a>    y.axis <span class="ot">&lt;-</span> <span class="st">"Total error"</span></span>
<span id="cb20-46"><a href="#cb20-46"></a>  }</span>
<span id="cb20-47"><a href="#cb20-47"></a></span>
<span id="cb20-48"><a href="#cb20-48"></a></span>
<span id="cb20-49"><a href="#cb20-49"></a>  y.range <span class="ot">&lt;-</span> ddd<span class="sc">$</span>value <span class="sc">%&gt;%</span> <span class="fu">range</span>()</span>
<span id="cb20-50"><a href="#cb20-50"></a>  y.range[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="sc">-</span><span class="fl">0.001</span>, y.range[<span class="dv">1</span>])</span>
<span id="cb20-51"><a href="#cb20-51"></a>  y.range[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fl">0.001</span>, y.range[<span class="dv">2</span>])</span>
<span id="cb20-52"><a href="#cb20-52"></a></span>
<span id="cb20-53"><a href="#cb20-53"></a>  <span class="do">## Making sure the zero values in errors are not missing</span></span>
<span id="cb20-54"><a href="#cb20-54"></a>  ddd <span class="ot">&lt;-</span> ddd  <span class="sc">%&gt;%</span></span>
<span id="cb20-55"><a href="#cb20-55"></a>    <span class="fu">filter</span>(l2.dist <span class="sc">==</span> Means.dist) <span class="sc">%&gt;%</span></span>
<span id="cb20-56"><a href="#cb20-56"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-57"><a href="#cb20-57"></a>    <span class="fu">complete</span>(Resid, <span class="st">`</span><span class="at">Model name</span><span class="st">`</span>, N, T,</span>
<span id="cb20-58"><a href="#cb20-58"></a>             <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>))</span>
<span id="cb20-59"><a href="#cb20-59"></a></span>
<span id="cb20-60"><a href="#cb20-60"></a>  ddd<span class="sc">$</span>N <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ddd<span class="sc">$</span>N)</span>
<span id="cb20-61"><a href="#cb20-61"></a>  ddd<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ddd<span class="sc">$</span>T)</span>
<span id="cb20-62"><a href="#cb20-62"></a></span>
<span id="cb20-63"><a href="#cb20-63"></a></span>
<span id="cb20-64"><a href="#cb20-64"></a>  title <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb20-65"><a href="#cb20-65"></a>    Means.dist <span class="sc">==</span> <span class="st">"Gaussian"</span>,</span>
<span id="cb20-66"><a href="#cb20-66"></a>    <span class="fu">TeX</span>(<span class="st">"Gaussian-distributed means $</span><span class="sc">\\</span><span class="st">phantom{</span><span class="sc">\\</span><span class="st">chi^2}$"</span>),</span>
<span id="cb20-67"><a href="#cb20-67"></a>    <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$-distributed means"</span>)</span>
<span id="cb20-68"><a href="#cb20-68"></a>  )</span>
<span id="cb20-69"><a href="#cb20-69"></a></span>
<span id="cb20-70"><a href="#cb20-70"></a>  output.plot <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span></span>
<span id="cb20-71"><a href="#cb20-71"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-72"><a href="#cb20-72"></a>    <span class="fu">aes</span>(</span>
<span id="cb20-73"><a href="#cb20-73"></a>      <span class="at">x =</span> T,</span>
<span id="cb20-74"><a href="#cb20-74"></a>      <span class="at">y =</span> value,</span>
<span id="cb20-75"><a href="#cb20-75"></a>      <span class="at">group =</span> N,</span>
<span id="cb20-76"><a href="#cb20-76"></a>      <span class="at">color =</span> N</span>
<span id="cb20-77"><a href="#cb20-77"></a>    ) <span class="sc">+</span></span>
<span id="cb20-78"><a href="#cb20-78"></a>    <span class="do">## draw solid y=0 axis line</span></span>
<span id="cb20-79"><a href="#cb20-79"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb20-80"><a href="#cb20-80"></a>      <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb20-81"><a href="#cb20-81"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb20-82"><a href="#cb20-82"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb20-83"><a href="#cb20-83"></a>      <span class="at">alpha =</span> <span class="dv">1</span></span>
<span id="cb20-84"><a href="#cb20-84"></a>    ) <span class="sc">+</span></span>
<span id="cb20-85"><a href="#cb20-85"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>),</span>
<span id="cb20-86"><a href="#cb20-86"></a>              <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb20-87"><a href="#cb20-87"></a>              <span class="at">lineend =</span> <span class="st">"round"</span>) <span class="sc">+</span></span>
<span id="cb20-88"><a href="#cb20-88"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-89"><a href="#cb20-89"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"PuRd"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>)]) <span class="sc">+</span></span>
<span id="cb20-90"><a href="#cb20-90"></a>    <span class="fu">facet_grid</span>(</span>
<span id="cb20-91"><a href="#cb20-91"></a>      <span class="at">rows =</span> <span class="fu">vars</span>(<span class="st">`</span><span class="at">Model name</span><span class="st">`</span>),</span>
<span id="cb20-92"><a href="#cb20-92"></a>      <span class="at">cols =</span> <span class="fu">vars</span>(Resid),</span>
<span id="cb20-93"><a href="#cb20-93"></a>      <span class="at">labeller =</span> label_parsed</span>
<span id="cb20-94"><a href="#cb20-94"></a>    ) <span class="sc">+</span></span>
<span id="cb20-95"><a href="#cb20-95"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-96"><a href="#cb20-96"></a>    <span class="fu">theme_pubclean</span>() <span class="sc">+</span></span>
<span id="cb20-97"><a href="#cb20-97"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> y.range) <span class="sc">+</span></span>
<span id="cb20-98"><a href="#cb20-98"></a>    <span class="fu">ylab</span>(y.axis) <span class="sc">+</span></span>
<span id="cb20-99"><a href="#cb20-99"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb20-100"><a href="#cb20-100"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-101"><a href="#cb20-101"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb20-102"><a href="#cb20-102"></a>        <span class="at">family =</span> <span class="st">"CMU Serif"</span>),</span>
<span id="cb20-103"><a href="#cb20-103"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"lines"</span>),</span>
<span id="cb20-104"><a href="#cb20-104"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb20-105"><a href="#cb20-105"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb20-106"><a href="#cb20-106"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb20-107"><a href="#cb20-107"></a>                          <span class="at">family =</span> <span class="st">"CMU Serif"</span>)</span>
<span id="cb20-108"><a href="#cb20-108"></a>    )</span>
<span id="cb20-109"><a href="#cb20-109"></a></span>
<span id="cb20-110"><a href="#cb20-110"></a>  <span class="cf">if</span> (which.measure <span class="sc">==</span> <span class="st">"Type-1 error"</span>) {</span>
<span id="cb20-111"><a href="#cb20-111"></a>    output.plot <span class="ot">&lt;-</span> ddd <span class="sc">%&gt;%</span></span>
<span id="cb20-112"><a href="#cb20-112"></a>      <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-113"><a href="#cb20-113"></a>      <span class="fu">aes</span>(</span>
<span id="cb20-114"><a href="#cb20-114"></a>        <span class="at">x =</span> T,</span>
<span id="cb20-115"><a href="#cb20-115"></a>        <span class="at">y =</span> value,</span>
<span id="cb20-116"><a href="#cb20-116"></a>        <span class="at">group =</span> N,</span>
<span id="cb20-117"><a href="#cb20-117"></a>        <span class="at">color =</span> N</span>
<span id="cb20-118"><a href="#cb20-118"></a>      ) <span class="sc">+</span></span>
<span id="cb20-119"><a href="#cb20-119"></a>      <span class="do">## draw solid y=0 axis line</span></span>
<span id="cb20-120"><a href="#cb20-120"></a>      <span class="fu">geom_hline</span>(</span>
<span id="cb20-121"><a href="#cb20-121"></a>        <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb20-122"><a href="#cb20-122"></a>        <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb20-123"><a href="#cb20-123"></a>        <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb20-124"><a href="#cb20-124"></a>        <span class="at">alpha =</span> <span class="dv">1</span></span>
<span id="cb20-125"><a href="#cb20-125"></a>      ) <span class="sc">+</span></span>
<span id="cb20-126"><a href="#cb20-126"></a>      <span class="do">## manually add needed grids</span></span>
<span id="cb20-127"><a href="#cb20-127"></a>      <span class="fu">geom_hline</span>(</span>
<span id="cb20-128"><a href="#cb20-128"></a>        <span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>),</span>
<span id="cb20-129"><a href="#cb20-129"></a>        <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb20-130"><a href="#cb20-130"></a>        <span class="at">color =</span> <span class="st">"#BEBEBE"</span>,</span>
<span id="cb20-131"><a href="#cb20-131"></a>        <span class="at">alpha =</span> <span class="dv">1</span></span>
<span id="cb20-132"><a href="#cb20-132"></a>      ) <span class="sc">+</span></span>
<span id="cb20-133"><a href="#cb20-133"></a>      <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>),</span>
<span id="cb20-134"><a href="#cb20-134"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb20-135"><a href="#cb20-135"></a>                <span class="at">lineend =</span> <span class="st">"round"</span>) <span class="sc">+</span></span>
<span id="cb20-136"><a href="#cb20-136"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-137"><a href="#cb20-137"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"PuRd"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>)]) <span class="sc">+</span></span>
<span id="cb20-138"><a href="#cb20-138"></a>      <span class="fu">facet_grid</span>(</span>
<span id="cb20-139"><a href="#cb20-139"></a>        <span class="at">rows =</span> <span class="fu">vars</span>(<span class="st">`</span><span class="at">Model name</span><span class="st">`</span>),</span>
<span id="cb20-140"><a href="#cb20-140"></a>        <span class="at">cols =</span> <span class="fu">vars</span>(Resid),</span>
<span id="cb20-141"><a href="#cb20-141"></a>        <span class="at">labeller =</span> label_parsed</span>
<span id="cb20-142"><a href="#cb20-142"></a>      ) <span class="sc">+</span></span>
<span id="cb20-143"><a href="#cb20-143"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-144"><a href="#cb20-144"></a>      <span class="fu">theme_pubclean</span>() <span class="sc">+</span></span>
<span id="cb20-145"><a href="#cb20-145"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>),</span>
<span id="cb20-146"><a href="#cb20-146"></a>                         <span class="do">## looked up myself to assure  + and - ranges are equal</span></span>
<span id="cb20-147"><a href="#cb20-147"></a>                         <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">61</span>)) <span class="sc">+</span></span>
<span id="cb20-148"><a href="#cb20-148"></a>      <span class="fu">ylab</span>(y.axis) <span class="sc">+</span></span>
<span id="cb20-149"><a href="#cb20-149"></a>      <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb20-150"><a href="#cb20-150"></a>      <span class="fu">theme</span>(</span>
<span id="cb20-151"><a href="#cb20-151"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb20-152"><a href="#cb20-152"></a>          <span class="at">family =</span> <span class="st">"CMU Serif"</span>),</span>
<span id="cb20-153"><a href="#cb20-153"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"lines"</span>),</span>
<span id="cb20-154"><a href="#cb20-154"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb20-155"><a href="#cb20-155"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb20-156"><a href="#cb20-156"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">"mm"</span>),</span>
<span id="cb20-157"><a href="#cb20-157"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb20-158"><a href="#cb20-158"></a>                            <span class="at">family =</span> <span class="st">"CMU Serif"</span>),</span>
<span id="cb20-159"><a href="#cb20-159"></a>        <span class="do">## remove grid lines</span></span>
<span id="cb20-160"><a href="#cb20-160"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb20-161"><a href="#cb20-161"></a>      )</span>
<span id="cb20-162"><a href="#cb20-162"></a></span>
<span id="cb20-163"><a href="#cb20-163"></a>    <span class="do">## add thresholds</span></span>
<span id="cb20-164"><a href="#cb20-164"></a>    <span class="cf">if</span> (y.axis <span class="sc">==</span> <span class="st">"Total error"</span>)</span>
<span id="cb20-165"><a href="#cb20-165"></a>      output.plot <span class="ot">&lt;-</span> output.plot <span class="sc">+</span></span>
<span id="cb20-166"><a href="#cb20-166"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">5</span>,</span>
<span id="cb20-167"><a href="#cb20-167"></a>                   <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb20-168"><a href="#cb20-168"></a>                   <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb20-169"><a href="#cb20-169"></a></span>
<span id="cb20-170"><a href="#cb20-170"></a>    <span class="cf">if</span> (y.axis <span class="sc">!=</span> <span class="st">"Total error"</span>)</span>
<span id="cb20-171"><a href="#cb20-171"></a>      output.plot <span class="ot">&lt;-</span> output.plot <span class="sc">+</span></span>
<span id="cb20-172"><a href="#cb20-172"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.5</span>,</span>
<span id="cb20-173"><a href="#cb20-173"></a>                   <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb20-174"><a href="#cb20-174"></a>                   <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb20-175"><a href="#cb20-175"></a></span>
<span id="cb20-176"><a href="#cb20-176"></a>  }</span>
<span id="cb20-177"><a href="#cb20-177"></a></span>
<span id="cb20-178"><a href="#cb20-178"></a>  output.plot <span class="ot">&lt;-</span> output.plot <span class="sc">+</span></span>
<span id="cb20-179"><a href="#cb20-179"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb20-180"><a href="#cb20-180"></a>               <span class="at">alpha =</span> <span class="fl">0.6</span>)</span>
<span id="cb20-181"><a href="#cb20-181"></a></span>
<span id="cb20-182"><a href="#cb20-182"></a>  <span class="fu">return</span>(output.plot)</span>
<span id="cb20-183"><a href="#cb20-183"></a></span>
<span id="cb20-184"><a href="#cb20-184"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>The function <code>plot_quadrants</code> makes a larger figure that includes four <em>quadrants</em>, each generated with <code>plot_Model.x.Resid</code>., that show the main results of the paper.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-25_280b95ca05656fff11ef571db1de17a4">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>plot_quadrants <span class="ot">&lt;-</span> <span class="cf">function</span>(d_important,</span>
<span id="cb21-2"><a href="#cb21-2"></a>                           <span class="at">which.parameter =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb21-3"><a href="#cb21-3"></a>                           <span class="at">upper.measure =</span> <span class="st">"Bias"</span>,</span>
<span id="cb21-4"><a href="#cb21-4"></a>                           <span class="at">lower.measure =</span> <span class="st">"RMSE"</span>,</span>
<span id="cb21-5"><a href="#cb21-5"></a>                           <span class="at">line.width =</span> <span class="dv">2</span>,</span>
<span id="cb21-6"><a href="#cb21-6"></a>                           <span class="at">font.scale =</span> <span class="dv">8</span>) {</span>
<span id="cb21-7"><a href="#cb21-7"></a>  p.upper.left <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb21-8"><a href="#cb21-8"></a>                                     which.parameter,</span>
<span id="cb21-9"><a href="#cb21-9"></a>                                     upper.measure,</span>
<span id="cb21-10"><a href="#cb21-10"></a>                                     <span class="st">"Gaussian"</span>,</span>
<span id="cb21-11"><a href="#cb21-11"></a>                                     line.width,</span>
<span id="cb21-12"><a href="#cb21-12"></a>                                     font.scale) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a>  p.upper.right <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb21-15"><a href="#cb21-15"></a>                                      which.parameter,</span>
<span id="cb21-16"><a href="#cb21-16"></a>                                      upper.measure,</span>
<span id="cb21-17"><a href="#cb21-17"></a>                                      <span class="st">"Chi2"</span>,</span>
<span id="cb21-18"><a href="#cb21-18"></a>                                      line.width,</span>
<span id="cb21-19"><a href="#cb21-19"></a>                                      font.scale) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-20"><a href="#cb21-20"></a></span>
<span id="cb21-21"><a href="#cb21-21"></a></span>
<span id="cb21-22"><a href="#cb21-22"></a>  p.lower.left <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb21-23"><a href="#cb21-23"></a>                                     which.parameter,</span>
<span id="cb21-24"><a href="#cb21-24"></a>                                     lower.measure,</span>
<span id="cb21-25"><a href="#cb21-25"></a>                                     <span class="st">"Gaussian"</span>,</span>
<span id="cb21-26"><a href="#cb21-26"></a>                                     line.width,</span>
<span id="cb21-27"><a href="#cb21-27"></a>                                     font.scale)  <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-28"><a href="#cb21-28"></a></span>
<span id="cb21-29"><a href="#cb21-29"></a>  p.lower.right <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb21-30"><a href="#cb21-30"></a>                                      which.parameter,</span>
<span id="cb21-31"><a href="#cb21-31"></a>                                      lower.measure,</span>
<span id="cb21-32"><a href="#cb21-32"></a>                                      <span class="st">"Chi2"</span>,</span>
<span id="cb21-33"><a href="#cb21-33"></a>                                      line.width,</span>
<span id="cb21-34"><a href="#cb21-34"></a>                                      font.scale)  <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-35"><a href="#cb21-35"></a></span>
<span id="cb21-36"><a href="#cb21-36"></a></span>
<span id="cb21-37"><a href="#cb21-37"></a>  p.patchwork <span class="ot">&lt;-</span></span>
<span id="cb21-38"><a href="#cb21-38"></a>    (p.upper.left <span class="sc">|</span> p.upper.right) <span class="sc">/</span> (p.lower.left <span class="sc">|</span> p.lower.right)</span>
<span id="cb21-39"><a href="#cb21-39"></a></span>
<span id="cb21-40"><a href="#cb21-40"></a>  title <span class="ot">&lt;-</span> <span class="fu">paste</span>(upper.measure,</span>
<span id="cb21-41"><a href="#cb21-41"></a>                 <span class="st">"and"</span>,</span>
<span id="cb21-42"><a href="#cb21-42"></a>                 lower.measure,</span>
<span id="cb21-43"><a href="#cb21-43"></a>                 <span class="st">"in the estimated"</span>,</span>
<span id="cb21-44"><a href="#cb21-44"></a>                 <span class="fu">tolower</span>(which.parameter))</span>
<span id="cb21-45"><a href="#cb21-45"></a></span>
<span id="cb21-46"><a href="#cb21-46"></a>  <span class="cf">if</span> (which.parameter <span class="sc">==</span> <span class="st">"Fixed.Phi"</span>)</span>
<span id="cb21-47"><a href="#cb21-47"></a>    title <span class="ot">&lt;-</span> <span class="st">"Level-2 $</span><span class="sc">\\</span><span class="st">phi$"</span></span>
<span id="cb21-48"><a href="#cb21-48"></a></span>
<span id="cb21-49"><a href="#cb21-49"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"error"</span>, <span class="fu">tolower</span>(upper.measure), <span class="at">fixed =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb21-50"><a href="#cb21-50"></a>    title <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Type-I error rates in the estimated"</span>,</span>
<span id="cb21-51"><a href="#cb21-51"></a>                   <span class="fu">tolower</span>(which.parameter))</span>
<span id="cb21-52"><a href="#cb21-52"></a>  }</span>
<span id="cb21-53"><a href="#cb21-53"></a></span>
<span id="cb21-54"><a href="#cb21-54"></a></span>
<span id="cb21-55"><a href="#cb21-55"></a>  p.final <span class="ot">&lt;-</span> p.patchwork <span class="sc">+</span></span>
<span id="cb21-56"><a href="#cb21-56"></a>    <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb21-57"><a href="#cb21-57"></a>    <span class="fu">plot_annotation</span>(</span>
<span id="cb21-58"><a href="#cb21-58"></a>      <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span></span>
<span id="cb21-59"><a href="#cb21-59"></a>                      <span class="fu">element_text</span>(</span>
<span id="cb21-60"><a href="#cb21-60"></a>                        <span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb21-61"><a href="#cb21-61"></a>                        <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb21-62"><a href="#cb21-62"></a>                        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb21-63"><a href="#cb21-63"></a>                      ))) <span class="sc">&amp;</span></span>
<span id="cb21-64"><a href="#cb21-64"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-65"><a href="#cb21-65"></a></span>
<span id="cb21-66"><a href="#cb21-66"></a>  <span class="fu">return</span>(p.final)</span>
<span id="cb21-67"><a href="#cb21-67"></a></span>
<span id="cb21-68"><a href="#cb21-68"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-report-caterpillar-plots" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="sec-report-caterpillar-plots"><span class="header-section-number">1.4.4</span> Making plots of parameter estimates coverage</h3>
<p>The function <code>plot_caterpillar</code> , for a given condition and a given parameter, makes plots of 95% confidence intervals (as vertical bars) of all converged replications within that condition. The lines are ordered based on the point estimates and are colored based on whether they crossed zero (the correct estimate) or whether the whole 95% interval was bellow or above zero (significantly negative or positive estimates).</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-26_6085e17f4ed593a6deed8d2309b5ac14">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>plot_caterpillar <span class="ot">&lt;-</span> <span class="cf">function</span>(d_abridged,</span>
<span id="cb22-2"><a href="#cb22-2"></a>                             <span class="at">l2.dist_ =</span> <span class="st">"Chi2"</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>                             <span class="at">Model_ =</span> <span class="st">"PoDAR"</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                             <span class="at">analysis.type =</span> <span class="st">"resid.fixed"</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>                             <span class="at">parameter_ =</span> <span class="st">"covariance"</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>                             <span class="at">legend.key.width =</span> <span class="dv">5</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>                             <span class="at">legend.line.width =</span> <span class="dv">10</span>) {</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>  title <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb22-10"><a href="#cb22-10"></a>    analysis.type <span class="sc">==</span> <span class="st">"resid.fixed"</span>,</span>
<span id="cb22-11"><a href="#cb22-11"></a>    <span class="st">"fixed residual variance"</span>,</span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="st">"random residual variance"</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="fu">paste</span>(<span class="st">"Modeled with"</span>, .)</span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a>  dd <span class="ot">&lt;-</span> d_abridged <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>    <span class="fu">filter</span>(l2.dist <span class="sc">==</span> l2.dist_,</span>
<span id="cb22-18"><a href="#cb22-18"></a>           Model <span class="sc">==</span> Model_) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="fu">filter</span>(<span class="fu">tolower</span>(parameter) <span class="sc">==</span> <span class="fu">tolower</span>(parameter_)) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="fu">filter</span>(type <span class="sc">==</span> analysis.type) <span class="sc">%&gt;%</span></span>
<span id="cb22-21"><a href="#cb22-21"></a>  <span class="fu">select</span>(type,</span>
<span id="cb22-22"><a href="#cb22-22"></a>         N,</span>
<span id="cb22-23"><a href="#cb22-23"></a>         T,</span>
<span id="cb22-24"><a href="#cb22-24"></a>         l2.dist,</span>
<span id="cb22-25"><a href="#cb22-25"></a>         Model,</span>
<span id="cb22-26"><a href="#cb22-26"></a>         est,</span>
<span id="cb22-27"><a href="#cb22-27"></a>         sig,</span>
<span id="cb22-28"><a href="#cb22-28"></a>         lower_2<span class="fl">.5</span>ci,</span>
<span id="cb22-29"><a href="#cb22-29"></a>         upper_2<span class="fl">.5</span>ci</span>
<span id="cb22-30"><a href="#cb22-30"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-31"><a href="#cb22-31"></a>    <span class="fu">group_by</span>(N, T, type, Model, l2.dist) <span class="sc">%&gt;%</span></span>
<span id="cb22-32"><a href="#cb22-32"></a>    <span class="fu">mutate</span>(<span class="at">sign.X.sig =</span> <span class="fu">as.factor</span>(<span class="fu">sign</span>(est)<span class="sc">*</span>sig)) <span class="sc">%&gt;%</span></span>
<span id="cb22-33"><a href="#cb22-33"></a>    <span class="co"># mutate(sign.X.sig = factor(sign.X.sig, levels = c("Negative Type-I error",</span></span>
<span id="cb22-34"><a href="#cb22-34"></a>    <span class="co">#                                                   "Non-significant estimates",</span></span>
<span id="cb22-35"><a href="#cb22-35"></a>    <span class="co">#                                                   "Positive Type-I error"))) %&gt;%</span></span>
<span id="cb22-36"><a href="#cb22-36"></a>    <span class="fu">mutate</span>(<span class="at">mean.est =</span> <span class="fu">mean</span>(est),</span>
<span id="cb22-37"><a href="#cb22-37"></a>           <span class="at">n.datasets =</span> <span class="fu">n</span>(),</span>
<span id="cb22-38"><a href="#cb22-38"></a>           <span class="at">nonconverged.percent =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(<span class="dv">1000</span><span class="sc">-</span><span class="fu">n</span>())<span class="sc">/</span><span class="dv">1000</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-39"><a href="#cb22-39"></a>    <span class="fu">group_by</span>(sign.X.sig,</span>
<span id="cb22-40"><a href="#cb22-40"></a>             <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-41"><a href="#cb22-41"></a>    <span class="fu">mutate</span>(<span class="at">error.percents =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">n</span>()<span class="sc">/</span>n.datasets,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-42"><a href="#cb22-42"></a>    <span class="fu">arrange</span>(N, T,</span>
<span id="cb22-43"><a href="#cb22-43"></a>            <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-44"><a href="#cb22-44"></a>    <span class="fu">mutate</span>(<span class="at">ordering =</span> est <span class="co"># + 100*sign(est)*sig</span></span>
<span id="cb22-45"><a href="#cb22-45"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb22-46"><a href="#cb22-46"></a>    <span class="fu">arrange</span>(ordering) <span class="sc">%&gt;%</span></span>
<span id="cb22-47"><a href="#cb22-47"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-48"><a href="#cb22-48"></a>    <span class="fu">group_by</span>(type,</span>
<span id="cb22-49"><a href="#cb22-49"></a>             N,</span>
<span id="cb22-50"><a href="#cb22-50"></a>             T,</span>
<span id="cb22-51"><a href="#cb22-51"></a>             l2.dist,</span>
<span id="cb22-52"><a href="#cb22-52"></a>             Model) <span class="sc">%&gt;%</span></span>
<span id="cb22-53"><a href="#cb22-53"></a>    <span class="fu">mutate</span>(<span class="at">ord =</span> <span class="fu">order</span>(ordering) <span class="sc">-</span> <span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-54"><a href="#cb22-54"></a>    <span class="fu">mutate</span>(<span class="at">NN =</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(<span class="st">"N ="</span>, N)),</span>
<span id="cb22-55"><a href="#cb22-55"></a>           <span class="at">TT =</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(<span class="st">"T ="</span>, T)))</span>
<span id="cb22-56"><a href="#cb22-56"></a></span>
<span id="cb22-57"><a href="#cb22-57"></a></span>
<span id="cb22-58"><a href="#cb22-58"></a>  <span class="fu">levels</span>(dd<span class="sc">$</span>sign.X.sig) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Significant negative estimates"</span>,</span>
<span id="cb22-59"><a href="#cb22-59"></a>                            <span class="st">"Non-significant estimates"</span>,</span>
<span id="cb22-60"><a href="#cb22-60"></a>                            <span class="st">"Significant positive estimates"</span>)</span>
<span id="cb22-61"><a href="#cb22-61"></a></span>
<span id="cb22-62"><a href="#cb22-62"></a>  y.range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(dd<span class="sc">$</span>lower_2<span class="fl">.5</span>ci), <span class="fu">max</span>(dd<span class="sc">$</span>upper_2<span class="fl">.5</span>ci))</span>
<span id="cb22-63"><a href="#cb22-63"></a></span>
<span id="cb22-64"><a href="#cb22-64"></a>  dd <span class="sc">%&gt;%</span></span>
<span id="cb22-65"><a href="#cb22-65"></a>    <span class="fu">mutate</span>(<span class="at">NN =</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(<span class="st">"N ="</span>, N)),</span>
<span id="cb22-66"><a href="#cb22-66"></a>           <span class="at">TT =</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(<span class="st">"T ="</span>, T))) <span class="sc">%&gt;%</span></span>
<span id="cb22-67"><a href="#cb22-67"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-68"><a href="#cb22-68"></a>    <span class="fu">aes</span>(<span class="at">x =</span> ord,</span>
<span id="cb22-69"><a href="#cb22-69"></a>        <span class="at">color =</span> sign.X.sig) <span class="sc">+</span></span>
<span id="cb22-70"><a href="#cb22-70"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb22-71"><a href="#cb22-71"></a>      <span class="fu">aes</span>(</span>
<span id="cb22-72"><a href="#cb22-72"></a>        <span class="at">x =</span> ord,</span>
<span id="cb22-73"><a href="#cb22-73"></a>        <span class="at">xend =</span> ord,</span>
<span id="cb22-74"><a href="#cb22-74"></a>        <span class="at">y =</span> upper_2<span class="fl">.5</span>ci,</span>
<span id="cb22-75"><a href="#cb22-75"></a>        <span class="at">yend =</span> lower_2<span class="fl">.5</span>ci</span>
<span id="cb22-76"><a href="#cb22-76"></a>      ),</span>
<span id="cb22-77"><a href="#cb22-77"></a>      <span class="at">alpha =</span> <span class="fl">0.8</span> <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb22-78"><a href="#cb22-78"></a>      <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.06</span>)</span>
<span id="cb22-79"><a href="#cb22-79"></a>    ) <span class="sc">+</span></span>
<span id="cb22-80"><a href="#cb22-80"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb22-81"><a href="#cb22-81"></a>      <span class="fu">aes</span>(</span>
<span id="cb22-82"><a href="#cb22-82"></a>        <span class="at">x =</span> ord,</span>
<span id="cb22-83"><a href="#cb22-83"></a>        <span class="at">xend =</span> ord,</span>
<span id="cb22-84"><a href="#cb22-84"></a>        <span class="at">y =</span> est <span class="sc">+</span> <span class="fu">min</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">abs</span>(upper_2<span class="fl">.5</span>ci <span class="sc">-</span> lower_2<span class="fl">.5</span>ci)),</span>
<span id="cb22-85"><a href="#cb22-85"></a>        <span class="at">yend =</span> est <span class="sc">-</span> <span class="fu">min</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">abs</span>(upper_2<span class="fl">.5</span>ci <span class="sc">-</span> lower_2<span class="fl">.5</span>ci))</span>
<span id="cb22-86"><a href="#cb22-86"></a>      ),</span>
<span id="cb22-87"><a href="#cb22-87"></a>      <span class="at">alpha =</span> <span class="fl">0.8</span> <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb22-88"><a href="#cb22-88"></a>      <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb22-89"><a href="#cb22-89"></a>      <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.06</span>)</span>
<span id="cb22-90"><a href="#cb22-90"></a>    ) <span class="sc">+</span></span>
<span id="cb22-91"><a href="#cb22-91"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb22-92"><a href="#cb22-92"></a>      <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb22-93"><a href="#cb22-93"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb22-94"><a href="#cb22-94"></a>      <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.15</span>),</span>
<span id="cb22-95"><a href="#cb22-95"></a>      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb22-96"><a href="#cb22-96"></a>      <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb22-97"><a href="#cb22-97"></a>    ) <span class="sc">+</span></span>
<span id="cb22-98"><a href="#cb22-98"></a>    <span class="fu">theme_pubclean</span>() <span class="sc">+</span></span>
<span id="cb22-99"><a href="#cb22-99"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb22-100"><a href="#cb22-100"></a>      <span class="at">linewidth =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>),</span>
<span id="cb22-101"><a href="#cb22-101"></a>      <span class="at">alpha =</span> <span class="dv">1</span></span>
<span id="cb22-102"><a href="#cb22-102"></a>    ))) <span class="sc">+</span></span>
<span id="cb22-103"><a href="#cb22-103"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span></span>
<span id="cb22-104"><a href="#cb22-104"></a>                         <span class="fu">c</span>(<span class="st">"#F67E4BFF"</span>,</span>
<span id="cb22-105"><a href="#cb22-105"></a>                           <span class="st">"#98CAE1FF"</span>,</span>
<span id="cb22-106"><a href="#cb22-106"></a>                           <span class="st">"#364B9AFF"</span>)) <span class="sc">+</span></span>
<span id="cb22-107"><a href="#cb22-107"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> y.range) <span class="sc">+</span></span>
<span id="cb22-108"><a href="#cb22-108"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(NN),</span>
<span id="cb22-109"><a href="#cb22-109"></a>               <span class="co"># rows = vars(rev(TT)),</span></span>
<span id="cb22-110"><a href="#cb22-110"></a>               <span class="at">cols =</span> <span class="fu">vars</span>(TT)) <span class="sc">+</span></span>
<span id="cb22-111"><a href="#cb22-111"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb22-112"><a href="#cb22-112"></a>    <span class="fu">theme</span>(</span>
<span id="cb22-113"><a href="#cb22-113"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb22-114"><a href="#cb22-114"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb22-115"><a href="#cb22-115"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-116"><a href="#cb22-116"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-117"><a href="#cb22-117"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-118"><a href="#cb22-118"></a>      <span class="co"># "Score",</span></span>
<span id="cb22-119"><a href="#cb22-119"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-120"><a href="#cb22-120"></a>      <span class="at">legend.key.width =</span> <span class="fu">unit</span>(legend.key.width <span class="sc">*</span> <span class="dv">2</span>, <span class="st">"mm"</span>),</span>
<span id="cb22-121"><a href="#cb22-121"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb22-122"><a href="#cb22-122"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb22-123"><a href="#cb22-123"></a>                          <span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb22-124"><a href="#cb22-124"></a>    ) <span class="sc">+</span></span>
<span id="cb22-125"><a href="#cb22-125"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb22-126"><a href="#cb22-126"></a>    <span class="fu">ylab</span>(<span class="fu">paste</span>(<span class="st">"Estimated"</span>, parameter))</span>
<span id="cb22-127"><a href="#cb22-127"></a></span>
<span id="cb22-128"><a href="#cb22-128"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="making-plots-for-dgm-time-series" class="level3" data-number="1.4.5">
<h3 data-number="1.4.5" class="anchored" data-anchor-id="making-plots-for-dgm-time-series"><span class="header-section-number">1.4.5</span> Making plots for DGM time series</h3>
<p>A function was also made to make profiles of individual time series, that include the time series itself, its marginal distribution, and its sample ACF.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-27_a88b76507b1e114a62d85a543813699b">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>plot_dgm.profile <span class="ot">&lt;-</span> <span class="cf">function</span>(d,</span>
<span id="cb23-2"><a href="#cb23-2"></a>                             <span class="at">p.colors =</span> colors.nar.khaki,</span>
<span id="cb23-3"><a href="#cb23-3"></a>                             <span class="at">Model.name =</span> <span class="st">"NAR(1)"</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>                             <span class="at">burnin_proportion =</span> <span class="fl">0.9</span>){</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a>  binwidth_ <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb23-7"><a href="#cb23-7"></a></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="do">## To make sure the plot title has the same height as Chi2AR model</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  Model.name <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">phantom{</span><span class="sc">\\</span><span class="st">chi^2}$"</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>                      Model.name,</span>
<span id="cb23-11"><a href="#cb23-11"></a>                      <span class="st">"$</span><span class="sc">\\</span><span class="st">phantom{</span><span class="sc">\\</span><span class="st">chi^2}$"</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a>  d<span class="sc">$</span>obj.id <span class="ot">&lt;-</span> d<span class="sc">$</span>obj.id <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="fu">unique</span>(d<span class="sc">$</span>obj.id))</span>
<span id="cb23-14"><a href="#cb23-14"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>    <span class="fu">filter</span>(t <span class="sc">&gt;</span> <span class="fu">max</span>(d<span class="sc">$</span>t)<span class="sc">*</span>burnin_proportion) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>    <span class="fu">mutate</span>(<span class="at">t =</span> t <span class="sc">-</span> burnin_proportion<span class="sc">*</span><span class="fu">max</span>(t))</span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a>  acf.lag.max <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb23-19"><a href="#cb23-19"></a></span>
<span id="cb23-20"><a href="#cb23-20"></a>  d_acf <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>    <span class="fu">group_by</span>(obj.id) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22"></a>    <span class="fu">summarize</span>(<span class="at">lag =</span> stats<span class="sc">::</span><span class="fu">acf</span>(value,</span>
<span id="cb23-23"><a href="#cb23-23"></a>                               <span class="at">lag.max =</span> acf.lag.max,</span>
<span id="cb23-24"><a href="#cb23-24"></a>                               <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>lag <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb23-25"><a href="#cb23-25"></a>              <span class="at">acf =</span> stats<span class="sc">::</span><span class="fu">acf</span>(value,</span>
<span id="cb23-26"><a href="#cb23-26"></a>                               <span class="at">lag.max =</span> acf.lag.max,</span>
<span id="cb23-27"><a href="#cb23-27"></a>                               <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb23-28"><a href="#cb23-28"></a>    )</span>
<span id="cb23-29"><a href="#cb23-29"></a>  empirical.rho <span class="ot">&lt;-</span> d_acf <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>    <span class="fu">filter</span>(lag <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb23-31"><a href="#cb23-31"></a>  empirical.rho <span class="ot">&lt;-</span> empirical.rho[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(empirical.rho),</span>
<span id="cb23-32"><a href="#cb23-32"></a>                                     <span class="at">times =</span> acf.lag.max<span class="sc">*</span><span class="dv">20</span> <span class="sc">+</span> <span class="dv">1</span>), ]</span>
<span id="cb23-33"><a href="#cb23-33"></a></span>
<span id="cb23-34"><a href="#cb23-34"></a>  e.l <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, acf.lag.max, <span class="fl">0.05</span>),</span>
<span id="cb23-35"><a href="#cb23-35"></a>             <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb23-36"><a href="#cb23-36"></a>  empirical.rho<span class="sc">$</span>lag <span class="ot">&lt;-</span> e.l</span>
<span id="cb23-37"><a href="#cb23-37"></a>  empirical.rho<span class="sc">$</span>acf <span class="ot">&lt;-</span> empirical.rho<span class="sc">$</span>acf<span class="sc">^</span>empirical.rho<span class="sc">$</span>lag</span>
<span id="cb23-38"><a href="#cb23-38"></a></span>
<span id="cb23-39"><a href="#cb23-39"></a></span>
<span id="cb23-40"><a href="#cb23-40"></a>  <span class="co"># time series plot</span></span>
<span id="cb23-41"><a href="#cb23-41"></a>  p_ts <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb23-42"><a href="#cb23-42"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t,</span>
<span id="cb23-43"><a href="#cb23-43"></a>               <span class="at">y =</span> value,</span>
<span id="cb23-44"><a href="#cb23-44"></a>               <span class="at">group =</span> obj.id)) <span class="sc">+</span></span>
<span id="cb23-45"><a href="#cb23-45"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> obj.id),</span>
<span id="cb23-46"><a href="#cb23-46"></a>              <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb23-47"><a href="#cb23-47"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-48"><a href="#cb23-48"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> Mean),</span>
<span id="cb23-49"><a href="#cb23-49"></a>               <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb23-50"><a href="#cb23-50"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb23-51"><a href="#cb23-51"></a>               <span class="at">color =</span> <span class="st">"honeydew3"</span>) <span class="sc">+</span></span>
<span id="cb23-52"><a href="#cb23-52"></a>    <span class="fu">ggtitle</span>(<span class="st">"Time series"</span>) <span class="sc">+</span></span>
<span id="cb23-53"><a href="#cb23-53"></a>    <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span></span>
<span id="cb23-54"><a href="#cb23-54"></a>    <span class="fu">theme</span>(</span>
<span id="cb23-55"><a href="#cb23-55"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-56"><a href="#cb23-56"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co"># c(0.1,0.95),</span></span>
<span id="cb23-57"><a href="#cb23-57"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb23-58"><a href="#cb23-58"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>,</span>
<span id="cb23-59"><a href="#cb23-59"></a>                                  <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb23-60"><a href="#cb23-60"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb23-61"><a href="#cb23-61"></a>                               <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb23-62"><a href="#cb23-62"></a>      <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb23-63"><a href="#cb23-63"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-64"><a href="#cb23-64"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb23-65"><a href="#cb23-65"></a>                                <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb23-66"><a href="#cb23-66"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb23-67"><a href="#cb23-67"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> p.colors,</span>
<span id="cb23-68"><a href="#cb23-68"></a>                        <span class="at">labels =</span> <span class="fu">unname</span>(<span class="fu">TeX</span>(<span class="fu">unique</span>(<span class="fu">as.character</span>(d<span class="sc">$</span>obj.id))))</span>
<span id="cb23-69"><a href="#cb23-69"></a>    )</span>
<span id="cb23-70"><a href="#cb23-70"></a></span>
<span id="cb23-71"><a href="#cb23-71"></a>  p_hist <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb23-72"><a href="#cb23-72"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value,</span>
<span id="cb23-73"><a href="#cb23-73"></a>               <span class="at">group =</span> obj.id,</span>
<span id="cb23-74"><a href="#cb23-74"></a>               <span class="at">fill =</span> obj.id)) <span class="sc">+</span></span>
<span id="cb23-75"><a href="#cb23-75"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..ndensity..),</span>
<span id="cb23-76"><a href="#cb23-76"></a>                   <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb23-77"><a href="#cb23-77"></a>                   <span class="at">binwidth =</span> binwidth_) <span class="sc">+</span></span>
<span id="cb23-78"><a href="#cb23-78"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>obj.id,</span>
<span id="cb23-79"><a href="#cb23-79"></a>               <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-80"><a href="#cb23-80"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb23-81"><a href="#cb23-81"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-82"><a href="#cb23-82"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Mean,</span>
<span id="cb23-83"><a href="#cb23-83"></a>                     <span class="at">xend =</span> Mean,</span>
<span id="cb23-84"><a href="#cb23-84"></a>                     <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-85"><a href="#cb23-85"></a>                     <span class="at">yend =</span> <span class="dv">1</span>),</span>
<span id="cb23-86"><a href="#cb23-86"></a>                 <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb23-87"><a href="#cb23-87"></a>                 <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb23-88"><a href="#cb23-88"></a>                 <span class="at">color =</span> <span class="st">"honeydew3"</span>) <span class="sc">+</span></span>
<span id="cb23-89"><a href="#cb23-89"></a>  <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb23-90"><a href="#cb23-90"></a>    <span class="fu">ggtitle</span>(<span class="st">"Marginal distribution"</span>) <span class="sc">+</span></span>
<span id="cb23-91"><a href="#cb23-91"></a>    <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb23-92"><a href="#cb23-92"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(d_acf<span class="sc">$</span>acf), <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-93"><a href="#cb23-93"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-94"><a href="#cb23-94"></a>          <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-95"><a href="#cb23-95"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>,</span>
<span id="cb23-96"><a href="#cb23-96"></a>                                      <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb23-97"><a href="#cb23-97"></a>          <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-98"><a href="#cb23-98"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-99"><a href="#cb23-99"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-100"><a href="#cb23-100"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb23-101"><a href="#cb23-101"></a>          <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb23-102"><a href="#cb23-102"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-103"><a href="#cb23-103"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb23-104"><a href="#cb23-104"></a>                                    <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb23-105"><a href="#cb23-105"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb23-106"><a href="#cb23-106"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> p.colors,</span>
<span id="cb23-107"><a href="#cb23-107"></a>                      <span class="fu">unname</span>(<span class="fu">TeX</span>(<span class="fu">unique</span>(<span class="fu">as.character</span>(d<span class="sc">$</span>obj.id))))</span>
<span id="cb23-108"><a href="#cb23-108"></a>    )</span>
<span id="cb23-109"><a href="#cb23-109"></a></span>
<span id="cb23-110"><a href="#cb23-110"></a></span>
<span id="cb23-111"><a href="#cb23-111"></a>  <span class="do">### ACF plots</span></span>
<span id="cb23-112"><a href="#cb23-112"></a></span>
<span id="cb23-113"><a href="#cb23-113"></a>  d_acf <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb23-114"><a href="#cb23-114"></a>    <span class="fu">group_by</span>(obj.id) <span class="sc">%&gt;%</span></span>
<span id="cb23-115"><a href="#cb23-115"></a>    <span class="fu">summarize</span>(<span class="at">lag =</span> stats<span class="sc">::</span><span class="fu">acf</span>(value,</span>
<span id="cb23-116"><a href="#cb23-116"></a>                               <span class="at">lag.max =</span> acf.lag.max,</span>
<span id="cb23-117"><a href="#cb23-117"></a>                               <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>lag <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb23-118"><a href="#cb23-118"></a>              <span class="at">acf =</span> stats<span class="sc">::</span><span class="fu">acf</span>(value,</span>
<span id="cb23-119"><a href="#cb23-119"></a>                               <span class="at">lag.max =</span> acf.lag.max,</span>
<span id="cb23-120"><a href="#cb23-120"></a>                               <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb23-121"><a href="#cb23-121"></a>              <span class="at">empirical.rho =</span> stats<span class="sc">::</span><span class="fu">acf</span>(value,</span>
<span id="cb23-122"><a href="#cb23-122"></a>                                         <span class="at">lag.max =</span> acf.lag.max,</span>
<span id="cb23-123"><a href="#cb23-123"></a>                                         <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>())</span>
<span id="cb23-124"><a href="#cb23-124"></a></span>
<span id="cb23-125"><a href="#cb23-125"></a></span>
<span id="cb23-126"><a href="#cb23-126"></a></span>
<span id="cb23-127"><a href="#cb23-127"></a></span>
<span id="cb23-128"><a href="#cb23-128"></a>  p_acf <span class="ot">&lt;-</span> d_acf <span class="sc">%&gt;%</span></span>
<span id="cb23-129"><a href="#cb23-129"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag,</span>
<span id="cb23-130"><a href="#cb23-130"></a>               <span class="at">y =</span> acf,</span>
<span id="cb23-131"><a href="#cb23-131"></a>               <span class="at">color =</span> obj.id)) <span class="sc">+</span></span>
<span id="cb23-132"><a href="#cb23-132"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag,</span>
<span id="cb23-133"><a href="#cb23-133"></a>                     <span class="at">xend =</span> lag,</span>
<span id="cb23-134"><a href="#cb23-134"></a>                     <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb23-135"><a href="#cb23-135"></a>                     <span class="at">yend =</span> acf</span>
<span id="cb23-136"><a href="#cb23-136"></a>    ),</span>
<span id="cb23-137"><a href="#cb23-137"></a>    <span class="at">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb23-138"><a href="#cb23-138"></a>    <span class="at">lineend =</span> <span class="st">"butt"</span>) <span class="sc">+</span></span>
<span id="cb23-139"><a href="#cb23-139"></a>    <span class="co"># exponential fit</span></span>
<span id="cb23-140"><a href="#cb23-140"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> empirical.rho,</span>
<span id="cb23-141"><a href="#cb23-141"></a>              <span class="fu">aes</span>(<span class="at">x =</span> lag,</span>
<span id="cb23-142"><a href="#cb23-142"></a>                  <span class="at">y =</span> acf),</span>
<span id="cb23-143"><a href="#cb23-143"></a>              <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb23-144"><a href="#cb23-144"></a>              <span class="at">color =</span> <span class="st">"honeydew3"</span>,</span>
<span id="cb23-145"><a href="#cb23-145"></a>              <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb23-146"><a href="#cb23-146"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>obj.id,</span>
<span id="cb23-147"><a href="#cb23-147"></a>               <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-148"><a href="#cb23-148"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>),</span>
<span id="cb23-149"><a href="#cb23-149"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-150"><a href="#cb23-150"></a>    <span class="fu">ggtitle</span>(<span class="st">"Sample ACF"</span>) <span class="sc">+</span></span>
<span id="cb23-151"><a href="#cb23-151"></a>    <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb23-152"><a href="#cb23-152"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-153"><a href="#cb23-153"></a>          <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-154"><a href="#cb23-154"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-155"><a href="#cb23-155"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>,</span>
<span id="cb23-156"><a href="#cb23-156"></a>                                      <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb23-157"><a href="#cb23-157"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb23-158"><a href="#cb23-158"></a>          <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb23-159"><a href="#cb23-159"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-160"><a href="#cb23-160"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb23-161"><a href="#cb23-161"></a>                                    <span class="at">fill =</span> <span class="cn">NA</span>)</span>
<span id="cb23-162"><a href="#cb23-162"></a>    ) <span class="sc">+</span></span>
<span id="cb23-163"><a href="#cb23-163"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, acf.lag.max, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb23-164"><a href="#cb23-164"></a>    <span class="fu">xlab</span>(<span class="st">"Lag"</span>) <span class="sc">+</span></span>
<span id="cb23-165"><a href="#cb23-165"></a>    <span class="fu">ylab</span>(<span class="st">"Autocorrelation function"</span>) <span class="sc">+</span></span>
<span id="cb23-166"><a href="#cb23-166"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb23-167"><a href="#cb23-167"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> p.colors,</span>
<span id="cb23-168"><a href="#cb23-168"></a>                       <span class="fu">unname</span>(<span class="fu">TeX</span>(<span class="fu">unique</span>(<span class="fu">as.character</span>(d<span class="sc">$</span>obj.id))))</span>
<span id="cb23-169"><a href="#cb23-169"></a>    )</span>
<span id="cb23-170"><a href="#cb23-170"></a></span>
<span id="cb23-171"><a href="#cb23-171"></a>  p_profile.main <span class="ot">&lt;-</span> p_ts <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> p_hist <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> p_acf <span class="sc">+</span></span>
<span id="cb23-172"><a href="#cb23-172"></a>    <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.05</span>, <span class="fl">1.5</span>, <span class="fl">0.05</span>, <span class="dv">2</span>)) <span class="sc">&amp;</span></span>
<span id="cb23-173"><a href="#cb23-173"></a>    <span class="fu">theme</span>(</span>
<span id="cb23-174"><a href="#cb23-174"></a>      <span class="co"># legend.key.width = unit(2, "line"),</span></span>
<span id="cb23-175"><a href="#cb23-175"></a>      <span class="co"># legend.text=element_text(size=10),</span></span>
<span id="cb23-176"><a href="#cb23-176"></a>      <span class="co"># legend.position = "none",</span></span>
<span id="cb23-177"><a href="#cb23-177"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>,</span>
<span id="cb23-178"><a href="#cb23-178"></a>                               <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>),</span>
<span id="cb23-179"><a href="#cb23-179"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span><span class="sc">+</span><span class="dv">5</span>,</span>
<span id="cb23-180"><a href="#cb23-180"></a>                                <span class="at">family =</span> <span class="st">"Merriweather Regular"</span>)</span>
<span id="cb23-181"><a href="#cb23-181"></a>    )</span>
<span id="cb23-182"><a href="#cb23-182"></a></span>
<span id="cb23-183"><a href="#cb23-183"></a>  p_out <span class="ot">&lt;-</span> p_profile.main</span>
<span id="cb23-184"><a href="#cb23-184"></a></span>
<span id="cb23-185"><a href="#cb23-185"></a>  <span class="fu">return</span>(p_out)</span>
<span id="cb23-186"><a href="#cb23-186"></a></span>
<span id="cb23-187"><a href="#cb23-187"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="sec-pipeline" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Pipeline</h1>
<p>We implemented each of these tasks in separate functions that were essentially wrapper functions (with parallel-computing implementation) around the modular components. Using these wrapper functions, each replication of each simulated condition was saved in a separate <code>.rds</code> file. These data files were fed to the analysis wrapper function whose output was saved in separate <code>.rds</code> data files. To collect relevant parameter estimates, another wrapper function was used to read the data files and save the desired parameters in a dataframe, which then used in reporting.</p>
<section id="sec-bookkeeping" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-bookkeeping"><span class="header-section-number">2.1</span> Book-keeping</h2>
<p>The outcomes of the components are saved in separate <code>.rds</code> files and indexed by unique, descriptive names, and each replication is given a unique numeric identifier that is also used as the random seed used to generate the dataset within each replication. The file names and address are stored in two dataframes along with model parameters used to generate each dataset, and these dataframes are used when reading and writing data files in other components.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Simulation file references</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Analysis outputs file references</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>The function <code>make_sim_refs</code> makes a table consisting of all possible combinations of each conditions (that are provided as a list <code>conditions</code>), and replicates it <code>Reps</code> times (number of replications, <span class="math inline">\(R = 1000\)</span>). Then, to make sure that each simulated dataset is produced with a unique random seed, the function generates a unique <code>uSeed</code> based on the number (and values) of conditions and the replication number. Furthermore, an initial simulation seed (<code>simSeed</code>) is included in generation of <code>uSeed</code> which makes it possible to have different <em>batches</em> of simulations (for instance, if one wants to run the simulation for another 1000 times).</p>
<p>For each condition, a unique seed is generated by weighting different conditions (that are indexed in a vector <code>d.integer</code>) by prime numbers (that are not among the prime factors of the number of conditions) and summing them up (which is done with dot-producting <code>d.integer %*% primes.seq</code>). Then, to make unique seeds per replications, the replication number is concatenated to the left side of <code>d.integer %*% primes.seq</code>, and everything is put into a dataframe (called <code>d.headers</code>, that is eventually returned by the function) with unique file names for individual <code>.rds</code> files (that include <code>uSeed</code> as well as the replication number and the value of condition used in data generation, e.g., <code>sim_uSeed-13293_l2.dist-Chi2_Model-BinAR_N-100_phi-0.4_T-100_sim.Seed-0_Rep-1</code>) and the address of the folder in which the <code>.rds</code> files were stored. Finally, if desired, the simulation reference table <code>d.headers</code> is saved as <code>.csv</code> and <code>.rds</code>.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-28_71eb361b18855933361484b50fc1b404">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>make_sim_refs <span class="ot">&lt;-</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="cf">function</span>(<span class="at">conditions =</span> <span class="fu">list</span>(<span class="at">T =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">100</span>),</span>
<span id="cb24-3"><a href="#cb24-3"></a>                             <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">100</span>),</span>
<span id="cb24-4"><a href="#cb24-4"></a>                             <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"BinAR"</span>, <span class="st">"Chi2AR"</span>, <span class="st">"DAR"</span>),</span>
<span id="cb24-5"><a href="#cb24-5"></a>                             <span class="at">l2.dist =</span> <span class="fu">c</span>(<span class="st">"Gaussian"</span>, <span class="st">"Chi2"</span>),</span>
<span id="cb24-6"><a href="#cb24-6"></a>                             <span class="at">phi =</span> <span class="fu">c</span>(<span class="fl">0.4</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a>  ),</span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="at">Reps =</span> <span class="dv">100</span>,</span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="at">simSeed =</span> <span class="dv">0</span>,</span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="at">save.directory =</span> <span class="st">"self-sim"</span>,</span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="at">save.refs.filename =</span> <span class="fu">paste</span>(<span class="st">"sim_refs"</span>,</span>
<span id="cb24-12"><a href="#cb24-12"></a>                             <span class="fu">Sys.Date</span>()),</span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="at">prefix.sim.datasets =</span> <span class="st">"sim_"</span>){</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a>    <span class="fu">dir.create</span>(save.directory, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-16"><a href="#cb24-16"></a></span>
<span id="cb24-17"><a href="#cb24-17"></a>    <span class="co"># allow Reps to be used as a vector of indexes</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>    <span class="cf">if</span>(<span class="fu">length</span>(Reps)<span class="sc">&lt;</span><span class="dv">2</span>) Reps <span class="ot">=</span> <span class="fu">seq_len</span>(Reps)</span>
<span id="cb24-19"><a href="#cb24-19"></a></span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="co"># save global seed of the global env and set it back before leaving</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>    seed.old <span class="ot">&lt;-</span> .Random.seed</span>
<span id="cb24-22"><a href="#cb24-22"></a>    <span class="fu">on.exit</span>({</span>
<span id="cb24-23"><a href="#cb24-23"></a>      .Random.seed <span class="ot">&lt;&lt;-</span> seed.old</span>
<span id="cb24-24"><a href="#cb24-24"></a>    })</span>
<span id="cb24-25"><a href="#cb24-25"></a></span>
<span id="cb24-26"><a href="#cb24-26"></a>    <span class="co"># sorting conditions alphabetically</span></span>
<span id="cb24-27"><a href="#cb24-27"></a>    conditions <span class="ot">&lt;-</span> conditions[<span class="fu">order</span>(<span class="fu">names</span>(conditions))]</span>
<span id="cb24-28"><a href="#cb24-28"></a></span>
<span id="cb24-29"><a href="#cb24-29"></a>    conditions<span class="sc">$</span>simSeed <span class="ot">&lt;-</span> simSeed</span>
<span id="cb24-30"><a href="#cb24-30"></a>    conditions<span class="sc">$</span>Rep <span class="ot">&lt;-</span> Reps</span>
<span id="cb24-31"><a href="#cb24-31"></a></span>
<span id="cb24-32"><a href="#cb24-32"></a>    n.conditions <span class="ot">&lt;-</span> <span class="fu">length</span>(conditions)</span>
<span id="cb24-33"><a href="#cb24-33"></a></span>
<span id="cb24-34"><a href="#cb24-34"></a>    <span class="co"># making the first columns of the data frame</span></span>
<span id="cb24-35"><a href="#cb24-35"></a>    d <span class="ot">&lt;-</span> conditions <span class="sc">%&gt;%</span></span>
<span id="cb24-36"><a href="#cb24-36"></a>      <span class="fu">expand.grid</span>(<span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-37"><a href="#cb24-37"></a></span>
<span id="cb24-38"><a href="#cb24-38"></a>    <span class="co"># transforming factors to numerics</span></span>
<span id="cb24-39"><a href="#cb24-39"></a>    d.numeric <span class="ot">&lt;-</span> d</span>
<span id="cb24-40"><a href="#cb24-40"></a>    factor.columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(d.numeric, is.factor)</span>
<span id="cb24-41"><a href="#cb24-41"></a>    d.numeric[factor.columns] <span class="ot">&lt;-</span></span>
<span id="cb24-42"><a href="#cb24-42"></a>      <span class="fu">sapply</span>(d.numeric[factor.columns], as.numeric)</span>
<span id="cb24-43"><a href="#cb24-43"></a></span>
<span id="cb24-44"><a href="#cb24-44"></a>    <span class="co"># getting rid of non-integers and Rep</span></span>
<span id="cb24-45"><a href="#cb24-45"></a>    d.integer <span class="ot">&lt;-</span> d.numeric[, <span class="sc">-</span>n.conditions] <span class="sc">%&gt;%</span></span>
<span id="cb24-46"><a href="#cb24-46"></a>      <span class="fu">apply</span>(<span class="dv">2</span>,</span>
<span id="cb24-47"><a href="#cb24-47"></a>            <span class="cf">function</span>(x)</span>
<span id="cb24-48"><a href="#cb24-48"></a>              x <span class="sc">%&gt;%</span></span>
<span id="cb24-49"><a href="#cb24-49"></a>              <span class="fu">as.character</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-50"><a href="#cb24-50"></a>              <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb24-51"><a href="#cb24-51"></a>              <span class="fu">as.numeric</span>())</span>
<span id="cb24-52"><a href="#cb24-52"></a></span>
<span id="cb24-53"><a href="#cb24-53"></a>    <span class="co"># to make unique seeds, we must sum conditions weighted by prime numbers</span></span>
<span id="cb24-54"><a href="#cb24-54"></a>    <span class="co"># but the primes must not be among prime factors of conditions</span></span>
<span id="cb24-55"><a href="#cb24-55"></a></span>
<span id="cb24-56"><a href="#cb24-56"></a>    <span class="co"># conditions prime factors</span></span>
<span id="cb24-57"><a href="#cb24-57"></a>    cpfs <span class="ot">&lt;-</span> d.integer <span class="sc">%&gt;%</span></span>
<span id="cb24-58"><a href="#cb24-58"></a>      <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-59"><a href="#cb24-59"></a>      <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-60"><a href="#cb24-60"></a>      <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-61"><a href="#cb24-61"></a>      primes<span class="sc">::</span><span class="fu">prime_factors</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-62"><a href="#cb24-62"></a>      <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-63"><a href="#cb24-63"></a>      <span class="fu">unique</span>()</span>
<span id="cb24-64"><a href="#cb24-64"></a></span>
<span id="cb24-65"><a href="#cb24-65"></a>    primes.seq <span class="ot">&lt;-</span> <span class="fu">c</span>(cpfs,</span>
<span id="cb24-66"><a href="#cb24-66"></a>                    primes<span class="sc">::</span><span class="fu">generate_n_primes</span>(<span class="fu">ncol</span>(d.integer) <span class="sc">+</span> <span class="fu">length</span>(cpfs)))</span>
<span id="cb24-67"><a href="#cb24-67"></a></span>
<span id="cb24-68"><a href="#cb24-68"></a>    primes.seq <span class="ot">&lt;-</span></span>
<span id="cb24-69"><a href="#cb24-69"></a>      primes.seq[<span class="sc">!</span>(<span class="fu">duplicated</span>(primes.seq) <span class="sc">|</span></span>
<span id="cb24-70"><a href="#cb24-70"></a>                     <span class="fu">duplicated</span>(primes.seq, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb24-71"><a href="#cb24-71"></a></span>
<span id="cb24-72"><a href="#cb24-72"></a>    uSeed <span class="ot">&lt;-</span> d.integer <span class="sc">%*%</span> primes.seq <span class="sc">%&gt;%</span></span>
<span id="cb24-73"><a href="#cb24-73"></a>      <span class="fu">as.character</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-74"><a href="#cb24-74"></a>      <span class="fu">paste0</span>(<span class="fu">as.character</span>(d.numeric<span class="sc">$</span>Rep),</span>
<span id="cb24-75"><a href="#cb24-75"></a>             .)</span>
<span id="cb24-76"><a href="#cb24-76"></a></span>
<span id="cb24-77"><a href="#cb24-77"></a>    d.headers <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb24-78"><a href="#cb24-78"></a>      <span class="fu">mutate</span>(</span>
<span id="cb24-79"><a href="#cb24-79"></a>        <span class="at">uSeed =</span> uSeed,</span>
<span id="cb24-80"><a href="#cb24-80"></a>        <span class="at">sim.Path =</span> save.directory,</span>
<span id="cb24-81"><a href="#cb24-81"></a>        <span class="at">sim.File =</span> <span class="cn">NA</span></span>
<span id="cb24-82"><a href="#cb24-82"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb24-83"><a href="#cb24-83"></a>      <span class="fu">relocate</span>(uSeed, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb24-84"><a href="#cb24-84"></a></span>
<span id="cb24-85"><a href="#cb24-85"></a>    <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d.headers)) {</span>
<span id="cb24-86"><a href="#cb24-86"></a>      only.headers <span class="ot">&lt;-</span> d.headers <span class="sc">%&gt;%</span></span>
<span id="cb24-87"><a href="#cb24-87"></a>        <span class="fu">select</span>(<span class="sc">-</span>sim.Path<span class="sc">:-</span>sim.File) <span class="sc">%&gt;%</span></span>
<span id="cb24-88"><a href="#cb24-88"></a>        <span class="fu">colnames</span>()</span>
<span id="cb24-89"><a href="#cb24-89"></a>      r.values <span class="ot">&lt;-</span> d.headers[r, only.headers]</span>
<span id="cb24-90"><a href="#cb24-90"></a>      factor.columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(r.values, is.factor)</span>
<span id="cb24-91"><a href="#cb24-91"></a>      r.values[factor.columns] <span class="ot">&lt;-</span></span>
<span id="cb24-92"><a href="#cb24-92"></a>        <span class="fu">sapply</span>(r.values[factor.columns], as.character)</span>
<span id="cb24-93"><a href="#cb24-93"></a>      d.headers[r, <span class="st">"sim.File"</span>] <span class="ot">&lt;-</span> only.headers <span class="sc">%&gt;%</span></span>
<span id="cb24-94"><a href="#cb24-94"></a>        <span class="fu">paste0</span>(<span class="st">"-"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-95"><a href="#cb24-95"></a>        <span class="fu">paste0</span>(r.values) <span class="sc">%&gt;%</span></span>
<span id="cb24-96"><a href="#cb24-96"></a>        <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-97"><a href="#cb24-97"></a>        <span class="fu">paste0</span>(<span class="st">".rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-98"><a href="#cb24-98"></a>        <span class="fu">paste0</span>(prefix.sim.datasets, .) <span class="co"># prefix for simulated datasets</span></span>
<span id="cb24-99"><a href="#cb24-99"></a>    }</span>
<span id="cb24-100"><a href="#cb24-100"></a></span>
<span id="cb24-101"><a href="#cb24-101"></a>    d <span class="ot">&lt;-</span> d.headers</span>
<span id="cb24-102"><a href="#cb24-102"></a></span>
<span id="cb24-103"><a href="#cb24-103"></a>    <span class="co"># getting rid of factors and making them into strings</span></span>
<span id="cb24-104"><a href="#cb24-104"></a>    factor.columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(d.headers, is.factor)</span>
<span id="cb24-105"><a href="#cb24-105"></a>    d.headers[factor.columns] <span class="ot">&lt;-</span></span>
<span id="cb24-106"><a href="#cb24-106"></a>      <span class="fu">sapply</span>(d[factor.columns], as.character)</span>
<span id="cb24-107"><a href="#cb24-107"></a></span>
<span id="cb24-108"><a href="#cb24-108"></a>    <span class="co"># making uSeed numeric</span></span>
<span id="cb24-109"><a href="#cb24-109"></a>    d.headers<span class="sc">$</span>uSeed <span class="ot">&lt;-</span> d.headers<span class="sc">$</span>uSeed <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb24-110"><a href="#cb24-110"></a></span>
<span id="cb24-111"><a href="#cb24-111"></a>    <span class="co"># Save the references dataframe to a file, if desired</span></span>
<span id="cb24-112"><a href="#cb24-112"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(save.refs.filename)){</span>
<span id="cb24-113"><a href="#cb24-113"></a>      <span class="fu">saveRDS</span>(d.headers,</span>
<span id="cb24-114"><a href="#cb24-114"></a>              <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(save.directory, <span class="fu">paste0</span>(save.refs.filename,</span>
<span id="cb24-115"><a href="#cb24-115"></a>                                                       <span class="st">".rds"</span>))</span>
<span id="cb24-116"><a href="#cb24-116"></a>      )</span>
<span id="cb24-117"><a href="#cb24-117"></a>      <span class="fu">write.csv</span>(d.headers,</span>
<span id="cb24-118"><a href="#cb24-118"></a>                <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(save.directory, <span class="fu">paste0</span>(save.refs.filename,</span>
<span id="cb24-119"><a href="#cb24-119"></a>                                                         <span class="st">".csv"</span>)),</span>
<span id="cb24-120"><a href="#cb24-120"></a>                <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-121"><a href="#cb24-121"></a>    }</span>
<span id="cb24-122"><a href="#cb24-122"></a></span>
<span id="cb24-123"><a href="#cb24-123"></a>    <span class="co"># return the reference dataframe</span></span>
<span id="cb24-124"><a href="#cb24-124"></a>    <span class="fu">return</span>(d.headers)</span>
<span id="cb24-125"><a href="#cb24-125"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><u><strong><em>Note that</em></strong></u> initially, we started by having two values for the length of the time series (<span class="math inline">\(T = 30\)</span> corresponding to one month of measurements, and <span class="math inline">\(T = 100\)</span> for a reasonably long time series) and one sample size (<span class="math inline">\(N = 100\)</span>, and subsample the datasets for <span class="math inline">\(N = 25\)</span> and <span class="math inline">\(N = 50\)</span>), and we decided to include five DGMs in the simulations: the AR(1), <span class="math inline">\(\chi^2\)</span>AR(1), BinAR(1), PoDAR(1) models, and a DAR(1) model with binomial marginal distribution). Eventually (and midway through the simulations), we decided to omit the <span class="math inline">\(T = 30\)</span> condition and the DAR(1) model from our simulation. However, as omitting these would have led to change in the calculations of <code>uSeed</code>, we decided to keep it the simulation reference table intact and omit <code>Model == "DAR"</code> and <code>T == 30</code> later on (see <a href="#sec-pipeline-code">Section&nbsp;2.3</a> for details).</p>
<p><u><strong><em>Further note that</em></strong></u> we only generated datasets with <span class="math inline">\(N = 100\)</span> and <span class="math inline">\(T = 100\)</span>, and sub-sampled other sample sizes and time series lengths (<span class="math inline">\(N = 25, 50\)</span> and <span class="math inline">\(T = 25, 50\)</span>) from them. Although this had computational benefits (less simulation time, and less storage required), the main motivation behind this decision was to be able to mimic empirical data collection: Sub-sampling the large datasets would be equated with collecting less data than the ideal case in which we have many participants with many measurements (so sub-sampling what <em>could have been</em> collected). Furthermore, comparing the datasets with the same DGM and level-2 distribution would be more meaningful: All datasets with same <code>Rep</code> value within the same DGM (say, PoDAR(1) model) and with the same level-2 distribution (say, <span class="math inline">\(\chi^2\)</span> distribution) have the same <code>uSeed</code>, thus they can be matched. Consequently, the differences we observe for different <span class="math inline">\(N\)</span>s and <span class="math inline">\(T\)</span>s within each cell of the figures reported in the paper can mimic the effect of “non-ideal” sampling.</p>
<p>Changing the conditions (omitting <code>Model == "DAR"</code> and <code>T == 30</code> from the simulation reference dataset, and adding additional conditions for <code>N</code> and <code>T</code>) is done when running the pipeline (see <a href="#sec-pipeline-code">Section&nbsp;2.3</a>) and the sub-sampling is implemented when running the analysis in <code>do_fit_doFuture</code> (see <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>).</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Another dataframe was generated to include the references of analyses results per simulation condition and analysis condition (or <em>hyperparameter</em>s), and file names and directory of individual <code>.rds</code> analysis outputs. The hyperparameters included the analysis type (with fixed vs.&nbsp;random residual variance) and the number of iterations and thinning in the MCMC algorithm, which were then used as arguments of <code>run_MplusAutomation</code>.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-29_71d8129fe649cdff3a41db78307d6870">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>make_fit_refs <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="cf">function</span>(sim_refs,</span>
<span id="cb25-3"><a href="#cb25-3"></a>           <span class="at">hyperparameters =</span> <span class="fu">list</span>(<span class="at">iter =</span> <span class="fu">c</span>(<span class="dv">2000</span>),</span>
<span id="cb25-4"><a href="#cb25-4"></a>                                  <span class="at">thin =</span> <span class="fu">c</span>(<span class="dv">5</span>),</span>
<span id="cb25-5"><a href="#cb25-5"></a>                                  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"resid.random"</span>,</span>
<span id="cb25-6"><a href="#cb25-6"></a>                                           <span class="st">"resid.fixed"</span>)),</span>
<span id="cb25-7"><a href="#cb25-7"></a>           <span class="at">save.directory =</span> <span class="st">"self-sim"</span>,</span>
<span id="cb25-8"><a href="#cb25-8"></a>           <span class="at">save.refs.filename =</span> <span class="fu">paste</span>(<span class="st">"fit_refs"</span>,</span>
<span id="cb25-9"><a href="#cb25-9"></a>                                      <span class="fu">Sys.Date</span>()),</span>
<span id="cb25-10"><a href="#cb25-10"></a>           <span class="at">prefix.fit.datasets =</span> <span class="st">"fit_"</span>){</span>
<span id="cb25-11"><a href="#cb25-11"></a></span>
<span id="cb25-12"><a href="#cb25-12"></a>    <span class="fu">dir.create</span>(save.directory, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-13"><a href="#cb25-13"></a></span>
<span id="cb25-14"><a href="#cb25-14"></a>    h <span class="ot">&lt;-</span> hyperparameters <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>      <span class="fu">expand.grid</span>(<span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-16"><a href="#cb25-16"></a></span>
<span id="cb25-17"><a href="#cb25-17"></a>    dd <span class="ot">&lt;-</span> sim_refs[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sim_refs), <span class="at">times =</span> <span class="fu">nrow</span>(h)),]</span>
<span id="cb25-18"><a href="#cb25-18"></a>    <span class="fu">rownames</span>(dd) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>    hh <span class="ot">&lt;-</span> h[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(h), <span class="at">each =</span> <span class="fu">nrow</span>(sim_refs)),]</span>
<span id="cb25-20"><a href="#cb25-20"></a>    <span class="fu">rownames</span>(hh) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb25-21"><a href="#cb25-21"></a></span>
<span id="cb25-22"><a href="#cb25-22"></a>    d <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dd,hh)</span>
<span id="cb25-23"><a href="#cb25-23"></a>    d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb25-24"><a href="#cb25-24"></a>      <span class="fu">mutate</span>(<span class="at">fit.Path =</span> save.directory,</span>
<span id="cb25-25"><a href="#cb25-25"></a>             <span class="at">fit.File =</span> <span class="cn">NA</span></span>
<span id="cb25-26"><a href="#cb25-26"></a>      )</span>
<span id="cb25-27"><a href="#cb25-27"></a></span>
<span id="cb25-28"><a href="#cb25-28"></a>    only.headers <span class="ot">&lt;-</span> <span class="fu">names</span>(hyperparameters) <span class="sc">%&gt;%</span></span>
<span id="cb25-29"><a href="#cb25-29"></a>      <span class="fu">c</span>(<span class="st">"uSeed"</span>,</span>
<span id="cb25-30"><a href="#cb25-30"></a>        <span class="st">"N"</span>,</span>
<span id="cb25-31"><a href="#cb25-31"></a>        <span class="st">"T"</span>,</span>
<span id="cb25-32"><a href="#cb25-32"></a>        .,</span>
<span id="cb25-33"><a href="#cb25-33"></a>        <span class="st">"Rep"</span>)</span>
<span id="cb25-34"><a href="#cb25-34"></a>    only.headers <span class="ot">&lt;-</span> only.headers[<span class="sc">!</span>(only.headers <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"iter"</span>, <span class="st">"thin"</span>))]</span>
<span id="cb25-35"><a href="#cb25-35"></a></span>
<span id="cb25-36"><a href="#cb25-36"></a>    <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d)) {</span>
<span id="cb25-37"><a href="#cb25-37"></a>      r.values <span class="ot">&lt;-</span>d[r, only.headers]</span>
<span id="cb25-38"><a href="#cb25-38"></a>      factor.columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(r.values, is.factor)</span>
<span id="cb25-39"><a href="#cb25-39"></a>      r.values[factor.columns] <span class="ot">&lt;-</span></span>
<span id="cb25-40"><a href="#cb25-40"></a>        <span class="fu">sapply</span>(r.values[factor.columns], as.character)</span>
<span id="cb25-41"><a href="#cb25-41"></a>      d[r, <span class="st">"fit.File"</span>] <span class="ot">&lt;-</span> only.headers <span class="sc">%&gt;%</span></span>
<span id="cb25-42"><a href="#cb25-42"></a>        <span class="fu">paste0</span>(<span class="st">"-"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-43"><a href="#cb25-43"></a>        <span class="fu">paste0</span>(r.values) <span class="sc">%&gt;%</span></span>
<span id="cb25-44"><a href="#cb25-44"></a>        <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-45"><a href="#cb25-45"></a>        <span class="fu">paste0</span>(<span class="st">".rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-46"><a href="#cb25-46"></a>        <span class="fu">paste0</span>(prefix.fit.datasets, .) <span class="co"># prefix for fitted datasets</span></span>
<span id="cb25-47"><a href="#cb25-47"></a>      <span class="fu">print</span>(r)</span>
<span id="cb25-48"><a href="#cb25-48"></a>    }</span>
<span id="cb25-49"><a href="#cb25-49"></a></span>
<span id="cb25-50"><a href="#cb25-50"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(save.refs.filename)){</span>
<span id="cb25-51"><a href="#cb25-51"></a>      <span class="fu">saveRDS</span>(d,</span>
<span id="cb25-52"><a href="#cb25-52"></a>              <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(save.directory,</span>
<span id="cb25-53"><a href="#cb25-53"></a>                                <span class="fu">paste0</span>(save.refs.filename,</span>
<span id="cb25-54"><a href="#cb25-54"></a>                                       <span class="st">".rds"</span>))</span>
<span id="cb25-55"><a href="#cb25-55"></a>      )</span>
<span id="cb25-56"><a href="#cb25-56"></a>      <span class="fu">write.csv</span>(d,</span>
<span id="cb25-57"><a href="#cb25-57"></a>                <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(save.directory,</span>
<span id="cb25-58"><a href="#cb25-58"></a>                                  <span class="fu">paste0</span>(save.refs.filename,</span>
<span id="cb25-59"><a href="#cb25-59"></a>                                         <span class="st">".csv"</span>)),</span>
<span id="cb25-60"><a href="#cb25-60"></a>                <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-61"><a href="#cb25-61"></a>    }</span>
<span id="cb25-62"><a href="#cb25-62"></a></span>
<span id="cb25-63"><a href="#cb25-63"></a>    <span class="fu">return</span>(d)</span>
<span id="cb25-64"><a href="#cb25-64"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-pipeline-functions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-pipeline-functions"><span class="header-section-number">2.2</span> Pipeline functions</h2>
<p>We implemented the components described in <a href="#sec-components">Section&nbsp;1</a> using the following functions.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Simulation in parallel</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Analysis in parallel</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Harvesting in parallel</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>The function <code>do_sim_parallel</code> is a wrapper around <code>make_datasets</code> (see <a href="#sec-dataset-generation">Section&nbsp;1.1.3</a>) and uses the <code>clusterApplyLB</code> function from the package <code>snow</code> <span class="citation" data-cites="tierney_2021_SnowSimpleNetwork">(<a href="#ref-tierney_2021_SnowSimpleNetwork" role="doc-biblioref">Tierney et al. 2021</a>)</span> for parallelization. This wrapper gets the dataframe of simulation file references (<code>sim_refs</code>, which is the output of <code>make_sim_refs</code>), and for each of its rows, simulates an <span class="math inline">\(N \times T\)</span> dataframe and stores it with other information in the same row—and also additional info about the time the simulating the dataset started and ended—in a list, and saves each list as a separate <code>.rds</code> file in the target folder (specified with <code>sim.Path</code>). Having the additional data in the saved files allow using them independent from the table of references. Note that to prevent the overload of the hard drive with many parallel write requests (to save the simulated datasets), for the first <code>nClust</code> rounds, using the <code>Sys.sleep</code> function, the data generation is started after a varying amount of delay. Given that every dataset simulation in the first round may take different amount of times, after the first round is complete, the simulations on different cores fall out of sync and there is no more need for adding delays for the next rounds.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Addendum: Version 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <code>v2</code>, <code>make_dataset</code> returns a list. Note that <code>do_sim_parallel</code> also saves the vectors of means and <span class="math inline">\(\phi\)</span>s in the saved simulation file as <code>$given.Means</code> and <code>$given.Phis</code>.</p>
</div>
</div>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-30_07edbcf88a3cfd154d83ef6311ba19f0">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>do_sim_parallel <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="cf">function</span>(sim_refs,</span>
<span id="cb26-3"><a href="#cb26-3"></a>           <span class="at">nClust =</span> <span class="dv">48</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>           <span class="at">save.directory =</span> <span class="st">"self-sim"</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>           <span class="at">alternative.sim.Path =</span> <span class="cn">NULL</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>           <span class="at">clusterLOG.filename =</span> <span class="fu">paste0</span>(<span class="st">"sim_clusterLOG_"</span>,</span>
<span id="cb26-7"><a href="#cb26-7"></a>                                        <span class="fu">Sys.Date</span>(),</span>
<span id="cb26-8"><a href="#cb26-8"></a>                                        <span class="st">".txt"</span>),</span>
<span id="cb26-9"><a href="#cb26-9"></a>           <span class="at">sleeptime =</span> <span class="dv">1</span>) {</span>
<span id="cb26-10"><a href="#cb26-10"></a>    cl <span class="ot">&lt;-</span> snow<span class="sc">::</span><span class="fu">makeSOCKcluster</span>(nClust,</span>
<span id="cb26-11"><a href="#cb26-11"></a>                                <span class="at">outfile =</span> here<span class="sc">::</span><span class="fu">here</span>(save.directory,</span>
<span id="cb26-12"><a href="#cb26-12"></a>                                                     clusterLOG.filename))</span>
<span id="cb26-13"><a href="#cb26-13"></a>    debug <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb26-14"><a href="#cb26-14"></a></span>
<span id="cb26-15"><a href="#cb26-15"></a>    d <span class="ot">&lt;-</span> sim_refs</span>
<span id="cb26-16"><a href="#cb26-16"></a></span>
<span id="cb26-17"><a href="#cb26-17"></a>    <span class="do">## Start clusters:</span></span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-19"><a href="#cb26-19"></a>    snow<span class="sc">::</span><span class="fu">clusterExport</span>(cl,</span>
<span id="cb26-20"><a href="#cb26-20"></a>                        <span class="fu">c</span>(<span class="st">"d"</span>,</span>
<span id="cb26-21"><a href="#cb26-21"></a>                          <span class="st">"alternative.sim.Path"</span>,</span>
<span id="cb26-22"><a href="#cb26-22"></a>                          <span class="st">"debug"</span>),</span>
<span id="cb26-23"><a href="#cb26-23"></a>                        <span class="at">envir =</span> <span class="fu">environment</span>())</span>
<span id="cb26-24"><a href="#cb26-24"></a></span>
<span id="cb26-25"><a href="#cb26-25"></a>    <span class="do">## Get the timings</span></span>
<span id="cb26-26"><a href="#cb26-26"></a></span>
<span id="cb26-27"><a href="#cb26-27"></a>    t.snow <span class="ot">&lt;-</span> snow<span class="sc">::</span><span class="fu">snow.time</span>({</span>
<span id="cb26-28"><a href="#cb26-28"></a>      <span class="do">## Run the cluster</span></span>
<span id="cb26-29"><a href="#cb26-29"></a>      snow<span class="sc">::</span><span class="fu">clusterApplyLB</span>(<span class="at">cl =</span> cl,</span>
<span id="cb26-30"><a href="#cb26-30"></a>                           <span class="fu">seq_len</span>(<span class="fu">nrow</span>(d)),</span>
<span id="cb26-31"><a href="#cb26-31"></a>                           <span class="cf">function</span>(i) {</span>
<span id="cb26-32"><a href="#cb26-32"></a>                             <span class="cf">if</span> (i <span class="sc">&lt;=</span> nClust)</span>
<span id="cb26-33"><a href="#cb26-33"></a>                               <span class="fu">Sys.sleep</span>(sleeptime <span class="sc">*</span> i)</span>
<span id="cb26-34"><a href="#cb26-34"></a></span>
<span id="cb26-35"><a href="#cb26-35"></a>                             d_i <span class="ot">&lt;-</span> <span class="fu">as.list</span>(d[i,])</span>
<span id="cb26-36"><a href="#cb26-36"></a>                             arguments <span class="ot">&lt;-</span></span>
<span id="cb26-37"><a href="#cb26-37"></a>                               <span class="fu">as.list</span>(d_i[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">length</span>(d_i) <span class="sc">-</span> <span class="dv">4</span>)])</span>
<span id="cb26-38"><a href="#cb26-38"></a>                             arguments<span class="sc">$</span>seed <span class="ot">&lt;-</span> d_i<span class="sc">$</span>uSeed</span>
<span id="cb26-39"><a href="#cb26-39"></a></span>
<span id="cb26-40"><a href="#cb26-40"></a>                             sim.Path <span class="ot">&lt;-</span></span>
<span id="cb26-41"><a href="#cb26-41"></a>                               <span class="fu">ifelse</span>(<span class="fu">is.null</span>(alternative.sim.Path),</span>
<span id="cb26-42"><a href="#cb26-42"></a>                                      d_i<span class="sc">$</span>sim.Path,</span>
<span id="cb26-43"><a href="#cb26-43"></a>                                      alternative.sim.Path)</span>
<span id="cb26-44"><a href="#cb26-44"></a></span>
<span id="cb26-45"><a href="#cb26-45"></a>                             sim.StartTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb26-46"><a href="#cb26-46"></a></span>
<span id="cb26-47"><a href="#cb26-47"></a>                             output_make_datasets <span class="ot">&lt;-</span></span>
<span id="cb26-48"><a href="#cb26-48"></a>                               <span class="fu">do.call</span>(make_datasets,</span>
<span id="cb26-49"><a href="#cb26-49"></a>                                       arguments)</span>
<span id="cb26-50"><a href="#cb26-50"></a></span>
<span id="cb26-51"><a href="#cb26-51"></a>                             <span class="cf">if</span>(<span class="fu">is.data.frame</span>(output_make_datasets)){</span>
<span id="cb26-52"><a href="#cb26-52"></a>                               d_i<span class="sc">$</span>sim.Dataset <span class="ot">&lt;-</span> output_make_datasets</span>
<span id="cb26-53"><a href="#cb26-53"></a>                             }<span class="cf">else</span>{</span>
<span id="cb26-54"><a href="#cb26-54"></a>                               <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb26-55"><a href="#cb26-55"></a>                               d_i<span class="sc">$</span>sim.Dataset <span class="ot">&lt;-</span> output_make_datasets<span class="sc">$</span>dataset</span>
<span id="cb26-56"><a href="#cb26-56"></a>                               d_i<span class="sc">$</span>given.Means <span class="ot">&lt;-</span> output_make_datasets<span class="sc">$</span>Means</span>
<span id="cb26-57"><a href="#cb26-57"></a>                               d_i<span class="sc">$</span>given.Phis <span class="ot">&lt;-</span> output_make_datasets<span class="sc">$</span>Phis</span>
<span id="cb26-58"><a href="#cb26-58"></a>                               }</span>
<span id="cb26-59"><a href="#cb26-59"></a>                             d_i<span class="sc">$</span>sim.StartTime <span class="ot">&lt;-</span> sim.StartTime</span>
<span id="cb26-60"><a href="#cb26-60"></a>                             d_i<span class="sc">$</span>sim.EndTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb26-61"><a href="#cb26-61"></a>                             d_i<span class="sc">$</span>sim.ElapsedTime <span class="ot">&lt;-</span></span>
<span id="cb26-62"><a href="#cb26-62"></a>                               d_i<span class="sc">$</span>sim.EndTime <span class="sc">-</span> d_i<span class="sc">$</span>sim.StartTime</span>
<span id="cb26-63"><a href="#cb26-63"></a></span>
<span id="cb26-64"><a href="#cb26-64"></a>                             <span class="fu">saveRDS</span>(d_i,</span>
<span id="cb26-65"><a href="#cb26-65"></a>                                     <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(sim.Path,</span>
<span id="cb26-66"><a href="#cb26-66"></a>                                                       d_i<span class="sc">$</span>sim.File))</span>
<span id="cb26-67"><a href="#cb26-67"></a></span>
<span id="cb26-68"><a href="#cb26-68"></a>                           })</span>
<span id="cb26-69"><a href="#cb26-69"></a></span>
<span id="cb26-70"><a href="#cb26-70"></a>    })</span>
<span id="cb26-71"><a href="#cb26-71"></a></span>
<span id="cb26-72"><a href="#cb26-72"></a>    <span class="do">## Stop the cluster:</span></span>
<span id="cb26-73"><a href="#cb26-73"></a>    snow<span class="sc">::</span><span class="fu">stopCluster</span>(cl)</span>
<span id="cb26-74"><a href="#cb26-74"></a></span>
<span id="cb26-75"><a href="#cb26-75"></a>    <span class="fu">return</span>(t.snow)</span>
<span id="cb26-76"><a href="#cb26-76"></a></span>
<span id="cb26-77"><a href="#cb26-77"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>The function <code>do_fit_doFuture</code> is a wrapper around <code>run_MplusAutomation</code> (see <a href="#sec-analysis-component">Section&nbsp;1.2</a>) and uses the package <code>doFuture</code> <span class="citation" data-cites="bengtsson_2021_UnifyingFrameworkParallel">(<a href="#ref-bengtsson_2021_UnifyingFrameworkParallel" role="doc-biblioref">Bengtsson 2020</a>)</span> as a parallelization backend to <code>plyr::a_ply</code>. The function gets a dataframe containing references of analyses results (<code>fit_refs</code>, which is the output of <code>make_fit_refs</code>), and row by row reads the simulated datasets, sub-samples the data if <span class="math inline">\(N &lt; 100\)</span> or <span class="math inline">\(T &lt; 100\)</span> (see the second note under <code>make_sim_refs</code> in <a href="#sec-bookkeeping">Section&nbsp;2.1</a>) and runs the analysis based on the hyperparameters specified in <code>fit_refs</code>. It then saves the outcome of the analysis (the <em>M</em>plus model object produced by <code>MplusAutomation::mplusModeler</code> and returned by <code>run_MplusAutomation</code>), which includes <em>M</em>plus outputs and parameter estimates) with additional information (other values in the same row of <code>fit_refs</code> as well as timings) in separate <code>.rds</code> files in the target folder. Note that, again, to prevent the overload of the hard drive with many parallel read and write requests (to read the simulated datasets and save the <em>M</em>plus outputs), for the first <code>nClust</code> rounds, using the <code>Sys.sleep</code> function, the data analysis is started after a varying amount of delay. Given that every analysis instance in the first round take different amount of times, after the first round is complete the analyses on cores fall out of sync and there is no more need for adding delays for the next rounds.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Addendum: Version 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <code>v2</code>, the <code>given.Means</code> and <code>given.Phis</code> of the <span class="math inline">\(N\)</span> subjects included in the analysis, as well as the sample summary statistics of the sub-sampled dataset (<code>sample.Means</code>, <code>sample.Variances</code>, and <code>sample.Skewnesses</code>) are also saved in the fit object.</p>
</div>
</div>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-31_84f4a35279c08470cecfca5961e6998c">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>do_fit_doFuture <span class="ot">&lt;-</span> <span class="cf">function</span>(fit_refs,</span>
<span id="cb27-2"><a href="#cb27-2"></a>                            <span class="at">nClust =</span> <span class="dv">48</span>,</span>
<span id="cb27-3"><a href="#cb27-3"></a>                            <span class="at">nPROC =</span> <span class="dv">1</span>,</span>
<span id="cb27-4"><a href="#cb27-4"></a>                            <span class="at">save.directory =</span> <span class="st">"self-sim"</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>                            <span class="at">alternative.fit.Path =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>                            <span class="co"># model_what = "resid.random",</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>                            <span class="at">clusterLOG.filename =</span> <span class="fu">paste0</span>(<span class="st">"fit_clusterLOG_"</span>,</span>
<span id="cb27-8"><a href="#cb27-8"></a>                                                         <span class="fu">Sys.Date</span>(),</span>
<span id="cb27-9"><a href="#cb27-9"></a>                                                         <span class="st">".txt"</span>),</span>
<span id="cb27-10"><a href="#cb27-10"></a>                            <span class="at">sleeptime =</span> <span class="dv">1</span>,</span>
<span id="cb27-11"><a href="#cb27-11"></a>                            <span class="at">version =</span> <span class="st">"v2"</span>) {</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="do">## To make sure the required functions are loaded on each cluster</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>,</span>
<span id="cb27-16"><a href="#cb27-16"></a>                    <span class="st">"analysis-component.R"</span>))</span>
<span id="cb27-17"><a href="#cb27-17"></a></span>
<span id="cb27-18"><a href="#cb27-18"></a></span>
<span id="cb27-19"><a href="#cb27-19"></a></span>
<span id="cb27-20"><a href="#cb27-20"></a></span>
<span id="cb27-21"><a href="#cb27-21"></a>  debug <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb27-22"><a href="#cb27-22"></a></span>
<span id="cb27-23"><a href="#cb27-23"></a>  d <span class="ot">&lt;-</span> fit_refs</span>
<span id="cb27-24"><a href="#cb27-24"></a></span>
<span id="cb27-25"><a href="#cb27-25"></a>  <span class="fu">registerDoFuture</span>()</span>
<span id="cb27-26"><a href="#cb27-26"></a></span>
<span id="cb27-27"><a href="#cb27-27"></a>  <span class="fu">plan</span>(<span class="st">"multisession"</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a></span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a>  plyr<span class="sc">::</span><span class="fu">a_ply</span>(d,</span>
<span id="cb27-31"><a href="#cb27-31"></a>              <span class="dv">1</span>,</span>
<span id="cb27-32"><a href="#cb27-32"></a>              <span class="cf">function</span>(d_i) {</span>
<span id="cb27-33"><a href="#cb27-33"></a>                <span class="cf">if</span> (i <span class="sc">&lt;=</span> nClust)</span>
<span id="cb27-34"><a href="#cb27-34"></a>                  <span class="fu">Sys.sleep</span>(sleeptime <span class="sc">*</span> i)</span>
<span id="cb27-35"><a href="#cb27-35"></a></span>
<span id="cb27-36"><a href="#cb27-36"></a>                d_i <span class="ot">&lt;-</span> <span class="fu">as.list</span>(d_i)</span>
<span id="cb27-37"><a href="#cb27-37"></a></span>
<span id="cb27-38"><a href="#cb27-38"></a>                fit.StartTime <span class="ot">&lt;-</span></span>
<span id="cb27-39"><a href="#cb27-39"></a>                  <span class="fu">Sys.time</span>()</span>
<span id="cb27-40"><a href="#cb27-40"></a></span>
<span id="cb27-41"><a href="#cb27-41"></a>                sim.file <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(d_i<span class="sc">$</span>sim.Path,</span>
<span id="cb27-42"><a href="#cb27-42"></a>                                            d_i<span class="sc">$</span>sim.File))</span>
<span id="cb27-43"><a href="#cb27-43"></a></span>
<span id="cb27-44"><a href="#cb27-44"></a>                df <span class="ot">&lt;-</span> sim.file<span class="sc">$</span>sim.Dataset <span class="sc">%&gt;%</span></span>
<span id="cb27-45"><a href="#cb27-45"></a>                  <span class="fu">filter</span>(subject <span class="sc">&lt;=</span> d_i<span class="sc">$</span>N,</span>
<span id="cb27-46"><a href="#cb27-46"></a>                         t <span class="sc">&lt;=</span> d_i<span class="sc">$</span>T)</span>
<span id="cb27-47"><a href="#cb27-47"></a></span>
<span id="cb27-48"><a href="#cb27-48"></a>                <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb27-49"><a href="#cb27-49"></a>                df_sum <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb27-50"><a href="#cb27-50"></a>                  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb27-51"><a href="#cb27-51"></a>                  <span class="fu">summarise</span>(<span class="at">sample.Means =</span> <span class="fu">mean</span>(x),</span>
<span id="cb27-52"><a href="#cb27-52"></a>                            <span class="at">sample.Variances =</span> <span class="fu">var</span>(x),</span>
<span id="cb27-53"><a href="#cb27-53"></a>                            <span class="at">sample.Skewnesses =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x))</span>
<span id="cb27-54"><a href="#cb27-54"></a></span>
<span id="cb27-55"><a href="#cb27-55"></a>                file.name <span class="ot">&lt;-</span></span>
<span id="cb27-56"><a href="#cb27-56"></a>                  <span class="fu">gsub</span>(<span class="st">".rds"</span>, <span class="st">""</span>, d_i<span class="sc">$</span>fit.File)</span>
<span id="cb27-57"><a href="#cb27-57"></a></span>
<span id="cb27-58"><a href="#cb27-58"></a>                <span class="fu">print</span>(<span class="fu">paste</span>(file.name,</span>
<span id="cb27-59"><a href="#cb27-59"></a>                            <span class="st">"started at"</span>,</span>
<span id="cb27-60"><a href="#cb27-60"></a>                            fit.StartTime))</span>
<span id="cb27-61"><a href="#cb27-61"></a></span>
<span id="cb27-62"><a href="#cb27-62"></a>                tryRes <span class="ot">&lt;-</span></span>
<span id="cb27-63"><a href="#cb27-63"></a>                  <span class="fu">try</span>(output.fit <span class="ot">&lt;-</span></span>
<span id="cb27-64"><a href="#cb27-64"></a>                        <span class="fu">run_MplusAutomation</span>(</span>
<span id="cb27-65"><a href="#cb27-65"></a>                          <span class="at">df =</span> df,</span>
<span id="cb27-66"><a href="#cb27-66"></a>                          <span class="at">PROCESSORS =</span> nPROC,</span>
<span id="cb27-67"><a href="#cb27-67"></a>                          <span class="at">BITERATIONS.min =</span> d_i<span class="sc">$</span>iter,</span>
<span id="cb27-68"><a href="#cb27-68"></a>                          <span class="at">THIN =</span> d_i<span class="sc">$</span>thin,</span>
<span id="cb27-69"><a href="#cb27-69"></a>                          <span class="at">model_what =</span> d_i<span class="sc">$</span>type,</span>
<span id="cb27-70"><a href="#cb27-70"></a>                          <span class="at">file.name =</span> file.name</span>
<span id="cb27-71"><a href="#cb27-71"></a>                        ))</span>
<span id="cb27-72"><a href="#cb27-72"></a></span>
<span id="cb27-73"><a href="#cb27-73"></a>                d_i<span class="sc">$</span>fit.Dataset <span class="ot">&lt;-</span></span>
<span id="cb27-74"><a href="#cb27-74"></a>                  tryRes</span>
<span id="cb27-75"><a href="#cb27-75"></a></span>
<span id="cb27-76"><a href="#cb27-76"></a>                <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb27-77"><a href="#cb27-77"></a>                d_i<span class="sc">$</span>given.Means <span class="ot">&lt;-</span> sim.file<span class="sc">$</span>Means <span class="sc">%&gt;%</span> <span class="fu">head</span>(d_i<span class="sc">$</span>N)</span>
<span id="cb27-78"><a href="#cb27-78"></a>                d_i<span class="sc">$</span>given.Phis <span class="ot">&lt;-</span> sim.file<span class="sc">$</span>Phis <span class="sc">%&gt;%</span> <span class="fu">head</span>(d_i<span class="sc">$</span>N)</span>
<span id="cb27-79"><a href="#cb27-79"></a></span>
<span id="cb27-80"><a href="#cb27-80"></a>                <span class="co"># Adapting for v2 implementation</span></span>
<span id="cb27-81"><a href="#cb27-81"></a>                d_i<span class="sc">$</span>sample.Means <span class="ot">&lt;-</span> df_sum<span class="sc">$</span>sample.Means</span>
<span id="cb27-82"><a href="#cb27-82"></a>                d_i<span class="sc">$</span>sample.Variances <span class="ot">&lt;-</span> df_sum<span class="sc">$</span>sample.Variances</span>
<span id="cb27-83"><a href="#cb27-83"></a>                d_i<span class="sc">$</span>sample.Skewnesses <span class="ot">&lt;-</span> df_sum<span class="sc">$</span>sample.Skewnesses</span>
<span id="cb27-84"><a href="#cb27-84"></a></span>
<span id="cb27-85"><a href="#cb27-85"></a>                d_i<span class="sc">$</span>fit.StartTime <span class="ot">&lt;-</span></span>
<span id="cb27-86"><a href="#cb27-86"></a>                  fit.StartTime</span>
<span id="cb27-87"><a href="#cb27-87"></a>                d_i<span class="sc">$</span>fit.EndTime <span class="ot">&lt;-</span></span>
<span id="cb27-88"><a href="#cb27-88"></a>                  <span class="fu">Sys.time</span>()</span>
<span id="cb27-89"><a href="#cb27-89"></a>                d_i<span class="sc">$</span>fit.ElapsedTime <span class="ot">&lt;-</span></span>
<span id="cb27-90"><a href="#cb27-90"></a>                  d_i<span class="sc">$</span>fit.EndTime <span class="sc">-</span> d_i<span class="sc">$</span>fit.StartTime</span>
<span id="cb27-91"><a href="#cb27-91"></a></span>
<span id="cb27-92"><a href="#cb27-92"></a>                fit.Path <span class="ot">&lt;-</span></span>
<span id="cb27-93"><a href="#cb27-93"></a>                  <span class="fu">ifelse</span>(<span class="fu">is.null</span>(alternative.fit.Path),</span>
<span id="cb27-94"><a href="#cb27-94"></a>                         d_i<span class="sc">$</span>fit.Path,</span>
<span id="cb27-95"><a href="#cb27-95"></a>                         alternative.fit.Path)</span>
<span id="cb27-96"><a href="#cb27-96"></a></span>
<span id="cb27-97"><a href="#cb27-97"></a>                <span class="fu">saveRDS</span>(d_i,</span>
<span id="cb27-98"><a href="#cb27-98"></a>                        <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(fit.Path,</span>
<span id="cb27-99"><a href="#cb27-99"></a>                                          d_i<span class="sc">$</span>fit.File))</span>
<span id="cb27-100"><a href="#cb27-100"></a></span>
<span id="cb27-101"><a href="#cb27-101"></a>                <span class="fu">print</span>(<span class="fu">paste</span>(file.name,</span>
<span id="cb27-102"><a href="#cb27-102"></a>                            <span class="st">"finished at"</span>,</span>
<span id="cb27-103"><a href="#cb27-103"></a>                            d_i<span class="sc">$</span>fit.EndTime))</span>
<span id="cb27-104"><a href="#cb27-104"></a>              },</span>
<span id="cb27-105"><a href="#cb27-105"></a>              <span class="at">.parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-106"><a href="#cb27-106"></a></span>
<span id="cb27-107"><a href="#cb27-107"></a></span>
<span id="cb27-108"><a href="#cb27-108"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>The function <code>do_harvest_doFuture</code> is a wrapper around <code>fit_extract</code> (see <a href="#sec-harvesting-component">Section&nbsp;1.3</a>) and uses the package <code>doFuture</code> as a parallelization backend to <code>foreach</code>. It gets a list of <code>.rds</code> files (that can be taken from or <code>fit_refs</code>, or by using <code>list.files</code> function in the directory in which the analysis results are saved) and returns a large dataframe including parameter estimates (and additional information) extracted by <code>fit_extract</code>. Again, like in <code>do_sim_parallel</code> and <code>do_fit_doFuture</code>, the first <code>nClust</code> files are read with varying amount of delay to prevent the overload of the hard drive by multiple read requests.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-32_92047b6200e976e1ccd3b935fe292e8d">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>do_harvest_doFuture <span class="ot">&lt;-</span> <span class="cf">function</span>(fit.files,</span>
<span id="cb28-2"><a href="#cb28-2"></a>                                <span class="at">nClust =</span> <span class="dv">48</span>,</span>
<span id="cb28-3"><a href="#cb28-3"></a>                                <span class="at">sleeptime =</span> <span class="dv">1</span>){</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">registerDoFuture</span>()</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="fu">plan</span>(<span class="st">"multisession"</span>)</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a>  results <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fit.files),</span>
<span id="cb28-10"><a href="#cb28-10"></a>                     <span class="at">.combine =</span> rbind,</span>
<span id="cb28-11"><a href="#cb28-11"></a>                     <span class="at">.errorhandling =</span> <span class="st">'remove'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb28-12"><a href="#cb28-12"></a>                       <span class="cf">if</span> (i <span class="sc">&lt;=</span> nClust)</span>
<span id="cb28-13"><a href="#cb28-13"></a>                         <span class="fu">Sys.sleep</span>(sleeptime <span class="sc">*</span> i)</span>
<span id="cb28-14"><a href="#cb28-14"></a>                       <span class="fu">fit_extract</span>(fit.files[i])</span>
<span id="cb28-15"><a href="#cb28-15"></a>                     }</span>
<span id="cb28-16"><a href="#cb28-16"></a>  <span class="fu">return</span>(results)</span>
<span id="cb28-17"><a href="#cb28-17"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-pipeline-code" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sec-pipeline-code"><span class="header-section-number">2.3</span> Pipeline code</h2>
<p>The following is the code we used to run the whole pipeline, which consists of three chunk that are responsible of the following:</p>
<ol type="1">
<li>Creating the book-keeping reference files (using functions described in <a href="#sec-bookkeeping">Section&nbsp;2.1</a>).</li>
<li>Running the whole simulation study (using <code>do_sim_parallel</code> and <code>do_fit_doFuture</code> described in <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>). The codes in this chunk can be interrupted (deliberately or otherwise) and resumed by running it again.</li>
<li>Harvesting the parameter estimates and storing them in a single dataframe (using <code>do_harvest_doFuture</code> of <a href="#sec-pipeline-functions">Section&nbsp;2.2</a>). The resulting dataframe is then used to make the plots using in <a href="#sec-simulation-results">Section&nbsp;3</a>)</li>
</ol>
<p>But first we need to set the directories in which the results of each chunk is saved:</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-33_46113ff85e27797969f47f2de51b5f06">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="do">## Root directory of simulation study files</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>dir_files <span class="ot">&lt;-</span> <span class="st">"simulation-files"</span></span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="do">## Where reference tables are saved</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>dir_references <span class="ot">&lt;-</span> <span class="fu">paste</span>(dir_files,</span>
<span id="cb29-6"><a href="#cb29-6"></a>                        <span class="st">"refs"</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>                        <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="do">## Where simulated datasets are saved</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>dir_simulation <span class="ot">&lt;-</span> <span class="fu">paste</span>(dir_files,</span>
<span id="cb29-11"><a href="#cb29-11"></a>                        <span class="st">"sim-files"</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>                        <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="do">## Where analysis output files are saved</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>dir_analysis <span class="ot">&lt;-</span> <span class="fu">paste</span>(dir_files,</span>
<span id="cb29-16"><a href="#cb29-16"></a>                      <span class="st">"fit-files"</span>,</span>
<span id="cb29-17"><a href="#cb29-17"></a>                      <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb29-18"><a href="#cb29-18"></a></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="do">## Where harvested study results are saved</span></span>
<span id="cb29-20"><a href="#cb29-20"></a>dir_harvest <span class="ot">&lt;-</span> <span class="fu">paste</span>(dir_files,</span>
<span id="cb29-21"><a href="#cb29-21"></a>                     <span class="st">"harvest-files"</span>,</span>
<span id="cb29-22"><a href="#cb29-22"></a>                     <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb29-23"><a href="#cb29-23"></a></span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="do">## where plots are saved</span></span>
<span id="cb29-25"><a href="#cb29-25"></a></span>
<span id="cb29-26"><a href="#cb29-26"></a>dir_plots <span class="ot">&lt;-</span> <span class="st">"figures"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Making references</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Running the study</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">Harvesting and cleaning the results</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>The following code makes <code>sim_refs</code> and <code>fit_refs</code> tables and make backups of them. In line 17 the rows with <code>T != 100</code> and <code>Model == "DAR"</code> are omitted, and with the codes in lines 22-31 we add other values of <span class="math inline">\(N\)</span>s and <span class="math inline">\(T\)</span>s (see the notes under <code>make_sim_refs</code> in <a href="#sec-bookkeeping">Section&nbsp;2.1</a>).</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-34_7c145554d219180153bc10b55ce91db2">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>sim_refs_base <span class="ot">&lt;-</span> <span class="fu">make_sim_refs</span>(</span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="at">conditions =</span> <span class="fu">list</span>(</span>
<span id="cb30-3"><a href="#cb30-3"></a>    <span class="at">T =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">100</span>),</span>
<span id="cb30-4"><a href="#cb30-4"></a>    <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">100</span>),</span>
<span id="cb30-5"><a href="#cb30-5"></a>    <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"BinAR"</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>              <span class="st">"Chi2AR"</span>,</span>
<span id="cb30-7"><a href="#cb30-7"></a>              <span class="st">"DAR"</span>,</span>
<span id="cb30-8"><a href="#cb30-8"></a>              <span class="st">"PoDAR"</span>,</span>
<span id="cb30-9"><a href="#cb30-9"></a>              <span class="st">"NAR"</span>),</span>
<span id="cb30-10"><a href="#cb30-10"></a>    <span class="at">l2.dist =</span> <span class="fu">c</span>(<span class="st">"Gaussian"</span>,</span>
<span id="cb30-11"><a href="#cb30-11"></a>                <span class="st">"Chi2"</span>),</span>
<span id="cb30-12"><a href="#cb30-12"></a>    <span class="at">phi =</span> <span class="fu">c</span>(<span class="fl">0.4</span>)</span>
<span id="cb30-13"><a href="#cb30-13"></a>  ),</span>
<span id="cb30-14"><a href="#cb30-14"></a>  <span class="at">simSeed =</span> <span class="dv">0</span>,</span>
<span id="cb30-15"><a href="#cb30-15"></a>  <span class="at">Reps =</span> <span class="dv">1000</span>,</span>
<span id="cb30-16"><a href="#cb30-16"></a>  <span class="at">save.directory =</span> dir_simulation</span>
<span id="cb30-17"><a href="#cb30-17"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>  <span class="fu">filter</span>(T <span class="sc">==</span> <span class="dv">100</span>, Model <span class="sc">!=</span> <span class="st">"DAR"</span>)</span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="do">## Adding another values for N and T; see the text</span></span>
<span id="cb30-21"><a href="#cb30-21"></a></span>
<span id="cb30-22"><a href="#cb30-22"></a>sim_refs <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb30-23"><a href="#cb30-23"></a></span>
<span id="cb30-24"><a href="#cb30-24"></a><span class="cf">for</span> (TT <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>)) {</span>
<span id="cb30-25"><a href="#cb30-25"></a>  <span class="cf">for</span> (NN <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>)) {</span>
<span id="cb30-26"><a href="#cb30-26"></a>    sim_refs <span class="ot">&lt;-</span> sim_refs_base <span class="sc">%&gt;%</span></span>
<span id="cb30-27"><a href="#cb30-27"></a>      <span class="fu">mutate</span>(<span class="at">N =</span> NN,</span>
<span id="cb30-28"><a href="#cb30-28"></a>             <span class="at">T =</span> TT) <span class="sc">%&gt;%</span></span>
<span id="cb30-29"><a href="#cb30-29"></a>      <span class="fu">rbind</span>(sim_refs)</span>
<span id="cb30-30"><a href="#cb30-30"></a>  }</span>
<span id="cb30-31"><a href="#cb30-31"></a>}</span>
<span id="cb30-32"><a href="#cb30-32"></a></span>
<span id="cb30-33"><a href="#cb30-33"></a><span class="do">## Saving a backup of the dataframe of references of simulation files</span></span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="fu">saveRDS</span>(sim_refs,</span>
<span id="cb30-36"><a href="#cb30-36"></a>        here<span class="sc">::</span><span class="fu">here</span>(dir_references,</span>
<span id="cb30-37"><a href="#cb30-37"></a>                   <span class="st">"sim-refs.rds"</span>))</span>
<span id="cb30-38"><a href="#cb30-38"></a></span>
<span id="cb30-39"><a href="#cb30-39"></a><span class="do">## Making the dataframe of analysis output reference files</span></span>
<span id="cb30-40"><a href="#cb30-40"></a></span>
<span id="cb30-41"><a href="#cb30-41"></a>fit_refs <span class="ot">&lt;-</span> <span class="fu">make_fit_refs</span>(<span class="at">sim_refs =</span> sim_refs,</span>
<span id="cb30-42"><a href="#cb30-42"></a>                          <span class="at">save.directory =</span> dir_analysis)</span>
<span id="cb30-43"><a href="#cb30-43"></a></span>
<span id="cb30-44"><a href="#cb30-44"></a></span>
<span id="cb30-45"><a href="#cb30-45"></a><span class="do">## Saving a backup of the dataframe of references of analysis output files</span></span>
<span id="cb30-46"><a href="#cb30-46"></a></span>
<span id="cb30-47"><a href="#cb30-47"></a><span class="fu">saveRDS</span>(fit_refs,</span>
<span id="cb30-48"><a href="#cb30-48"></a>        here<span class="sc">::</span><span class="fu">here</span>(dir_references,</span>
<span id="cb30-49"><a href="#cb30-49"></a>                   <span class="st">"fit-refs.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Here we reads the reference tables <code>sim_refs</code> and <code>fit_refs</code>. We then make a list of already simulated files (that are located in the <code>sim.Path</code> directory) and a list of analysis output files (that are located in the <code>fit.Path</code> directory). Then, by comparing <code>sim_refs</code> and <code>fit_refs</code> with the the lists of simulated and analyzed files, we only simulate/analyze the datasets that have not been yet simulated/analyzed. This allows us resume the simulation study after an interruption to the R session.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-35_5ae0c066d2773c414b557bc844293509">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Simulation part ---------------------------------------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="do">## Reading the backup of the dataframe of references of simulation files</span></span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a>sim_refs <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_references,</span>
<span id="cb31-6"><a href="#cb31-6"></a>                               <span class="st">"sim-refs.rds"</span>))</span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="do">## Making a list of already simulated datasets</span></span>
<span id="cb31-9"><a href="#cb31-9"></a></span>
<span id="cb31-10"><a href="#cb31-10"></a>sim_refs_done <span class="ot">&lt;-</span> <span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_simulation),</span>
<span id="cb31-11"><a href="#cb31-11"></a>                            <span class="at">pattern =</span> <span class="st">"sim_uSeed-"</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="do">## Finding the datasets that are yet to be simulated</span></span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a>sim_refs_remaining <span class="ot">&lt;-</span> sim_refs <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(sim.File <span class="sc">%in%</span> sim_refs_done))</span>
<span id="cb31-17"><a href="#cb31-17"></a></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="do">## Simulating the remaining datasets</span></span>
<span id="cb31-19"><a href="#cb31-19"></a></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="fu">Sys.time</span>()</span>
<span id="cb31-21"><a href="#cb31-21"></a><span class="fu">system.time</span>(</span>
<span id="cb31-22"><a href="#cb31-22"></a>  t.sim <span class="ot">&lt;-</span> <span class="fu">do_sim_parallel</span>(<span class="at">sim_refs =</span> sim_refs_remaining,</span>
<span id="cb31-23"><a href="#cb31-23"></a>                           <span class="at">save.directory =</span> dir_simulation)</span>
<span id="cb31-24"><a href="#cb31-24"></a>)</span>
<span id="cb31-25"><a href="#cb31-25"></a><span class="fu">Sys.time</span>()</span>
<span id="cb31-26"><a href="#cb31-26"></a></span>
<span id="cb31-27"><a href="#cb31-27"></a></span>
<span id="cb31-28"><a href="#cb31-28"></a><span class="co"># Analysis part -----------------------------------------------------------</span></span>
<span id="cb31-29"><a href="#cb31-29"></a></span>
<span id="cb31-30"><a href="#cb31-30"></a><span class="do">## Reading the backup of the dataframe of references of analysis output files</span></span>
<span id="cb31-31"><a href="#cb31-31"></a></span>
<span id="cb31-32"><a href="#cb31-32"></a>fit_refs <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_references,</span>
<span id="cb31-33"><a href="#cb31-33"></a>                               <span class="st">"fit-refs.rds"</span>))</span>
<span id="cb31-34"><a href="#cb31-34"></a></span>
<span id="cb31-35"><a href="#cb31-35"></a><span class="do">## Making a list of analysis output files</span></span>
<span id="cb31-36"><a href="#cb31-36"></a></span>
<span id="cb31-37"><a href="#cb31-37"></a>fit_files_done <span class="ot">&lt;-</span> <span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_simulation),</span>
<span id="cb31-38"><a href="#cb31-38"></a>                             <span class="at">pattern =</span> <span class="st">"fit_uSeed-"</span>)</span>
<span id="cb31-39"><a href="#cb31-39"></a></span>
<span id="cb31-40"><a href="#cb31-40"></a><span class="do">## Finding the analyses that are yet to be done</span></span>
<span id="cb31-41"><a href="#cb31-41"></a></span>
<span id="cb31-42"><a href="#cb31-42"></a>fit_refs_remaining <span class="ot">&lt;-</span> fit_refs <span class="sc">%&gt;%</span></span>
<span id="cb31-43"><a href="#cb31-43"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(fit.File <span class="sc">%in%</span> fit_files_done))</span>
<span id="cb31-44"><a href="#cb31-44"></a></span>
<span id="cb31-45"><a href="#cb31-45"></a><span class="do">## Running the analyses of remaining datasets in parallel</span></span>
<span id="cb31-46"><a href="#cb31-46"></a></span>
<span id="cb31-47"><a href="#cb31-47"></a><span class="fu">Sys.time</span>()</span>
<span id="cb31-48"><a href="#cb31-48"></a><span class="fu">system.time</span>(</span>
<span id="cb31-49"><a href="#cb31-49"></a>  t.fit <span class="ot">&lt;-</span> <span class="fu">do_fit_doFuture</span>(</span>
<span id="cb31-50"><a href="#cb31-50"></a>    <span class="at">fit_refs =</span> fit_refs_remaining,</span>
<span id="cb31-51"><a href="#cb31-51"></a>    <span class="at">nClust =</span> <span class="dv">48</span>,</span>
<span id="cb31-52"><a href="#cb31-52"></a>    <span class="at">nPROC =</span> <span class="dv">1</span>,</span>
<span id="cb31-53"><a href="#cb31-53"></a>    <span class="at">sleeptime =</span> <span class="dv">3</span>,</span>
<span id="cb31-54"><a href="#cb31-54"></a>    <span class="at">save.directory =</span> dir_analysis</span>
<span id="cb31-55"><a href="#cb31-55"></a>  )</span>
<span id="cb31-56"><a href="#cb31-56"></a>)</span>
<span id="cb31-57"><a href="#cb31-57"></a><span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Finally, the analyzed datasets are read using <code>do_harvest_doFuture</code> in parallel and stored in an <code>.rds</code> file suffixed with date and time (to prevent over-writing the previously saved harvest files). Furthermore, using the function <code>harvest_cleanup</code> (of <a href="#sec-report-clean-harvest">Section&nbsp;1.4.1</a>), an abridged version (<code>d_abridged</code>, including all results of all replications for the parameters of interest) and a more summarized version (<code>d_important</code>, containing the outcome measures of interest per condition) of the raw harvest dataframe are made and saved in two <code>.rds</code> files (again suffixed with date and time).</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-36_83826c77db428b9962731d3fdef15e11">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="do">## Harvesting the results in parallel</span></span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>l.files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="fu">here</span>(dir_analysis),</span>
<span id="cb32-4"><a href="#cb32-4"></a>                      <span class="at">pattern =</span> <span class="fu">glob2rx</span>(<span class="st">"*.rds"</span>))</span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a>fit.files <span class="ot">&lt;-</span> l.files <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">paste</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_analysis),</span>
<span id="cb32-9"><a href="#cb32-9"></a>        .,</span>
<span id="cb32-10"><a href="#cb32-10"></a>        <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb32-11"><a href="#cb32-11"></a></span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb32-14"><a href="#cb32-14"></a>           <span class="at">pattern =</span> <span class="st">"harvest-raw_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="fu">paste</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb32-17"><a href="#cb32-17"></a>        .,</span>
<span id="cb32-18"><a href="#cb32-18"></a>        <span class="at">sep =</span> <span class="st">"/"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>  <span class="fu">readRDS</span>()</span>
<span id="cb32-20"><a href="#cb32-20"></a></span>
<span id="cb32-21"><a href="#cb32-21"></a><span class="fu">Sys.time</span>()</span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="fu">system.time</span>(</span>
<span id="cb32-23"><a href="#cb32-23"></a>  harvest_raw <span class="ot">&lt;-</span> <span class="fu">do_harvest_doFuture</span>(fit.files)</span>
<span id="cb32-24"><a href="#cb32-24"></a>)</span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="fu">Sys.time</span>()</span>
<span id="cb32-26"><a href="#cb32-26"></a></span>
<span id="cb32-27"><a href="#cb32-27"></a></span>
<span id="cb32-28"><a href="#cb32-28"></a><span class="fu">saveRDS</span>(harvest_raw,</span>
<span id="cb32-29"><a href="#cb32-29"></a>        here<span class="sc">::</span><span class="fu">here</span>(dir_harvest,</span>
<span id="cb32-30"><a href="#cb32-30"></a>                   <span class="fu">paste0</span>(</span>
<span id="cb32-31"><a href="#cb32-31"></a>                     <span class="st">"harvest-raw_"</span>,</span>
<span id="cb32-32"><a href="#cb32-32"></a>                     <span class="fu">format</span>(<span class="fu">Sys.time</span>(),</span>
<span id="cb32-33"><a href="#cb32-33"></a>                            <span class="st">"%Y-%m-%d_%H-%M"</span>),</span>
<span id="cb32-34"><a href="#cb32-34"></a>                     <span class="st">".rds"</span></span>
<span id="cb32-35"><a href="#cb32-35"></a>                   )))</span>
<span id="cb32-36"><a href="#cb32-36"></a></span>
<span id="cb32-37"><a href="#cb32-37"></a></span>
<span id="cb32-38"><a href="#cb32-38"></a>d_abridged <span class="ot">&lt;-</span> harvest_raw <span class="sc">%&gt;%</span></span>
<span id="cb32-39"><a href="#cb32-39"></a>  <span class="fu">harvest_cleanup</span>(<span class="at">return.abridged =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-40"><a href="#cb32-40"></a></span>
<span id="cb32-41"><a href="#cb32-41"></a><span class="fu">saveRDS</span>(d_abridged ,</span>
<span id="cb32-42"><a href="#cb32-42"></a>        here<span class="sc">::</span><span class="fu">here</span>(dir_harvest,</span>
<span id="cb32-43"><a href="#cb32-43"></a>                   <span class="fu">paste0</span>(</span>
<span id="cb32-44"><a href="#cb32-44"></a>                     <span class="st">"harvest-abridged_"</span>,</span>
<span id="cb32-45"><a href="#cb32-45"></a>                     <span class="fu">format</span>(<span class="fu">Sys.time</span>(),</span>
<span id="cb32-46"><a href="#cb32-46"></a>                            <span class="st">"%Y-%m-%d_%H-%M"</span>),</span>
<span id="cb32-47"><a href="#cb32-47"></a>                     <span class="st">".rds"</span></span>
<span id="cb32-48"><a href="#cb32-48"></a>                   )))</span>
<span id="cb32-49"><a href="#cb32-49"></a></span>
<span id="cb32-50"><a href="#cb32-50"></a></span>
<span id="cb32-51"><a href="#cb32-51"></a>d_important <span class="ot">&lt;-</span> harvest_raw <span class="sc">%&gt;%</span> <span class="fu">harvest_cleanup</span>()</span>
<span id="cb32-52"><a href="#cb32-52"></a></span>
<span id="cb32-53"><a href="#cb32-53"></a><span class="fu">saveRDS</span>(d_important ,</span>
<span id="cb32-54"><a href="#cb32-54"></a>        here<span class="sc">::</span><span class="fu">here</span>(dir_harvest,</span>
<span id="cb32-55"><a href="#cb32-55"></a>                   <span class="fu">paste0</span>(</span>
<span id="cb32-56"><a href="#cb32-56"></a>                     <span class="st">"harvest-important_"</span>,</span>
<span id="cb32-57"><a href="#cb32-57"></a>                     <span class="fu">format</span>(<span class="fu">Sys.time</span>(),</span>
<span id="cb32-58"><a href="#cb32-58"></a>                            <span class="st">"%Y-%m-%d_%H-%M"</span>),</span>
<span id="cb32-59"><a href="#cb32-59"></a>                     <span class="st">".rds"</span></span>
<span id="cb32-60"><a href="#cb32-60"></a>                   )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-simulation-results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Simulation results</h1>
<p>We read the abridged harvested data file (<code>harvest-important_***.rds</code>) and make the outcome plots using <code>plot_Model.x.Resid</code> and <code>plot_quadrants</code> functions (of <a href="#sec-report-estimation-plots">Section&nbsp;1.4.3</a> ) and the MCMC estimates coverage plots using the function <code>plot_caterpillar</code> (of <a href="#sec-report-caterpillar-plots">Section&nbsp;1.4.4</a>). To ensure small file size and good resolutions, all plots are saved in separate PDF files (which can easily be included in a <span class="math inline">\(\mathrm{\LaTeX{}}\)</span> script) in a specific directory. Before going any further, we should read the abridged harvest dataframe and set the plot output folder.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-37_b7431a5b2f6429b9dc9908a1155195bd">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>d_abridged <span class="ot">&lt;-</span> <span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb33-2"><a href="#cb33-2"></a>                          <span class="at">pattern =</span> <span class="st">"harvest-abridged_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">paste</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb33-5"><a href="#cb33-5"></a>        .,</span>
<span id="cb33-6"><a href="#cb33-6"></a>        <span class="at">sep =</span> <span class="st">"/"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="fu">read_rds</span>()</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a>d_important <span class="ot">&lt;-</span> <span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb33-10"><a href="#cb33-10"></a>                          <span class="at">pattern =</span> <span class="st">"harvest-important_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>  <span class="fu">paste</span>(here<span class="sc">::</span><span class="fu">here</span>(dir_harvest),</span>
<span id="cb33-13"><a href="#cb33-13"></a>        .,</span>
<span id="cb33-14"><a href="#cb33-14"></a>        <span class="at">sep =</span> <span class="st">"/"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  <span class="fu">read_rds</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plots-main-results" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="plots-main-results"><span class="header-section-number">3.1</span> Plots main results</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Plots of a single outcome measure</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Plots of two outcome measures combined</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>The left and right panels (including results for Gaussian and <span class="math inline">\(\chi^2\)</span> distributed means) are made for each outcome measure of interest using <code>plot_Model.x.Resid</code>, combined using the package <code>patchwork</code>, and saved as PDF files.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-38_24e133a9964d298cf734d4e800f0483a">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="cf">for</span> (parameter <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Correlation"</span>, <span class="st">"Covariance"</span>)) {</span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="cf">for</span> (outcome <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Bias"</span>,</span>
<span id="cb34-3"><a href="#cb34-3"></a>                    <span class="st">"Variance"</span>,</span>
<span id="cb34-4"><a href="#cb34-4"></a>                    <span class="st">"RMSE"</span>,</span>
<span id="cb34-5"><a href="#cb34-5"></a>                    <span class="st">"MAE"</span>,</span>
<span id="cb34-6"><a href="#cb34-6"></a>                    <span class="st">"Positive error"</span>,</span>
<span id="cb34-7"><a href="#cb34-7"></a>                    <span class="st">"Negative error"</span>,</span>
<span id="cb34-8"><a href="#cb34-8"></a>                    <span class="st">"Total error"</span>)) {</span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-10"><a href="#cb34-10"></a>    p.single.left <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb34-11"><a href="#cb34-11"></a>                                       parameter,</span>
<span id="cb34-12"><a href="#cb34-12"></a>                                       outcome,</span>
<span id="cb34-13"><a href="#cb34-13"></a>                                       <span class="st">"Gaussian"</span>,</span>
<span id="cb34-14"><a href="#cb34-14"></a>                                       <span class="at">line.width =</span> <span class="dv">2</span>,</span>
<span id="cb34-15"><a href="#cb34-15"></a>                                       <span class="at">font.scale =</span> <span class="dv">8</span>)</span>
<span id="cb34-16"><a href="#cb34-16"></a></span>
<span id="cb34-17"><a href="#cb34-17"></a>    p.single.right <span class="ot">&lt;-</span> <span class="fu">plot_Model.x.Resid</span>(d_important,</span>
<span id="cb34-18"><a href="#cb34-18"></a>                                        parameter,</span>
<span id="cb34-19"><a href="#cb34-19"></a>                                        outcome,</span>
<span id="cb34-20"><a href="#cb34-20"></a>                                        <span class="st">"Chi2"</span>,</span>
<span id="cb34-21"><a href="#cb34-21"></a>                                        <span class="at">line.width =</span> <span class="dv">2</span>,</span>
<span id="cb34-22"><a href="#cb34-22"></a>                                        <span class="at">font.scale =</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb34-23"><a href="#cb34-23"></a></span>
<span id="cb34-24"><a href="#cb34-24"></a>    p.patchwork <span class="ot">&lt;-</span> (p.single.left <span class="sc">|</span> p.single.right)</span>
<span id="cb34-25"><a href="#cb34-25"></a></span>
<span id="cb34-26"><a href="#cb34-26"></a>    title <span class="ot">&lt;-</span> <span class="fu">paste</span>(outcome,</span>
<span id="cb34-27"><a href="#cb34-27"></a>                   <span class="st">"in the estimated"</span>,</span>
<span id="cb34-28"><a href="#cb34-28"></a>                   <span class="fu">tolower</span>(parameter)</span>
<span id="cb34-29"><a href="#cb34-29"></a>    )</span>
<span id="cb34-30"><a href="#cb34-30"></a></span>
<span id="cb34-31"><a href="#cb34-31"></a>    p.final <span class="ot">&lt;-</span> p.patchwork <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32"></a>      <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb34-33"><a href="#cb34-33"></a>      <span class="fu">plot_annotation</span>(</span>
<span id="cb34-34"><a href="#cb34-34"></a>        <span class="do">## removed the big title and subtitle  here</span></span>
<span id="cb34-35"><a href="#cb34-35"></a>        <span class="co"># title = TeX(title),</span></span>
<span id="cb34-36"><a href="#cb34-36"></a>        <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span></span>
<span id="cb34-37"><a href="#cb34-37"></a>                        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb34-38"><a href="#cb34-38"></a>                                     <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb34-39"><a href="#cb34-39"></a>                                     <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb34-40"><a href="#cb34-40"></a>      ) <span class="sc">&amp;</span></span>
<span id="cb34-41"><a href="#cb34-41"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb34-42"><a href="#cb34-42"></a></span>
<span id="cb34-43"><a href="#cb34-43"></a>    <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"error"</span>, <span class="fu">tolower</span>(outcome), <span class="at">fixed =</span> <span class="cn">TRUE</span>)) p.final <span class="ot">&lt;-</span> p.final <span class="sc">+</span></span>
<span id="cb34-44"><a href="#cb34-44"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>))</span>
<span id="cb34-45"><a href="#cb34-45"></a></span>
<span id="cb34-46"><a href="#cb34-46"></a>    <span class="fu">ggsave</span>(<span class="fu">paste0</span>(parameter,</span>
<span id="cb34-47"><a href="#cb34-47"></a>                  <span class="st">" ("</span>,</span>
<span id="cb34-48"><a href="#cb34-48"></a>                  outcome,</span>
<span id="cb34-49"><a href="#cb34-49"></a>                  <span class="st">").pdf"</span>),</span>
<span id="cb34-50"><a href="#cb34-50"></a>           p.final,</span>
<span id="cb34-51"><a href="#cb34-51"></a>           <span class="at">path =</span> dir_plots,</span>
<span id="cb34-52"><a href="#cb34-52"></a>           <span class="at">width =</span> <span class="dv">21</span>,</span>
<span id="cb34-53"><a href="#cb34-53"></a>           <span class="at">height =</span> <span class="fl">21.5</span><span class="sc">*</span><span class="dv">30</span><span class="sc">/</span><span class="dv">37</span> <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb34-54"><a href="#cb34-54"></a>           <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb34-55"><a href="#cb34-55"></a></span>
<span id="cb34-56"><a href="#cb34-56"></a>  }</span>
<span id="cb34-57"><a href="#cb34-57"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>
<p>The generated plots are located in <code>figures</code> folder and can be accessed via the following tables:</p>
<table class="table">
<caption>Individual plots of outcome measures</caption>
<thead>
<tr class="header">
<th>Outcome measures</th>
<th>Correlations</th>
<th>Covariances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bias</td>
<td><a href="./figures/Correlation%20(Bias).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Bias).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>Variance</td>
<td><a href="./figures/Correlation%20(Variance).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Variance).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="odd">
<td>RMSE</td>
<td><a href="./figures/Correlation%20(RMSE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(RMSE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>MAE</td>
<td><a href="./figures/Correlation%20(MAE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(MAE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="odd">
<td>Positive Type-I error rate</td>
<td><a href="./figures/Correlation%20(Positive%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Positive%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>Negative Type-I error rate</td>
<td><a href="./figures/Correlation%20(Negative%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Negative%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="odd">
<td>Total Type-I error rate</td>
<td><a href="./figures/Correlation%20(Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>The plots containing pairs of outcome measures (respectively including results for Gaussian and <span class="math inline">\(\chi^2\)</span> distributed means) are made for each outcome measure of interest, combined using the package <code>patchwork</code>, and saved as PDF files.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-39_40908372e96684a37f195e39677e784c">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="cf">for</span> (parameter <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Correlation"</span>, <span class="st">"Covariance"</span>)) {</span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="cf">for</span> (upper_lower <span class="cf">in</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Bias"</span>, <span class="st">"RMSE"</span>),</span>
<span id="cb35-3"><a href="#cb35-3"></a>                           <span class="fu">c</span>(<span class="st">"Bias"</span>, <span class="st">"Variance"</span>),</span>
<span id="cb35-4"><a href="#cb35-4"></a>                           <span class="fu">c</span>(<span class="st">"Bias"</span>, <span class="st">"MAE"</span>),</span>
<span id="cb35-5"><a href="#cb35-5"></a>                           <span class="fu">c</span>(<span class="st">"Positive error"</span>, <span class="st">"Negative error"</span>),</span>
<span id="cb35-6"><a href="#cb35-6"></a>                           <span class="fu">c</span>(<span class="st">"Positive error"</span>, <span class="st">"Total error"</span>),</span>
<span id="cb35-7"><a href="#cb35-7"></a>                           <span class="fu">c</span>(<span class="st">"Negative error"</span>, <span class="st">"Total error"</span>))) {</span>
<span id="cb35-8"><a href="#cb35-8"></a>    upper <span class="ot">&lt;-</span> upper_lower[<span class="dv">1</span>]</span>
<span id="cb35-9"><a href="#cb35-9"></a>    lower <span class="ot">&lt;-</span> upper_lower[<span class="dv">2</span>]</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a>    p.q <span class="ot">&lt;-</span> <span class="fu">plot_quadrants</span>(d_important,</span>
<span id="cb35-12"><a href="#cb35-12"></a>                           parameter,</span>
<span id="cb35-13"><a href="#cb35-13"></a>                           upper,</span>
<span id="cb35-14"><a href="#cb35-14"></a>                           lower)</span>
<span id="cb35-15"><a href="#cb35-15"></a>      <span class="do">## Saving the plot</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>      <span class="fu">ggsave</span>(</span>
<span id="cb35-17"><a href="#cb35-17"></a>        <span class="fu">paste0</span>(parameter,</span>
<span id="cb35-18"><a href="#cb35-18"></a>               <span class="st">" ("</span>,</span>
<span id="cb35-19"><a href="#cb35-19"></a>               upper,</span>
<span id="cb35-20"><a href="#cb35-20"></a>               <span class="st">" and "</span>,</span>
<span id="cb35-21"><a href="#cb35-21"></a>               lower,</span>
<span id="cb35-22"><a href="#cb35-22"></a>               <span class="st">").pdf"</span>),</span>
<span id="cb35-23"><a href="#cb35-23"></a>        p.q,</span>
<span id="cb35-24"><a href="#cb35-24"></a>        <span class="at">path =</span> dir_plots,</span>
<span id="cb35-25"><a href="#cb35-25"></a>        <span class="at">width =</span> <span class="dv">21</span>,</span>
<span id="cb35-26"><a href="#cb35-26"></a>        <span class="at">height =</span> <span class="dv">30</span>,</span>
<span id="cb35-27"><a href="#cb35-27"></a>        <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb35-28"><a href="#cb35-28"></a>      )</span>
<span id="cb35-29"><a href="#cb35-29"></a>  }</span>
<span id="cb35-30"><a href="#cb35-30"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The generated plots are located in <code>figures</code> folder and can be accessed via the following tables:</p>
<table class="table">
<caption>Combined plots of two outcome measures</caption>
<thead>
<tr class="header">
<th>Outcome measures</th>
<th>Correlations</th>
<th>Covariances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bias and Variance</td>
<td><a href="./figures/Correlation%20(Bias%20and%20Variance).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Bias%20and%20Variance).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>Bias and RMSE</td>
<td><a href="./figures/Correlation%20(Bias%20and%20RMSE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Bias%20and%20RMSE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="odd">
<td>Bias and MAE</td>
<td><a href="./figures/Correlation%20(Bias%20and%20MAE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Bias%20and%20MAE).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>Positive and negative Type-I error</td>
<td><a href="./figures/Correlation%20(Positive%20error%20and%20Negative%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Positive%20error%20and%20Negative%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="odd">
<td>Positive and total Type-I error</td>
<td><a href="./figures/Correlation%20(Positive%20error%20and%20Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Positive%20error%20and%20Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
<tr class="even">
<td>Negative and total Type-I error</td>
<td><a href="./figures/Correlation%20(Negative%20error%20and%20Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
<td><a href="./figures/Covariance%20(Negative%20error%20and%20Total%20error).pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="plots-of-mcmc-parameter-estimates-coverage" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="plots-of-mcmc-parameter-estimates-coverage"><span class="header-section-number">3.2</span> Plots of MCMC parameter estimates coverage</h2>
<p>It should be noted that <code>plot_caterpillar</code> requires the abridged dataset of harvested results (<code>d_abridged</code>) that contain estimates of all replications within each condition.</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-40_661f9bf01e390e9be010498c3c0995b8">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Making lists of level-2 distributions, model names, and analyses --------</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a>list_l2.dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gaussian"</span>,</span>
<span id="cb36-4"><a href="#cb36-4"></a>                  <span class="st">"Chi2"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a>list_model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"NAR"</span>,</span>
<span id="cb36-7"><a href="#cb36-7"></a>                <span class="st">"Chi2AR"</span>,</span>
<span id="cb36-8"><a href="#cb36-8"></a>                <span class="st">"BinAR"</span>,</span>
<span id="cb36-9"><a href="#cb36-9"></a>                <span class="st">"PoDAR"</span>)</span>
<span id="cb36-10"><a href="#cb36-10"></a></span>
<span id="cb36-11"><a href="#cb36-11"></a>list_model.type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"resid.fixed"</span>,</span>
<span id="cb36-12"><a href="#cb36-12"></a>                     <span class="st">"resid.random"</span>)</span>
<span id="cb36-13"><a href="#cb36-13"></a></span>
<span id="cb36-14"><a href="#cb36-14"></a>list_parameter <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Correlation"</span>,</span>
<span id="cb36-15"><a href="#cb36-15"></a>                    <span class="st">"Covariance"</span>)</span>
<span id="cb36-16"><a href="#cb36-16"></a></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="co"># Plots with 9 panels -----------------------------------------------------</span></span>
<span id="cb36-18"><a href="#cb36-18"></a></span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="cf">for</span> (single_parameter <span class="cf">in</span> list_parameter) {</span>
<span id="cb36-20"><a href="#cb36-20"></a></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="fu">cross3</span>(list_model,</span>
<span id="cb36-22"><a href="#cb36-22"></a>       list_l2.dist,</span>
<span id="cb36-23"><a href="#cb36-23"></a>       list_model.type) <span class="sc">%&gt;%</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>  plyr<span class="sc">::</span><span class="fu">l_ply</span>(<span class="cf">function</span>(x){</span>
<span id="cb36-25"><a href="#cb36-25"></a>    single_model <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb36-26"><a href="#cb36-26"></a>    single_model_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(single_model <span class="sc">==</span> <span class="st">"Chiar"</span>,</span>
<span id="cb36-27"><a href="#cb36-27"></a>                                <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$AR(1)"</span>,</span>
<span id="cb36-28"><a href="#cb36-28"></a>                                <span class="fu">paste0</span>(single_model, <span class="st">"(1)"</span>))</span>
<span id="cb36-29"><a href="#cb36-29"></a></span>
<span id="cb36-30"><a href="#cb36-30"></a>    single_l2.dist <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb36-31"><a href="#cb36-31"></a>    single_l2.dist_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(single_l2.dist <span class="sc">==</span> <span class="st">"Chi2"</span>,</span>
<span id="cb36-32"><a href="#cb36-32"></a>                                  <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$"</span>,</span>
<span id="cb36-33"><a href="#cb36-33"></a>                                  single_l2.dist)</span>
<span id="cb36-34"><a href="#cb36-34"></a></span>
<span id="cb36-35"><a href="#cb36-35"></a>    model_type <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb36-36"><a href="#cb36-36"></a></span>
<span id="cb36-37"><a href="#cb36-37"></a>    caterpillar_single <span class="ot">&lt;-</span> <span class="fu">plot_caterpillar</span>(d_abridged,</span>
<span id="cb36-38"><a href="#cb36-38"></a>                                            <span class="at">l2.dist_ =</span> single_l2.dist,</span>
<span id="cb36-39"><a href="#cb36-39"></a>                                            <span class="at">Model_ =</span> single_model,</span>
<span id="cb36-40"><a href="#cb36-40"></a>                                            <span class="at">parameter_ =</span> single_parameter,</span>
<span id="cb36-41"><a href="#cb36-41"></a>                                            <span class="at">analysis.type =</span> model_type)</span>
<span id="cb36-42"><a href="#cb36-42"></a></span>
<span id="cb36-43"><a href="#cb36-43"></a>    p.final <span class="ot">&lt;-</span> caterpillar_single <span class="sc">+</span></span>
<span id="cb36-44"><a href="#cb36-44"></a>      <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb36-45"><a href="#cb36-45"></a>      <span class="fu">plot_annotation</span>(</span>
<span id="cb36-46"><a href="#cb36-46"></a>        <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span></span>
<span id="cb36-47"><a href="#cb36-47"></a>                        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb36-48"><a href="#cb36-48"></a>                                     <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb36-49"><a href="#cb36-49"></a>                                     <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-50"><a href="#cb36-50"></a>                      <span class="at">plot.subtitle =</span></span>
<span id="cb36-51"><a href="#cb36-51"></a>                        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb36-52"><a href="#cb36-52"></a>                                     <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb36-53"><a href="#cb36-53"></a>                                     <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb36-54"><a href="#cb36-54"></a>      ) <span class="sc">&amp;</span></span>
<span id="cb36-55"><a href="#cb36-55"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb36-56"><a href="#cb36-56"></a></span>
<span id="cb36-57"><a href="#cb36-57"></a>    <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"caterpillar-"</span>,</span>
<span id="cb36-58"><a href="#cb36-58"></a>                  single_parameter,</span>
<span id="cb36-59"><a href="#cb36-59"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-60"><a href="#cb36-60"></a>                  single_model,</span>
<span id="cb36-61"><a href="#cb36-61"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-62"><a href="#cb36-62"></a>                  single_l2.dist,</span>
<span id="cb36-63"><a href="#cb36-63"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-64"><a href="#cb36-64"></a>                  model_type,</span>
<span id="cb36-65"><a href="#cb36-65"></a>                  <span class="st">".pdf"</span>),</span>
<span id="cb36-66"><a href="#cb36-66"></a>           p.final,</span>
<span id="cb36-67"><a href="#cb36-67"></a>           <span class="at">path =</span> dir_plots,</span>
<span id="cb36-68"><a href="#cb36-68"></a>           <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb36-69"><a href="#cb36-69"></a>           <span class="at">height =</span> <span class="dv">11</span>,</span>
<span id="cb36-70"><a href="#cb36-70"></a>           <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb36-71"><a href="#cb36-71"></a></span>
<span id="cb36-72"><a href="#cb36-72"></a>  })</span>
<span id="cb36-73"><a href="#cb36-73"></a>}</span>
<span id="cb36-74"><a href="#cb36-74"></a></span>
<span id="cb36-75"><a href="#cb36-75"></a><span class="co"># Plots with 18 panels ----------------------------------------------------</span></span>
<span id="cb36-76"><a href="#cb36-76"></a></span>
<span id="cb36-77"><a href="#cb36-77"></a></span>
<span id="cb36-78"><a href="#cb36-78"></a><span class="fu">cross3</span>(list_model,</span>
<span id="cb36-79"><a href="#cb36-79"></a>       list_l2.dist,</span>
<span id="cb36-80"><a href="#cb36-80"></a>       list_parameter) <span class="sc">%&gt;%</span></span>
<span id="cb36-81"><a href="#cb36-81"></a>  plyr<span class="sc">::</span><span class="fu">l_ply</span>(<span class="cf">function</span>(x){</span>
<span id="cb36-82"><a href="#cb36-82"></a></span>
<span id="cb36-83"><a href="#cb36-83"></a>    single_model <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb36-84"><a href="#cb36-84"></a>    single_model_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(single_model <span class="sc">==</span> <span class="st">"Chiar"</span>,</span>
<span id="cb36-85"><a href="#cb36-85"></a>                                <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$AR(1)"</span>,</span>
<span id="cb36-86"><a href="#cb36-86"></a>                                <span class="fu">paste0</span>(single_model, <span class="st">"(1)"</span>))</span>
<span id="cb36-87"><a href="#cb36-87"></a></span>
<span id="cb36-88"><a href="#cb36-88"></a>    single_l2.dist <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb36-89"><a href="#cb36-89"></a>    single_l2.dist_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(single_l2.dist <span class="sc">==</span> <span class="st">"Chi2"</span>,</span>
<span id="cb36-90"><a href="#cb36-90"></a>                                  <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2$"</span>,</span>
<span id="cb36-91"><a href="#cb36-91"></a>                                  single_l2.dist)</span>
<span id="cb36-92"><a href="#cb36-92"></a></span>
<span id="cb36-93"><a href="#cb36-93"></a>    single_parameter <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb36-94"><a href="#cb36-94"></a>    caterpillar_fixed <span class="ot">&lt;-</span> <span class="fu">plot_caterpillar</span>(d_abridged,</span>
<span id="cb36-95"><a href="#cb36-95"></a>                                          <span class="at">l2.dist_ =</span> single_l2.dist,</span>
<span id="cb36-96"><a href="#cb36-96"></a>                                          <span class="at">Model_ =</span> single_model,</span>
<span id="cb36-97"><a href="#cb36-97"></a>                                          <span class="at">parameter_ =</span> single_parameter,</span>
<span id="cb36-98"><a href="#cb36-98"></a>                                          <span class="at">analysis.type =</span> <span class="st">"resid.fixed"</span>)</span>
<span id="cb36-99"><a href="#cb36-99"></a>    caterpillar_random <span class="ot">&lt;-</span> <span class="fu">plot_caterpillar</span>(d_abridged,</span>
<span id="cb36-100"><a href="#cb36-100"></a>                                           <span class="at">l2.dist_ =</span> single_l2.dist,</span>
<span id="cb36-101"><a href="#cb36-101"></a>                                           <span class="at">Model_ =</span> single_model,</span>
<span id="cb36-102"><a href="#cb36-102"></a>                                           <span class="at">parameter_ =</span> single_parameter,</span>
<span id="cb36-103"><a href="#cb36-103"></a>                                           <span class="at">analysis.type =</span> <span class="st">"resid.random"</span>)</span>
<span id="cb36-104"><a href="#cb36-104"></a></span>
<span id="cb36-105"><a href="#cb36-105"></a>    p.patchwork <span class="ot">&lt;-</span> caterpillar_fixed <span class="sc">/</span> caterpillar_random</span>
<span id="cb36-106"><a href="#cb36-106"></a></span>
<span id="cb36-107"><a href="#cb36-107"></a>    p.final <span class="ot">&lt;-</span> p.patchwork <span class="sc">+</span></span>
<span id="cb36-108"><a href="#cb36-108"></a>      <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb36-109"><a href="#cb36-109"></a>      <span class="fu">plot_annotation</span>(</span>
<span id="cb36-110"><a href="#cb36-110"></a>        <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span></span>
<span id="cb36-111"><a href="#cb36-111"></a>                        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb36-112"><a href="#cb36-112"></a>                                     <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb36-113"><a href="#cb36-113"></a>                                     <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-114"><a href="#cb36-114"></a>                      <span class="at">plot.subtitle =</span></span>
<span id="cb36-115"><a href="#cb36-115"></a>                        <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb36-116"><a href="#cb36-116"></a>                                     <span class="at">family =</span> <span class="st">"CMU Serif"</span>,</span>
<span id="cb36-117"><a href="#cb36-117"></a>                                     <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb36-118"><a href="#cb36-118"></a>      ) <span class="sc">&amp;</span></span>
<span id="cb36-119"><a href="#cb36-119"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb36-120"><a href="#cb36-120"></a></span>
<span id="cb36-121"><a href="#cb36-121"></a>    <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"caterpillar-"</span>,</span>
<span id="cb36-122"><a href="#cb36-122"></a>                  single_parameter,</span>
<span id="cb36-123"><a href="#cb36-123"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-124"><a href="#cb36-124"></a>                  single_model,</span>
<span id="cb36-125"><a href="#cb36-125"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-126"><a href="#cb36-126"></a>                  single_l2.dist,</span>
<span id="cb36-127"><a href="#cb36-127"></a>                  <span class="st">"-"</span>,</span>
<span id="cb36-128"><a href="#cb36-128"></a>                  <span class="st">"both"</span>,</span>
<span id="cb36-129"><a href="#cb36-129"></a>                  <span class="st">".pdf"</span>),</span>
<span id="cb36-130"><a href="#cb36-130"></a>           p.final,</span>
<span id="cb36-131"><a href="#cb36-131"></a>           <span class="at">path =</span> dir_plots,</span>
<span id="cb36-132"><a href="#cb36-132"></a>           <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb36-133"><a href="#cb36-133"></a>           <span class="at">height =</span> <span class="dv">18</span>,</span>
<span id="cb36-134"><a href="#cb36-134"></a>           <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb36-135"><a href="#cb36-135"></a></span>
<span id="cb36-136"><a href="#cb36-136"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>
<p>The generated plots are located in <code>figures</code> folder and can be accessed via the following tables:</p>
<table class="table">
<caption>MCMC parameter estimates coverage plots for <strong>correlations</strong></caption>
<thead>
<tr class="header">
<th>Model</th>
<th>Gaussian-distributed means</th>
<th><span class="math inline">\(\chi^2\)</span>-distributed means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>AR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-NAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-NAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-NAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-NAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-NAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-NAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\chi^2\)</span><strong>AR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-Chi2AR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-Chi2AR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-Chi2AR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-Chi2AR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-Chi2AR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-Chi2AR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="odd">
<td><strong>BinAR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-BinAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-BinAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-BinAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-BinAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-BinAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-BinAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="even">
<td><strong>PoDAR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-PoDAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-PoDAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-PoDAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Correlation-PoDAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Correlation-PoDAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Correlation-PoDAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
</tbody>
</table>
<table class="table">
<caption>MCMC parameter estimates coverage plots for <strong>covariances</strong></caption>
<thead>
<tr class="header">
<th>Model</th>
<th>Gaussian-distributed means</th>
<th><span class="math inline">\(\chi^2\)</span>-distributed means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>AR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-NAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-NAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-NAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-NAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-NAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-NAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\chi^2\)</span><strong>AR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-Chi2AR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-Chi2AR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-Chi2AR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-Chi2AR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-Chi2AR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-Chi2AR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="odd">
<td><strong>BinAR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-BinAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-BinAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-BinAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-BinAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-BinAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-BinAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
<tr class="even">
<td><strong>PoDAR(1)</strong></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-PoDAR-Gaussian-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-PoDAR-Gaussian-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-PoDAR-Gaussian-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
<td><p>Fixed res. var <a href="./figures/caterpillar-Covariance-PoDAR-Chi2-resid.fixed.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Random res. var <a href="./figures/caterpillar-Covariance-PoDAR-Chi2-resid.random.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p>
<p>Combined <a href="./figures/caterpillar-Covariance-PoDAR-Chi2-both.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="sec-additional-analyses-and-figures" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Additional figures and analyses</h1>
<section id="sec-additional-DGM-time-series-plots" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-additional-DGM-time-series-plots"><span class="header-section-number">4.1</span> DGM time series plots</h2>
<p>We make plots including time series plots, marginal distributions, and sample ACFs for three time series generated by each DGMs.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Combining DGM outputs in one dataframe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Making the plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">Saving the plots</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-41_bcde890ca5525343b8f9e0508ab39453">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>make_dgm_df <span class="ot">&lt;-</span> <span class="cf">function</span>(obj<span class="fl">.1</span>,</span>
<span id="cb37-2"><a href="#cb37-2"></a>                        obj<span class="fl">.2</span>,</span>
<span id="cb37-3"><a href="#cb37-3"></a>                        <span class="at">obj.3 =</span> <span class="cn">NULL</span>){</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a>  d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obj<span class="fl">.1</span><span class="sc">$</span>x),</span>
<span id="cb37-6"><a href="#cb37-6"></a>                    <span class="at">value =</span> obj<span class="fl">.1</span><span class="sc">$</span>x,</span>
<span id="cb37-7"><a href="#cb37-7"></a>                    <span class="at">obj.id =</span> obj<span class="fl">.1</span><span class="sc">$</span>Model.Description.Short)</span>
<span id="cb37-8"><a href="#cb37-8"></a></span>
<span id="cb37-9"><a href="#cb37-9"></a>  d<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obj<span class="fl">.2</span><span class="sc">$</span>x),</span>
<span id="cb37-10"><a href="#cb37-10"></a>                    <span class="at">value =</span> obj<span class="fl">.2</span><span class="sc">$</span>x,</span>
<span id="cb37-11"><a href="#cb37-11"></a>                    <span class="at">obj.id =</span> obj<span class="fl">.2</span><span class="sc">$</span>Model.Description.Short)</span>
<span id="cb37-12"><a href="#cb37-12"></a></span>
<span id="cb37-13"><a href="#cb37-13"></a>  d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d<span class="fl">.1</span>, d<span class="fl">.2</span>)</span>
<span id="cb37-14"><a href="#cb37-14"></a></span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(obj<span class="fl">.3</span>)){</span>
<span id="cb37-16"><a href="#cb37-16"></a>    d<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obj<span class="fl">.3</span><span class="sc">$</span>x),</span>
<span id="cb37-17"><a href="#cb37-17"></a>                      <span class="at">value =</span> obj<span class="fl">.3</span><span class="sc">$</span>x,</span>
<span id="cb37-18"><a href="#cb37-18"></a>                      <span class="at">obj.id =</span> obj<span class="fl">.3</span><span class="sc">$</span>Model.Description.Short)</span>
<span id="cb37-19"><a href="#cb37-19"></a>    d <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d, d<span class="fl">.3</span>)</span>
<span id="cb37-20"><a href="#cb37-20"></a>  }</span>
<span id="cb37-21"><a href="#cb37-21"></a></span>
<span id="cb37-22"><a href="#cb37-22"></a>  d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb37-23"><a href="#cb37-23"></a>    <span class="fu">group_by</span>(obj.id) <span class="sc">%&gt;%</span></span>
<span id="cb37-24"><a href="#cb37-24"></a>    <span class="fu">mutate</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(value))</span>
<span id="cb37-25"><a href="#cb37-25"></a></span>
<span id="cb37-26"><a href="#cb37-26"></a>  <span class="fu">return</span>(d)</span>
<span id="cb37-27"><a href="#cb37-27"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-42_add195c0fd5806f09053f05d87fc540e">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>ts.length <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a>d.<span class="fl">3.</span>nar <span class="ot">&lt;-</span> <span class="fu">make_dgm_df</span>(</span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="fu">dgm_nar</span>(</span>
<span id="cb38-6"><a href="#cb38-6"></a>    <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-7"><a href="#cb38-7"></a>    <span class="at">var.resid =</span> <span class="dv">20</span>,</span>
<span id="cb38-8"><a href="#cb38-8"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-9"><a href="#cb38-9"></a>    <span class="at">Mean =</span> <span class="dv">85</span>,</span>
<span id="cb38-10"><a href="#cb38-10"></a>    <span class="at">seed =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">9</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>  ),</span>
<span id="cb38-12"><a href="#cb38-12"></a>  <span class="fu">dgm_nar</span>(</span>
<span id="cb38-13"><a href="#cb38-13"></a>    <span class="at">phi =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-14"><a href="#cb38-14"></a>    <span class="at">var.resid =</span> <span class="dv">20</span>,</span>
<span id="cb38-15"><a href="#cb38-15"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-16"><a href="#cb38-16"></a>    <span class="at">Mean =</span> <span class="dv">55</span>,</span>
<span id="cb38-17"><a href="#cb38-17"></a>    <span class="at">seed =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb38-18"><a href="#cb38-18"></a>  ),</span>
<span id="cb38-19"><a href="#cb38-19"></a>  <span class="fu">dgm_nar</span>(</span>
<span id="cb38-20"><a href="#cb38-20"></a>    <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-21"><a href="#cb38-21"></a>    <span class="at">var.resid =</span> <span class="dv">47</span>,</span>
<span id="cb38-22"><a href="#cb38-22"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-23"><a href="#cb38-23"></a>    <span class="at">Mean =</span> <span class="dv">20</span>,</span>
<span id="cb38-24"><a href="#cb38-24"></a>    <span class="at">seed =</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb38-25"><a href="#cb38-25"></a>  )</span>
<span id="cb38-26"><a href="#cb38-26"></a>)</span>
<span id="cb38-27"><a href="#cb38-27"></a></span>
<span id="cb38-28"><a href="#cb38-28"></a></span>
<span id="cb38-29"><a href="#cb38-29"></a>profile_nar <span class="ot">&lt;-</span> <span class="fu">plot_dgm.profile</span>(d.<span class="fl">3.</span>nar,</span>
<span id="cb38-30"><a href="#cb38-30"></a>                                <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"YlOrBr"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)],</span>
<span id="cb38-31"><a href="#cb38-31"></a>                                <span class="st">"$AR(1)$"</span>)</span>
<span id="cb38-32"><a href="#cb38-32"></a></span>
<span id="cb38-33"><a href="#cb38-33"></a></span>
<span id="cb38-34"><a href="#cb38-34"></a>d.<span class="fl">3.</span>chiar <span class="ot">&lt;-</span> <span class="fu">make_dgm_df</span>(</span>
<span id="cb38-35"><a href="#cb38-35"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-36"><a href="#cb38-36"></a>    <span class="at">Model =</span> <span class="st">"ChiAR"</span>,</span>
<span id="cb38-37"><a href="#cb38-37"></a>    <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-38"><a href="#cb38-38"></a>    <span class="at">nu =</span> <span class="dv">25</span>,</span>
<span id="cb38-39"><a href="#cb38-39"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-40"><a href="#cb38-40"></a>    <span class="at">seed =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-41"><a href="#cb38-41"></a>  ),</span>
<span id="cb38-42"><a href="#cb38-42"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-43"><a href="#cb38-43"></a>    <span class="at">Model =</span> <span class="st">"ChiAR"</span>,</span>
<span id="cb38-44"><a href="#cb38-44"></a>    <span class="at">phi =</span> <span class="fl">0.7</span>,</span>
<span id="cb38-45"><a href="#cb38-45"></a>    <span class="at">nu =</span> <span class="dv">5</span>,</span>
<span id="cb38-46"><a href="#cb38-46"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-47"><a href="#cb38-47"></a>    <span class="at">seed =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb38-48"><a href="#cb38-48"></a>  ),</span>
<span id="cb38-49"><a href="#cb38-49"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-50"><a href="#cb38-50"></a>    <span class="at">Model =</span> <span class="st">"ChiAR"</span>,</span>
<span id="cb38-51"><a href="#cb38-51"></a>    <span class="at">phi =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-52"><a href="#cb38-52"></a>    <span class="at">nu =</span> <span class="dv">1</span>,</span>
<span id="cb38-53"><a href="#cb38-53"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-54"><a href="#cb38-54"></a>    <span class="at">seed =</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-55"><a href="#cb38-55"></a>  )</span>
<span id="cb38-56"><a href="#cb38-56"></a>)</span>
<span id="cb38-57"><a href="#cb38-57"></a></span>
<span id="cb38-58"><a href="#cb38-58"></a></span>
<span id="cb38-59"><a href="#cb38-59"></a>profile_chiar <span class="ot">&lt;-</span> <span class="fu">plot_dgm.profile</span>(d.<span class="fl">3.</span>chiar,</span>
<span id="cb38-60"><a href="#cb38-60"></a>                                  <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"GnBu"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)],</span>
<span id="cb38-61"><a href="#cb38-61"></a>                                  <span class="st">"$</span><span class="sc">\\</span><span class="st">chi^2AR(1)$"</span>)</span>
<span id="cb38-62"><a href="#cb38-62"></a></span>
<span id="cb38-63"><a href="#cb38-63"></a></span>
<span id="cb38-64"><a href="#cb38-64"></a>d.<span class="fl">3.</span>binar <span class="ot">&lt;-</span> <span class="fu">make_dgm_df</span>(</span>
<span id="cb38-65"><a href="#cb38-65"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-66"><a href="#cb38-66"></a>    <span class="at">Model =</span> <span class="st">"BinAR"</span>,</span>
<span id="cb38-67"><a href="#cb38-67"></a>    <span class="at">k =</span> <span class="dv">7</span>,</span>
<span id="cb38-68"><a href="#cb38-68"></a>    <span class="at">alpha  =</span> <span class="fl">0.85</span>,</span>
<span id="cb38-69"><a href="#cb38-69"></a>    <span class="at">phi =</span> <span class="fl">0.45</span>,</span>
<span id="cb38-70"><a href="#cb38-70"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-71"><a href="#cb38-71"></a>    <span class="at">seed =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb38-72"><a href="#cb38-72"></a>  ),</span>
<span id="cb38-73"><a href="#cb38-73"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-74"><a href="#cb38-74"></a>    <span class="at">Model =</span> <span class="st">"BinAR"</span>,</span>
<span id="cb38-75"><a href="#cb38-75"></a>    <span class="at">k =</span> <span class="dv">7</span>,</span>
<span id="cb38-76"><a href="#cb38-76"></a>    <span class="at">alpha =</span> <span class="fl">0.85</span>,</span>
<span id="cb38-77"><a href="#cb38-77"></a>    <span class="at">phi =</span> <span class="fl">0.7</span>,</span>
<span id="cb38-78"><a href="#cb38-78"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-79"><a href="#cb38-79"></a>    <span class="at">seed =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">6</span></span>
<span id="cb38-80"><a href="#cb38-80"></a>  ),</span>
<span id="cb38-81"><a href="#cb38-81"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-82"><a href="#cb38-82"></a>    <span class="at">Model =</span> <span class="st">"BinAR"</span>,</span>
<span id="cb38-83"><a href="#cb38-83"></a>    <span class="at">k =</span> <span class="dv">7</span>,</span>
<span id="cb38-84"><a href="#cb38-84"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb38-85"><a href="#cb38-85"></a>    <span class="at">phi =</span> <span class="fl">0.45</span>,</span>
<span id="cb38-86"><a href="#cb38-86"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-87"><a href="#cb38-87"></a>    <span class="at">seed =</span> <span class="dv">3</span></span>
<span id="cb38-88"><a href="#cb38-88"></a>  )</span>
<span id="cb38-89"><a href="#cb38-89"></a>)</span>
<span id="cb38-90"><a href="#cb38-90"></a></span>
<span id="cb38-91"><a href="#cb38-91"></a>profile_binar <span class="ot">&lt;-</span> <span class="fu">plot_dgm.profile</span>(d.<span class="fl">3.</span>binar,</span>
<span id="cb38-92"><a href="#cb38-92"></a>                                  <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"YlGn"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)],</span>
<span id="cb38-93"><a href="#cb38-93"></a>                                  <span class="st">"$BinAR(1)$"</span>)</span>
<span id="cb38-94"><a href="#cb38-94"></a></span>
<span id="cb38-95"><a href="#cb38-95"></a></span>
<span id="cb38-96"><a href="#cb38-96"></a>d.<span class="fl">3.</span>podar <span class="ot">&lt;-</span> <span class="fu">make_dgm_df</span>(</span>
<span id="cb38-97"><a href="#cb38-97"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-98"><a href="#cb38-98"></a>    <span class="at">Model =</span> <span class="st">"PoDAR"</span>,</span>
<span id="cb38-99"><a href="#cb38-99"></a>    <span class="at">tau =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-100"><a href="#cb38-100"></a>    <span class="at">Mean =</span> <span class="dv">40</span>,</span>
<span id="cb38-101"><a href="#cb38-101"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-102"><a href="#cb38-102"></a>    <span class="at">seed =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb38-103"><a href="#cb38-103"></a>  ),</span>
<span id="cb38-104"><a href="#cb38-104"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-105"><a href="#cb38-105"></a>    <span class="at">Model =</span> <span class="st">"PoDAR"</span>,</span>
<span id="cb38-106"><a href="#cb38-106"></a>    <span class="at">tau =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-107"><a href="#cb38-107"></a>    <span class="at">Mean =</span> <span class="dv">10</span>,</span>
<span id="cb38-108"><a href="#cb38-108"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-109"><a href="#cb38-109"></a>    <span class="at">seed =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb38-110"><a href="#cb38-110"></a>  ),</span>
<span id="cb38-111"><a href="#cb38-111"></a>  <span class="fu">dgm_generator</span>(</span>
<span id="cb38-112"><a href="#cb38-112"></a>    <span class="at">Model =</span> <span class="st">"PoDAR"</span>,</span>
<span id="cb38-113"><a href="#cb38-113"></a>    <span class="at">tau =</span> <span class="fl">0.4</span>,</span>
<span id="cb38-114"><a href="#cb38-114"></a>    <span class="at">Mean =</span> <span class="fl">1.</span>,</span>
<span id="cb38-115"><a href="#cb38-115"></a>    <span class="at">T =</span> ts.length,</span>
<span id="cb38-116"><a href="#cb38-116"></a>    <span class="at">seed =</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb38-117"><a href="#cb38-117"></a>  )</span>
<span id="cb38-118"><a href="#cb38-118"></a>)</span>
<span id="cb38-119"><a href="#cb38-119"></a></span>
<span id="cb38-120"><a href="#cb38-120"></a></span>
<span id="cb38-121"><a href="#cb38-121"></a>profile_podar <span class="ot">&lt;-</span> <span class="fu">plot_dgm.profile</span>(d.<span class="fl">3.</span>podar,</span>
<span id="cb38-122"><a href="#cb38-122"></a>                                  <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">"BuPu"</span>, <span class="at">n =</span> <span class="dv">9</span>)[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)],</span>
<span id="cb38-123"><a href="#cb38-123"></a>                                  <span class="st">"$</span><span class="sc">\\</span><span class="st">PoDAR(1)$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-43_f48fa2ea5960864044eeaa4aa058eecb">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="st">"Profile NAR.pdf"</span>,</span>
<span id="cb39-3"><a href="#cb39-3"></a>  profile_nar,</span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-5"><a href="#cb39-5"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span>,</span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>)</span>
<span id="cb39-9"><a href="#cb39-9"></a></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="st">"Profile Chi2AR.pdf"</span>,</span>
<span id="cb39-12"><a href="#cb39-12"></a>  profile_chiar,</span>
<span id="cb39-13"><a href="#cb39-13"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span>,</span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-16"><a href="#cb39-16"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-17"><a href="#cb39-17"></a>)</span>
<span id="cb39-18"><a href="#cb39-18"></a></span>
<span id="cb39-19"><a href="#cb39-19"></a></span>
<span id="cb39-20"><a href="#cb39-20"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-21"><a href="#cb39-21"></a>  <span class="st">"Profile BinAR.pdf"</span>,</span>
<span id="cb39-22"><a href="#cb39-22"></a>  profile_binar,</span>
<span id="cb39-23"><a href="#cb39-23"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-24"><a href="#cb39-24"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span>,</span>
<span id="cb39-25"><a href="#cb39-25"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-26"><a href="#cb39-26"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-27"><a href="#cb39-27"></a>)</span>
<span id="cb39-28"><a href="#cb39-28"></a></span>
<span id="cb39-29"><a href="#cb39-29"></a></span>
<span id="cb39-30"><a href="#cb39-30"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-31"><a href="#cb39-31"></a>  <span class="st">"Profile PoDAR.pdf"</span>,</span>
<span id="cb39-32"><a href="#cb39-32"></a>  profile_podar,</span>
<span id="cb39-33"><a href="#cb39-33"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-34"><a href="#cb39-34"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span>,</span>
<span id="cb39-35"><a href="#cb39-35"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-36"><a href="#cb39-36"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-37"><a href="#cb39-37"></a>)</span>
<span id="cb39-38"><a href="#cb39-38"></a></span>
<span id="cb39-39"><a href="#cb39-39"></a></span>
<span id="cb39-40"><a href="#cb39-40"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-41"><a href="#cb39-41"></a>  <span class="st">"Profile four DGMs.pdf"</span>,</span>
<span id="cb39-42"><a href="#cb39-42"></a>  profile_nar <span class="sc">/</span></span>
<span id="cb39-43"><a href="#cb39-43"></a>    profile_chiar <span class="sc">/</span></span>
<span id="cb39-44"><a href="#cb39-44"></a>    profile_binar <span class="sc">/</span></span>
<span id="cb39-45"><a href="#cb39-45"></a>    profile_podar,</span>
<span id="cb39-46"><a href="#cb39-46"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-47"><a href="#cb39-47"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">*</span> <span class="dv">4</span>,</span>
<span id="cb39-48"><a href="#cb39-48"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-49"><a href="#cb39-49"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-50"><a href="#cb39-50"></a>)</span>
<span id="cb39-51"><a href="#cb39-51"></a></span>
<span id="cb39-52"><a href="#cb39-52"></a></span>
<span id="cb39-53"><a href="#cb39-53"></a><span class="fu">ggsave</span>(</span>
<span id="cb39-54"><a href="#cb39-54"></a>  <span class="st">"Profile alternative DGMs.pdf"</span>,</span>
<span id="cb39-55"><a href="#cb39-55"></a>  profile_chiar <span class="sc">/</span></span>
<span id="cb39-56"><a href="#cb39-56"></a>    profile_binar <span class="sc">/</span></span>
<span id="cb39-57"><a href="#cb39-57"></a>    profile_podar,</span>
<span id="cb39-58"><a href="#cb39-58"></a>  <span class="at">path =</span> dir_plots,</span>
<span id="cb39-59"><a href="#cb39-59"></a>  <span class="at">height =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">1.8</span> <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb39-60"><a href="#cb39-60"></a>  <span class="at">width =</span> <span class="dv">21</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb39-61"><a href="#cb39-61"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb39-62"><a href="#cb39-62"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div>
<p>The generated time series plots of the AR(1) <a href="./figures/Profile%20NAR.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, <span class="math inline">\(\chi^2\)</span>AR(1) <a href="./figures/Profile%20Chi2AR.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, BinAR(1) <a href="./figures/Profile%20BinAR.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, and PoDAR(1) <a href="./figures/Profile%20PoDAR.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a> models are saved in the <code>figures</code> folder (see also combined plots, <a href="./figures/Profile%20alternative%20DGMs.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a> and <a href="./figures/Profile%20four%20DGMs.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>).</p>
</div>
</section>
<section id="sec-profiles-of-simulated-datasets" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-profiles-of-simulated-datasets"><span class="header-section-number">4.2</span> Profiles of the simulated datasets</h2>
<p>We read the first replication of simulated datasets with <span class="math inline">\(N = 100, T = 100\)</span> and plot using the function <code>plot_dataset.profile</code> (from <a href="#sec-make-distribution-plots">Section&nbsp;1.4.2</a>).</p>
<div class="cell" data-hash="Code-documentations_cache/html/unnamed-chunk-44_120acb41b2c8ffde72dbfbf4eb71c312">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Reading simulated datasets and saving in lists --------------------------</span></span>
<span id="cb40-2"><a href="#cb40-2"></a></span>
<span id="cb40-3"><a href="#cb40-3"></a>dgm_datasets_gaussian.means <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="at">nar =</span> <span class="st">"sim_uSeed-13330_l2.dist-Gaussian_Model-NAR"</span>,</span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="at">chiar =</span> <span class="st">"sim_uSeed-13297_l2.dist-Gaussian_Model-Chi2AR"</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="at">binar =</span> <span class="st">"sim_uSeed-13286_l2.dist-Gaussian_Model-BinAR"</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="at">podar =</span> <span class="st">"sim_uSeed-13319_l2.dist-Gaussian_Model-PoDAR"</span></span>
<span id="cb40-8"><a href="#cb40-8"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(x) <span class="fu">read_rds</span>(<span class="fu">paste0</span>(<span class="st">"simulation-files/sim-files/"</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>                                     x,</span>
<span id="cb40-11"><a href="#cb40-11"></a>                                     <span class="st">"_N-100_phi-0.4_T-100_sim.Seed-0_Rep-1.rds"</span>)))</span>
<span id="cb40-12"><a href="#cb40-12"></a></span>
<span id="cb40-13"><a href="#cb40-13"></a></span>
<span id="cb40-14"><a href="#cb40-14"></a>dgm_datasets_chi2.means <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="at">nar =</span> <span class="st">"sim_uSeed-13337_l2.dist-Chi2_Model-NAR"</span>,</span>
<span id="cb40-16"><a href="#cb40-16"></a>  <span class="at">chiar =</span> <span class="st">"sim_uSeed-13304_l2.dist-Chi2_Model-Chi2AR"</span>,</span>
<span id="cb40-17"><a href="#cb40-17"></a>  <span class="at">binar =</span> <span class="st">"sim_uSeed-13293_l2.dist-Chi2_Model-BinAR"</span>,</span>
<span id="cb40-18"><a href="#cb40-18"></a>  <span class="at">podar =</span> <span class="st">"sim_uSeed-13326_l2.dist-Chi2_Model-PoDAR"</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb40-20"><a href="#cb40-20"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(x) <span class="fu">read_rds</span>(<span class="fu">paste0</span>(<span class="st">"simulation-files/sim-files/"</span>,</span>
<span id="cb40-21"><a href="#cb40-21"></a>                                     x,</span>
<span id="cb40-22"><a href="#cb40-22"></a>                                     <span class="st">"_N-100_phi-0.4_T-100_sim.Seed-0_Rep-1.rds"</span>)))</span>
<span id="cb40-23"><a href="#cb40-23"></a></span>
<span id="cb40-24"><a href="#cb40-24"></a></span>
<span id="cb40-25"><a href="#cb40-25"></a></span>
<span id="cb40-26"><a href="#cb40-26"></a><span class="co"># Plot profiles per DGM ---------------------------------------------------</span></span>
<span id="cb40-27"><a href="#cb40-27"></a></span>
<span id="cb40-28"><a href="#cb40-28"></a>purrr<span class="sc">::</span><span class="fu">pwalk</span>(</span>
<span id="cb40-29"><a href="#cb40-29"></a>  <span class="fu">list</span>(</span>
<span id="cb40-30"><a href="#cb40-30"></a>    dgm_datasets_gaussian.means,</span>
<span id="cb40-31"><a href="#cb40-31"></a>    dgm_datasets_chi2.means,</span>
<span id="cb40-32"><a href="#cb40-32"></a>    <span class="fu">names</span>(dgm_datasets_gaussian.means)</span>
<span id="cb40-33"><a href="#cb40-33"></a>  ),</span>
<span id="cb40-34"><a href="#cb40-34"></a>  <span class="sc">~</span> <span class="fu">save_dataset_profile</span>(..<span class="dv">1</span>,</span>
<span id="cb40-35"><a href="#cb40-35"></a>                         ..<span class="dv">2</span>,</span>
<span id="cb40-36"><a href="#cb40-36"></a>                         <span class="fu">paste0</span>(<span class="st">"profiles-dataset-"</span>, ..<span class="dv">3</span>))</span>
<span id="cb40-37"><a href="#cb40-37"></a></span>
<span id="cb40-38"><a href="#cb40-38"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>
<p>The generated distribution plots of the AR(1) <a href="./figures/profiles-dataset-nar.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, <span class="math inline">\(\chi^2\)</span>AR(1) <a href="./figures/profiles-dataset-chiar.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, BinAR(1) <a href="./figures/profiles-dataset-binar.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a>, and PoDAR(1) <a href="./figures/profiles-dataset-podar.pdf"><i class="fa-solid fa-file-pdf" aria-label="file-pdf"></i></a> models are saved in the figures folder.</p>
</div>
</section>
<section id="sec-cogito-data-analysis" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-cogito-data-analysis"><span class="header-section-number">4.3</span> COGITO data analysis</h2>
<p>In the paper, we reported an analysis of distress time series in of the COGITO dataset <span class="citation" data-cites="schmiedek_2010_HundredDaysCognitive">Schmiedek, Lövdén, and Lindenberger (<a href="#ref-schmiedek_2010_HundredDaysCognitive" role="doc-biblioref">2010</a>)</span>. Because we are not allowed to make the dataset public, here we provide the <em>M</em>plus input script and the analysis output.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href=""><em>M</em>plus input</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href=""><em>M</em>plus output</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell" data-file="scripts/Mplus_cogito-distress.inp" data-hash="Code-documentations_cache/html/Mplus-input_cogito-distress_7b424be6783066b2f8652898abcda3ab">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource inp number-lines code-with-copy"><code class="sourceCode"><span id="cb41-1"><a href="#cb41-1"></a>TITLE:</span>
<span id="cb41-2"><a href="#cb41-2"></a>Multilevel AR(1) model of COGITO distress</span>
<span id="cb41-3"><a href="#cb41-3"></a></span>
<span id="cb41-4"><a href="#cb41-4"></a>DATA:</span>
<span id="cb41-5"><a href="#cb41-5"></a>FILE = "cogito-na1-distress.dat";</span>
<span id="cb41-6"><a href="#cb41-6"></a> </span>
<span id="cb41-7"><a href="#cb41-7"></a>VARIABLE:</span>
<span id="cb41-8"><a href="#cb41-8"></a></span>
<span id="cb41-9"><a href="#cb41-9"></a>NAMES = subject t x; </span>
<span id="cb41-10"><a href="#cb41-10"></a>MISSING=.;</span>
<span id="cb41-11"><a href="#cb41-11"></a>CLUSTER = subject;</span>
<span id="cb41-12"><a href="#cb41-12"></a>LAGGED = x(1);</span>
<span id="cb41-13"><a href="#cb41-13"></a>TINTERVAL = t(1);</span>
<span id="cb41-14"><a href="#cb41-14"></a></span>
<span id="cb41-15"><a href="#cb41-15"></a>ANALYSIS:</span>
<span id="cb41-16"><a href="#cb41-16"></a></span>
<span id="cb41-17"><a href="#cb41-17"></a>TYPE = TWOLEVEL RANDOM;</span>
<span id="cb41-18"><a href="#cb41-18"></a>ESTIMATOR = BAYES;</span>
<span id="cb41-19"><a href="#cb41-19"></a>PROCESSORS = 2;</span>
<span id="cb41-20"><a href="#cb41-20"></a>CHAINS = 2;</span>
<span id="cb41-21"><a href="#cb41-21"></a>THIN = 5;</span>
<span id="cb41-22"><a href="#cb41-22"></a>BITERATIONS = 5000(2000);</span>
<span id="cb41-23"><a href="#cb41-23"></a></span>
<span id="cb41-24"><a href="#cb41-24"></a>MODEL:</span>
<span id="cb41-25"><a href="#cb41-25"></a>%WITHIN%</span>
<span id="cb41-26"><a href="#cb41-26"></a>phi | x ON x&amp;1;</span>
<span id="cb41-27"><a href="#cb41-27"></a>logv | x;</span>
<span id="cb41-28"><a href="#cb41-28"></a></span>
<span id="cb41-29"><a href="#cb41-29"></a>%BETWEEN%</span>
<span id="cb41-30"><a href="#cb41-30"></a>x phi logv WITH x phi logv;</span>
<span id="cb41-31"><a href="#cb41-31"></a></span>
<span id="cb41-32"><a href="#cb41-32"></a>OUTPUT:</span>
<span id="cb41-33"><a href="#cb41-33"></a>TECH1 TECH2 TECH3 TECH8 FSCOMPARISON STANDARDIZED STDYX STDY;</span>
<span id="cb41-34"><a href="#cb41-34"></a></span>
<span id="cb41-35"><a href="#cb41-35"></a>PLOT:</span>
<span id="cb41-36"><a href="#cb41-36"></a>TYPE = PLOT3;</span>
<span id="cb41-37"><a href="#cb41-37"></a>FACTORS = ALL (500);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell" data-file="scripts/Mplus_cogito-distress.out" data-hash="Code-documentations_cache/html/Mplus-output_cogito_560b010d3f867da25a27de192c58758a">
<details>
<summary>Click to expand the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource out number-lines code-with-copy"><code class="sourceCode"><span id="cb42-1"><a href="#cb42-1"></a>Mplus VERSION 8.6</span>
<span id="cb42-2"><a href="#cb42-2"></a>MUTHEN &amp; MUTHEN</span>
<span id="cb42-3"><a href="#cb42-3"></a>09/28/2022   1:15 PM</span>
<span id="cb42-4"><a href="#cb42-4"></a></span>
<span id="cb42-5"><a href="#cb42-5"></a>INPUT INSTRUCTIONS</span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>  TITLE:</span>
<span id="cb42-8"><a href="#cb42-8"></a>  Multilevel AR(1) model of COGITO distress</span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a>  DATA:</span>
<span id="cb42-11"><a href="#cb42-11"></a>  FILE = "cogito-na1-distress.dat";</span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a>  VARIABLE:</span>
<span id="cb42-14"><a href="#cb42-14"></a></span>
<span id="cb42-15"><a href="#cb42-15"></a>  NAMES = subject t x;</span>
<span id="cb42-16"><a href="#cb42-16"></a>  MISSING=.;</span>
<span id="cb42-17"><a href="#cb42-17"></a>  CLUSTER = subject;</span>
<span id="cb42-18"><a href="#cb42-18"></a>  LAGGED = x(1);</span>
<span id="cb42-19"><a href="#cb42-19"></a>  TINTERVAL = t(1);</span>
<span id="cb42-20"><a href="#cb42-20"></a></span>
<span id="cb42-21"><a href="#cb42-21"></a>  ANALYSIS:</span>
<span id="cb42-22"><a href="#cb42-22"></a></span>
<span id="cb42-23"><a href="#cb42-23"></a>  TYPE = TWOLEVEL RANDOM;</span>
<span id="cb42-24"><a href="#cb42-24"></a>  ESTIMATOR = BAYES;</span>
<span id="cb42-25"><a href="#cb42-25"></a>  PROCESSORS = 2;</span>
<span id="cb42-26"><a href="#cb42-26"></a>  CHAINS = 2;</span>
<span id="cb42-27"><a href="#cb42-27"></a>  THIN = 5;</span>
<span id="cb42-28"><a href="#cb42-28"></a>  BITERATIONS = 5000(2000);</span>
<span id="cb42-29"><a href="#cb42-29"></a></span>
<span id="cb42-30"><a href="#cb42-30"></a>  MODEL:</span>
<span id="cb42-31"><a href="#cb42-31"></a>  %WITHIN%</span>
<span id="cb42-32"><a href="#cb42-32"></a>  phi | x ON x&amp;1;</span>
<span id="cb42-33"><a href="#cb42-33"></a>  logv | x;</span>
<span id="cb42-34"><a href="#cb42-34"></a></span>
<span id="cb42-35"><a href="#cb42-35"></a>  %BETWEEN%</span>
<span id="cb42-36"><a href="#cb42-36"></a>  x phi logv WITH x phi logv;</span>
<span id="cb42-37"><a href="#cb42-37"></a></span>
<span id="cb42-38"><a href="#cb42-38"></a>  OUTPUT:</span>
<span id="cb42-39"><a href="#cb42-39"></a>  TECH1 TECH2 TECH3 TECH8 FSCOMPARISON STANDARDIZED STDYX STDY;</span>
<span id="cb42-40"><a href="#cb42-40"></a></span>
<span id="cb42-41"><a href="#cb42-41"></a>  PLOT:</span>
<span id="cb42-42"><a href="#cb42-42"></a>  TYPE = PLOT3;</span>
<span id="cb42-43"><a href="#cb42-43"></a>  FACTORS = ALL (500);</span>
<span id="cb42-44"><a href="#cb42-44"></a></span>
<span id="cb42-45"><a href="#cb42-45"></a></span>
<span id="cb42-46"><a href="#cb42-46"></a></span>
<span id="cb42-47"><a href="#cb42-47"></a>*** WARNING</span>
<span id="cb42-48"><a href="#cb42-48"></a>  One or more individual-level variables have no variation within a</span>
<span id="cb42-49"><a href="#cb42-49"></a>  cluster for the following clusters.</span>
<span id="cb42-50"><a href="#cb42-50"></a></span>
<span id="cb42-51"><a href="#cb42-51"></a>     Variable   Cluster IDs with no within-cluster variation</span>
<span id="cb42-52"><a href="#cb42-52"></a></span>
<span id="cb42-53"><a href="#cb42-53"></a>      X           46 176 189 141 184 122 90 81 39 48 177 108 178 63 170 159 54 28 68 55 31 112</span>
<span id="cb42-54"><a href="#cb42-54"></a>                  77 93 117 165 40 84</span>
<span id="cb42-55"><a href="#cb42-55"></a>      X&amp;1         46 176 189 141 184 122 90 81 39 48 177 108 178 63 170 159 54 28 68 55 31 112</span>
<span id="cb42-56"><a href="#cb42-56"></a>                  77 93 117 165 40 84</span>
<span id="cb42-57"><a href="#cb42-57"></a></span>
<span id="cb42-58"><a href="#cb42-58"></a>   1 WARNING(S) FOUND IN THE INPUT INSTRUCTIONS</span>
<span id="cb42-59"><a href="#cb42-59"></a></span>
<span id="cb42-60"><a href="#cb42-60"></a></span>
<span id="cb42-61"><a href="#cb42-61"></a></span>
<span id="cb42-62"><a href="#cb42-62"></a></span>
<span id="cb42-63"><a href="#cb42-63"></a>Multilevel AR(1) model of COGITO distress</span>
<span id="cb42-64"><a href="#cb42-64"></a></span>
<span id="cb42-65"><a href="#cb42-65"></a>SUMMARY OF ANALYSIS</span>
<span id="cb42-66"><a href="#cb42-66"></a></span>
<span id="cb42-67"><a href="#cb42-67"></a>Number of groups                                                 1</span>
<span id="cb42-68"><a href="#cb42-68"></a>Number of observations                                       32518</span>
<span id="cb42-69"><a href="#cb42-69"></a></span>
<span id="cb42-70"><a href="#cb42-70"></a>Number of dependent variables                                    1</span>
<span id="cb42-71"><a href="#cb42-71"></a>Number of independent variables                                  1</span>
<span id="cb42-72"><a href="#cb42-72"></a>Number of continuous latent variables                            2</span>
<span id="cb42-73"><a href="#cb42-73"></a></span>
<span id="cb42-74"><a href="#cb42-74"></a>Observed dependent variables</span>
<span id="cb42-75"><a href="#cb42-75"></a></span>
<span id="cb42-76"><a href="#cb42-76"></a>  Continuous</span>
<span id="cb42-77"><a href="#cb42-77"></a>   X</span>
<span id="cb42-78"><a href="#cb42-78"></a></span>
<span id="cb42-79"><a href="#cb42-79"></a>Observed independent variables</span>
<span id="cb42-80"><a href="#cb42-80"></a>   X&amp;1</span>
<span id="cb42-81"><a href="#cb42-81"></a></span>
<span id="cb42-82"><a href="#cb42-82"></a>Continuous latent variables</span>
<span id="cb42-83"><a href="#cb42-83"></a>   PHI         LOGV</span>
<span id="cb42-84"><a href="#cb42-84"></a></span>
<span id="cb42-85"><a href="#cb42-85"></a>Variables with special functions</span>
<span id="cb42-86"><a href="#cb42-86"></a></span>
<span id="cb42-87"><a href="#cb42-87"></a>  Cluster variable      SUBJECT</span>
<span id="cb42-88"><a href="#cb42-88"></a></span>
<span id="cb42-89"><a href="#cb42-89"></a>  Within variables</span>
<span id="cb42-90"><a href="#cb42-90"></a>   X&amp;1</span>
<span id="cb42-91"><a href="#cb42-91"></a></span>
<span id="cb42-92"><a href="#cb42-92"></a></span>
<span id="cb42-93"><a href="#cb42-93"></a>Estimator                                                    BAYES</span>
<span id="cb42-94"><a href="#cb42-94"></a>Specifications for Bayesian Estimation</span>
<span id="cb42-95"><a href="#cb42-95"></a>  Point estimate                                            MEDIAN</span>
<span id="cb42-96"><a href="#cb42-96"></a>  Number of Markov chain Monte Carlo (MCMC) chains               2</span>
<span id="cb42-97"><a href="#cb42-97"></a>  Random seed for the first chain                                0</span>
<span id="cb42-98"><a href="#cb42-98"></a>  Starting value information                           UNPERTURBED</span>
<span id="cb42-99"><a href="#cb42-99"></a>  Algorithm used for Markov chain Monte Carlo           GIBBS(PX1)</span>
<span id="cb42-100"><a href="#cb42-100"></a>  Convergence criterion                                  0.500D-01</span>
<span id="cb42-101"><a href="#cb42-101"></a>  Maximum number of iterations                                5000</span>
<span id="cb42-102"><a href="#cb42-102"></a>  K-th iteration used for thinning                               5</span>
<span id="cb42-103"><a href="#cb42-103"></a>Specifications for Bayes Factor Score Estimation</span>
<span id="cb42-104"><a href="#cb42-104"></a>  Number of imputed data sets                                  500</span>
<span id="cb42-105"><a href="#cb42-105"></a>  Iteration intervals for thinning                               1</span>
<span id="cb42-106"><a href="#cb42-106"></a></span>
<span id="cb42-107"><a href="#cb42-107"></a>Input data file(s)</span>
<span id="cb42-108"><a href="#cb42-108"></a>  cogito-na1-distress.dat</span>
<span id="cb42-109"><a href="#cb42-109"></a>Input data format  FREE</span>
<span id="cb42-110"><a href="#cb42-110"></a></span>
<span id="cb42-111"><a href="#cb42-111"></a></span>
<span id="cb42-112"><a href="#cb42-112"></a>SUMMARY OF DATA</span>
<span id="cb42-113"><a href="#cb42-113"></a></span>
<span id="cb42-114"><a href="#cb42-114"></a>     Number of clusters                        204</span>
<span id="cb42-115"><a href="#cb42-115"></a></span>
<span id="cb42-116"><a href="#cb42-116"></a>       Size (s)    Cluster ID with Size s</span>
<span id="cb42-117"><a href="#cb42-117"></a></span>
<span id="cb42-118"><a href="#cb42-118"></a>        114        45</span>
<span id="cb42-119"><a href="#cb42-119"></a>        117        22</span>
<span id="cb42-120"><a href="#cb42-120"></a>        121        65 195</span>
<span id="cb42-121"><a href="#cb42-121"></a>        123        64</span>
<span id="cb42-122"><a href="#cb42-122"></a>        124        102 73</span>
<span id="cb42-123"><a href="#cb42-123"></a>        125        143</span>
<span id="cb42-124"><a href="#cb42-124"></a>        127        46 43 156 176 78</span>
<span id="cb42-125"><a href="#cb42-125"></a>        128        154 189 44</span>
<span id="cb42-126"><a href="#cb42-126"></a>        129        89 57 131</span>
<span id="cb42-127"><a href="#cb42-127"></a>        130        80 133 168 141 118 147</span>
<span id="cb42-128"><a href="#cb42-128"></a>        131        139 181 184 186 144 49</span>
<span id="cb42-129"><a href="#cb42-129"></a>        132        127 146 122 196</span>
<span id="cb42-130"><a href="#cb42-130"></a>        133        61 153 7</span>
<span id="cb42-131"><a href="#cb42-131"></a>        134        90 81 39</span>
<span id="cb42-132"><a href="#cb42-132"></a>        135        48 132</span>
<span id="cb42-133"><a href="#cb42-133"></a>        136        150 193 98 18</span>
<span id="cb42-134"><a href="#cb42-134"></a>        137        94 30 177 24 106</span>
<span id="cb42-135"><a href="#cb42-135"></a>        138        128 23 187 10 151 152 108</span>
<span id="cb42-136"><a href="#cb42-136"></a>        139        164 20</span>
<span id="cb42-137"><a href="#cb42-137"></a>        140        182 1</span>
<span id="cb42-138"><a href="#cb42-138"></a>        141        87 53 36 136 178 51 149</span>
<span id="cb42-139"><a href="#cb42-139"></a>        142        63 170 140 114 50 161 130 198 202</span>
<span id="cb42-140"><a href="#cb42-140"></a>        143        88 82 14 137</span>
<span id="cb42-141"><a href="#cb42-141"></a>        144        120 29 115 2 172 197 185 159</span>
<span id="cb42-142"><a href="#cb42-142"></a>        145        17 109 101 138</span>
<span id="cb42-143"><a href="#cb42-143"></a>        146        54 37</span>
<span id="cb42-144"><a href="#cb42-144"></a>        148        96</span>
<span id="cb42-145"><a href="#cb42-145"></a>        149        129 166 3</span>
<span id="cb42-146"><a href="#cb42-146"></a>        150        134 155 4 19 104 191</span>
<span id="cb42-147"><a href="#cb42-147"></a>        151        16 92 28</span>
<span id="cb42-148"><a href="#cb42-148"></a>        152        121 68 55 31</span>
<span id="cb42-149"><a href="#cb42-149"></a>        153        6</span>
<span id="cb42-150"><a href="#cb42-150"></a>        154        112 192</span>
<span id="cb42-151"><a href="#cb42-151"></a>        155        163 13 70</span>
<span id="cb42-152"><a href="#cb42-152"></a>        156        180 5 107 59</span>
<span id="cb42-153"><a href="#cb42-153"></a>        157        83 86 77 12 26 9 41</span>
<span id="cb42-154"><a href="#cb42-154"></a>        158        160</span>
<span id="cb42-155"><a href="#cb42-155"></a>        159        38</span>
<span id="cb42-156"><a href="#cb42-156"></a>        160        105 67 66 173 174 75</span>
<span id="cb42-157"><a href="#cb42-157"></a>        162        11</span>
<span id="cb42-158"><a href="#cb42-158"></a>        163        103 200 35</span>
<span id="cb42-159"><a href="#cb42-159"></a>        164        142 99</span>
<span id="cb42-160"><a href="#cb42-160"></a>        165        190 188</span>
<span id="cb42-161"><a href="#cb42-161"></a>        166        126 72 148 113</span>
<span id="cb42-162"><a href="#cb42-162"></a>        167        93</span>
<span id="cb42-163"><a href="#cb42-163"></a>        168        56</span>
<span id="cb42-164"><a href="#cb42-164"></a>        171        60</span>
<span id="cb42-165"><a href="#cb42-165"></a>        172        124</span>
<span id="cb42-166"><a href="#cb42-166"></a>        173        169 97 15 183 25</span>
<span id="cb42-167"><a href="#cb42-167"></a>        174        91</span>
<span id="cb42-168"><a href="#cb42-168"></a>        177        27 71</span>
<span id="cb42-169"><a href="#cb42-169"></a>        178        117</span>
<span id="cb42-170"><a href="#cb42-170"></a>        179        175</span>
<span id="cb42-171"><a href="#cb42-171"></a>        180        8 204</span>
<span id="cb42-172"><a href="#cb42-172"></a>        183        47 111</span>
<span id="cb42-173"><a href="#cb42-173"></a>        185        79</span>
<span id="cb42-174"><a href="#cb42-174"></a>        186        76 165</span>
<span id="cb42-175"><a href="#cb42-175"></a>        188        69</span>
<span id="cb42-176"><a href="#cb42-176"></a>        189        194</span>
<span id="cb42-177"><a href="#cb42-177"></a>        190        110</span>
<span id="cb42-178"><a href="#cb42-178"></a>        192        100 145 52 21</span>
<span id="cb42-179"><a href="#cb42-179"></a>        193        119</span>
<span id="cb42-180"><a href="#cb42-180"></a>        197        62 42</span>
<span id="cb42-181"><a href="#cb42-181"></a>        198        116</span>
<span id="cb42-182"><a href="#cb42-182"></a>        200        157</span>
<span id="cb42-183"><a href="#cb42-183"></a>        201        203</span>
<span id="cb42-184"><a href="#cb42-184"></a>        204        74 199</span>
<span id="cb42-185"><a href="#cb42-185"></a>        205        34</span>
<span id="cb42-186"><a href="#cb42-186"></a>        206        135</span>
<span id="cb42-187"><a href="#cb42-187"></a>        211        162</span>
<span id="cb42-188"><a href="#cb42-188"></a>        212        123</span>
<span id="cb42-189"><a href="#cb42-189"></a>        214        40</span>
<span id="cb42-190"><a href="#cb42-190"></a>        220        95</span>
<span id="cb42-191"><a href="#cb42-191"></a>        227        125</span>
<span id="cb42-192"><a href="#cb42-192"></a>        238        171</span>
<span id="cb42-193"><a href="#cb42-193"></a>        239        201</span>
<span id="cb42-194"><a href="#cb42-194"></a>        250        167</span>
<span id="cb42-195"><a href="#cb42-195"></a>        262        179 32</span>
<span id="cb42-196"><a href="#cb42-196"></a>        265        85</span>
<span id="cb42-197"><a href="#cb42-197"></a>        276        84</span>
<span id="cb42-198"><a href="#cb42-198"></a>        303        33</span>
<span id="cb42-199"><a href="#cb42-199"></a>        306        58</span>
<span id="cb42-200"><a href="#cb42-200"></a>        373        158</span>
<span id="cb42-201"><a href="#cb42-201"></a></span>
<span id="cb42-202"><a href="#cb42-202"></a></span>
<span id="cb42-203"><a href="#cb42-203"></a></span>
<span id="cb42-204"><a href="#cb42-204"></a>SUMMARY OF MISSING DATA PATTERNS</span>
<span id="cb42-205"><a href="#cb42-205"></a></span>
<span id="cb42-206"><a href="#cb42-206"></a>     Number of missing data patterns             4</span>
<span id="cb42-207"><a href="#cb42-207"></a></span>
<span id="cb42-208"><a href="#cb42-208"></a>     MISSING DATA PATTERNS (x = not missing)</span>
<span id="cb42-209"><a href="#cb42-209"></a></span>
<span id="cb42-210"><a href="#cb42-210"></a>           1  2  3  4</span>
<span id="cb42-211"><a href="#cb42-211"></a> X         x  x</span>
<span id="cb42-212"><a href="#cb42-212"></a> X&amp;1       x     x</span>
<span id="cb42-213"><a href="#cb42-213"></a></span>
<span id="cb42-214"><a href="#cb42-214"></a>     MISSING DATA PATTERN FREQUENCIES</span>
<span id="cb42-215"><a href="#cb42-215"></a></span>
<span id="cb42-216"><a href="#cb42-216"></a>    Pattern   Frequency     Pattern   Frequency     Pattern   Frequency</span>
<span id="cb42-217"><a href="#cb42-217"></a>          1       15032           3        5301</span>
<span id="cb42-218"><a href="#cb42-218"></a>          2        5505           4        6680</span>
<span id="cb42-219"><a href="#cb42-219"></a></span>
<span id="cb42-220"><a href="#cb42-220"></a></span>
<span id="cb42-221"><a href="#cb42-221"></a>COVARIANCE COVERAGE OF DATA</span>
<span id="cb42-222"><a href="#cb42-222"></a></span>
<span id="cb42-223"><a href="#cb42-223"></a>Minimum covariance coverage value   0.100</span>
<span id="cb42-224"><a href="#cb42-224"></a></span>
<span id="cb42-225"><a href="#cb42-225"></a>     PROPORTION OF DATA PRESENT</span>
<span id="cb42-226"><a href="#cb42-226"></a></span>
<span id="cb42-227"><a href="#cb42-227"></a>           Covariance Coverage</span>
<span id="cb42-228"><a href="#cb42-228"></a>              X</span>
<span id="cb42-229"><a href="#cb42-229"></a>              ________</span>
<span id="cb42-230"><a href="#cb42-230"></a> X              0.632</span>
<span id="cb42-231"><a href="#cb42-231"></a></span>
<span id="cb42-232"><a href="#cb42-232"></a></span>
<span id="cb42-233"><a href="#cb42-233"></a></span>
<span id="cb42-234"><a href="#cb42-234"></a>UNIVARIATE SAMPLE STATISTICS</span>
<span id="cb42-235"><a href="#cb42-235"></a></span>
<span id="cb42-236"><a href="#cb42-236"></a>     UNIVARIATE HIGHER-ORDER MOMENT DESCRIPTIVE STATISTICS</span>
<span id="cb42-237"><a href="#cb42-237"></a></span>
<span id="cb42-238"><a href="#cb42-238"></a>         Variable/         Mean/     Skewness/   Minimum/ % with                Percentiles</span>
<span id="cb42-239"><a href="#cb42-239"></a>        Sample Size      Variance    Kurtosis    Maximum  Min/Max      20%/60%    40%/80%    Median</span>
<span id="cb42-240"><a href="#cb42-240"></a></span>
<span id="cb42-241"><a href="#cb42-241"></a>     X                     0.892       1.843       0.000   62.19%       0.000      0.000      0.000</span>
<span id="cb42-242"><a href="#cb42-242"></a>           20537.000       2.101       3.178       7.000    0.84%       0.000      2.000</span>
<span id="cb42-243"><a href="#cb42-243"></a></span>
<span id="cb42-244"><a href="#cb42-244"></a>     WARNING: PROBLEMS OCCURRED IN SEVERAL ITERATIONS IN THE COMPUTATION OF THE STANDARDIZED ESTIMATES FOR SEVERAL</span>
<span id="cb42-245"><a href="#cb42-245"></a>     CLUSTERS. THIS IS MOST LIKELY DUE TO AR COEFFICIENTS GREATER THAN 1 OR PARAMETERS GIVING NON-STATIONARY MODELS.</span>
<span id="cb42-246"><a href="#cb42-246"></a>     SUCH POSTERIOR DRAWS ARE REMOVED. THE FOLLOWING CLUSTERS HAD SUCH PROBLEMS:</span>
<span id="cb42-247"><a href="#cb42-247"></a>          202</span>
<span id="cb42-248"><a href="#cb42-248"></a></span>
<span id="cb42-249"><a href="#cb42-249"></a>THE MODEL ESTIMATION TERMINATED NORMALLY</span>
<span id="cb42-250"><a href="#cb42-250"></a></span>
<span id="cb42-251"><a href="#cb42-251"></a>     USE THE FBITERATIONS OPTION TO INCREASE THE NUMBER OF ITERATIONS BY A FACTOR</span>
<span id="cb42-252"><a href="#cb42-252"></a>     OF AT LEAST TWO TO CHECK CONVERGENCE AND THAT THE PSR VALUE DOES NOT INCREASE.</span>
<span id="cb42-253"><a href="#cb42-253"></a></span>
<span id="cb42-254"><a href="#cb42-254"></a></span>
<span id="cb42-255"><a href="#cb42-255"></a></span>
<span id="cb42-256"><a href="#cb42-256"></a>MODEL FIT INFORMATION</span>
<span id="cb42-257"><a href="#cb42-257"></a></span>
<span id="cb42-258"><a href="#cb42-258"></a>Number of Free Parameters                               9</span>
<span id="cb42-259"><a href="#cb42-259"></a></span>
<span id="cb42-260"><a href="#cb42-260"></a>Information Criteria</span>
<span id="cb42-261"><a href="#cb42-261"></a></span>
<span id="cb42-262"><a href="#cb42-262"></a>          Deviance (DIC)                        61653.300</span>
<span id="cb42-263"><a href="#cb42-263"></a>          Estimated Number of Parameters (pD)   12317.423</span>
<span id="cb42-264"><a href="#cb42-264"></a></span>
<span id="cb42-265"><a href="#cb42-265"></a></span>
<span id="cb42-266"><a href="#cb42-266"></a></span>
<span id="cb42-267"><a href="#cb42-267"></a>MODEL RESULTS</span>
<span id="cb42-268"><a href="#cb42-268"></a></span>
<span id="cb42-269"><a href="#cb42-269"></a>                                Posterior  One-Tailed         95% C.I.</span>
<span id="cb42-270"><a href="#cb42-270"></a>                    Estimate       S.D.      P-Value   Lower 2.5%  Upper 2.5%  Significance</span>
<span id="cb42-271"><a href="#cb42-271"></a></span>
<span id="cb42-272"><a href="#cb42-272"></a>Within Level</span>
<span id="cb42-273"><a href="#cb42-273"></a></span>
<span id="cb42-274"><a href="#cb42-274"></a>Between Level</span>
<span id="cb42-275"><a href="#cb42-275"></a></span>
<span id="cb42-276"><a href="#cb42-276"></a> X        WITH</span>
<span id="cb42-277"><a href="#cb42-277"></a>    PHI                0.118       0.020      0.000       0.082       0.157      *</span>
<span id="cb42-278"><a href="#cb42-278"></a>    LOGV               1.370       0.192      0.000       1.030       1.776      *</span>
<span id="cb42-279"><a href="#cb42-279"></a></span>
<span id="cb42-280"><a href="#cb42-280"></a> PHI      WITH</span>
<span id="cb42-281"><a href="#cb42-281"></a>    LOGV               0.234       0.047      0.000       0.150       0.338      *</span>
<span id="cb42-282"><a href="#cb42-282"></a></span>
<span id="cb42-283"><a href="#cb42-283"></a> Means</span>
<span id="cb42-284"><a href="#cb42-284"></a>    X                  0.866       0.067      0.000       0.732       0.997      *</span>
<span id="cb42-285"><a href="#cb42-285"></a>    PHI                0.217       0.017      0.000       0.182       0.249      *</span>
<span id="cb42-286"><a href="#cb42-286"></a>    LOGV              -1.314       0.168      0.000      -1.641      -0.983      *</span>
<span id="cb42-287"><a href="#cb42-287"></a></span>
<span id="cb42-288"><a href="#cb42-288"></a> Variances</span>
<span id="cb42-289"><a href="#cb42-289"></a>    X                  0.888       0.094      0.000       0.727       1.105      *</span>
<span id="cb42-290"><a href="#cb42-290"></a>    PHI                0.052       0.006      0.000       0.041       0.066      *</span>
<span id="cb42-291"><a href="#cb42-291"></a>    LOGV               5.745       0.576      0.000       4.754       7.000      *</span>
<span id="cb42-292"><a href="#cb42-292"></a></span>
<span id="cb42-293"><a href="#cb42-293"></a></span>
<span id="cb42-294"><a href="#cb42-294"></a>STANDARDIZED MODEL RESULTS</span>
<span id="cb42-295"><a href="#cb42-295"></a></span>
<span id="cb42-296"><a href="#cb42-296"></a></span>
<span id="cb42-297"><a href="#cb42-297"></a>STDYX Standardization</span>
<span id="cb42-298"><a href="#cb42-298"></a></span>
<span id="cb42-299"><a href="#cb42-299"></a>                                Posterior  One-Tailed         95% C.I.</span>
<span id="cb42-300"><a href="#cb42-300"></a>                    Estimate       S.D.      P-Value   Lower 2.5%  Upper 2.5%  Significance</span>
<span id="cb42-301"><a href="#cb42-301"></a></span>
<span id="cb42-302"><a href="#cb42-302"></a>Within-Level Standardized Estimates Averaged Over Clusters</span>
<span id="cb42-303"><a href="#cb42-303"></a></span>
<span id="cb42-304"><a href="#cb42-304"></a> PHI | X ON</span>
<span id="cb42-305"><a href="#cb42-305"></a>    X&amp;1                0.217       0.008      0.000       0.202       0.232      *</span>
<span id="cb42-306"><a href="#cb42-306"></a></span>
<span id="cb42-307"><a href="#cb42-307"></a> LOGV |</span>
<span id="cb42-308"><a href="#cb42-308"></a>    X                  0.903       0.004      0.000       0.894       0.911      *</span>
<span id="cb42-309"><a href="#cb42-309"></a></span>
<span id="cb42-310"><a href="#cb42-310"></a>Between Level</span>
<span id="cb42-311"><a href="#cb42-311"></a></span>
<span id="cb42-312"><a href="#cb42-312"></a> X        WITH</span>
<span id="cb42-313"><a href="#cb42-313"></a>    PHI                0.551       0.062      0.000       0.415       0.659      *</span>
<span id="cb42-314"><a href="#cb42-314"></a>    LOGV               0.607       0.046      0.000       0.506       0.689      *</span>
<span id="cb42-315"><a href="#cb42-315"></a></span>
<span id="cb42-316"><a href="#cb42-316"></a> PHI      WITH</span>
<span id="cb42-317"><a href="#cb42-317"></a>    LOGV               0.435       0.067      0.000       0.295       0.560      *</span>
<span id="cb42-318"><a href="#cb42-318"></a></span>
<span id="cb42-319"><a href="#cb42-319"></a> Means</span>
<span id="cb42-320"><a href="#cb42-320"></a>    X                  0.918       0.084      0.000       0.753       1.078      *</span>
<span id="cb42-321"><a href="#cb42-321"></a>    PHI                0.955       0.097      0.000       0.756       1.140      *</span>
<span id="cb42-322"><a href="#cb42-322"></a>    LOGV              -0.549       0.075      0.000      -0.700      -0.402      *</span>
<span id="cb42-323"><a href="#cb42-323"></a></span>
<span id="cb42-324"><a href="#cb42-324"></a> Variances</span>
<span id="cb42-325"><a href="#cb42-325"></a>    X                  1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-326"><a href="#cb42-326"></a>    PHI                1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-327"><a href="#cb42-327"></a>    LOGV               1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-328"><a href="#cb42-328"></a></span>
<span id="cb42-329"><a href="#cb42-329"></a></span>
<span id="cb42-330"><a href="#cb42-330"></a>STDY Standardization</span>
<span id="cb42-331"><a href="#cb42-331"></a></span>
<span id="cb42-332"><a href="#cb42-332"></a>                                Posterior  One-Tailed         95% C.I.</span>
<span id="cb42-333"><a href="#cb42-333"></a>                    Estimate       S.D.      P-Value   Lower 2.5%  Upper 2.5%  Significance</span>
<span id="cb42-334"><a href="#cb42-334"></a></span>
<span id="cb42-335"><a href="#cb42-335"></a>Within-Level Standardized Estimates Averaged Over Clusters</span>
<span id="cb42-336"><a href="#cb42-336"></a></span>
<span id="cb42-337"><a href="#cb42-337"></a> PHI | X ON</span>
<span id="cb42-338"><a href="#cb42-338"></a>    X&amp;1                0.321       0.067      0.000       0.191       0.458      *</span>
<span id="cb42-339"><a href="#cb42-339"></a></span>
<span id="cb42-340"><a href="#cb42-340"></a> LOGV |</span>
<span id="cb42-341"><a href="#cb42-341"></a>    X                  0.903       0.004      0.000       0.894       0.911      *</span>
<span id="cb42-342"><a href="#cb42-342"></a></span>
<span id="cb42-343"><a href="#cb42-343"></a>Between Level</span>
<span id="cb42-344"><a href="#cb42-344"></a></span>
<span id="cb42-345"><a href="#cb42-345"></a> X        WITH</span>
<span id="cb42-346"><a href="#cb42-346"></a>    PHI                0.551       0.062      0.000       0.415       0.659      *</span>
<span id="cb42-347"><a href="#cb42-347"></a>    LOGV               0.607       0.046      0.000       0.506       0.689      *</span>
<span id="cb42-348"><a href="#cb42-348"></a></span>
<span id="cb42-349"><a href="#cb42-349"></a> PHI      WITH</span>
<span id="cb42-350"><a href="#cb42-350"></a>    LOGV               0.435       0.067      0.000       0.295       0.560      *</span>
<span id="cb42-351"><a href="#cb42-351"></a></span>
<span id="cb42-352"><a href="#cb42-352"></a> Means</span>
<span id="cb42-353"><a href="#cb42-353"></a>    X                  0.918       0.084      0.000       0.753       1.078      *</span>
<span id="cb42-354"><a href="#cb42-354"></a>    PHI                0.955       0.097      0.000       0.756       1.140      *</span>
<span id="cb42-355"><a href="#cb42-355"></a>    LOGV              -0.549       0.075      0.000      -0.700      -0.402      *</span>
<span id="cb42-356"><a href="#cb42-356"></a></span>
<span id="cb42-357"><a href="#cb42-357"></a> Variances</span>
<span id="cb42-358"><a href="#cb42-358"></a>    X                  1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-359"><a href="#cb42-359"></a>    PHI                1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-360"><a href="#cb42-360"></a>    LOGV               1.000       0.000      0.000       1.000       1.000</span>
<span id="cb42-361"><a href="#cb42-361"></a></span>
<span id="cb42-362"><a href="#cb42-362"></a></span>
<span id="cb42-363"><a href="#cb42-363"></a>R-SQUARE</span>
<span id="cb42-364"><a href="#cb42-364"></a></span>
<span id="cb42-365"><a href="#cb42-365"></a>Within-Level R-Square Averaged Across Clusters</span>
<span id="cb42-366"><a href="#cb42-366"></a></span>
<span id="cb42-367"><a href="#cb42-367"></a>                                Posterior  One-Tailed         95% C.I.</span>
<span id="cb42-368"><a href="#cb42-368"></a>    Variable        Estimate       S.D.      P-Value   Lower 2.5%  Upper 2.5%</span>
<span id="cb42-369"><a href="#cb42-369"></a></span>
<span id="cb42-370"><a href="#cb42-370"></a>    X                  0.097       0.004      0.000       0.089       0.106</span>
<span id="cb42-371"><a href="#cb42-371"></a></span>
<span id="cb42-372"><a href="#cb42-372"></a></span>
<span id="cb42-373"><a href="#cb42-373"></a>BETWEEN-LEVEL FACTOR SCORE COMPARISONS</span>
<span id="cb42-374"><a href="#cb42-374"></a></span>
<span id="cb42-375"><a href="#cb42-375"></a> Results for Factor PHI</span>
<span id="cb42-376"><a href="#cb42-376"></a></span>
<span id="cb42-377"><a href="#cb42-377"></a> Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score</span>
<span id="cb42-378"><a href="#cb42-378"></a>     1       202          0.983           2         1          0.754           3       179          0.696</span>
<span id="cb42-379"><a href="#cb42-379"></a>     4         5          0.676           5       149          0.663           6       129          0.636</span>
<span id="cb42-380"><a href="#cb42-380"></a>     7        85          0.633           8        87          0.626           9       147          0.620</span>
<span id="cb42-381"><a href="#cb42-381"></a>    10        92          0.610          11       167          0.573          12        88          0.567</span>
<span id="cb42-382"><a href="#cb42-382"></a>    13        23          0.559          14        97          0.554          15       142          0.550</span>
<span id="cb42-383"><a href="#cb42-383"></a>    16        44          0.544          17       150          0.521          18       183          0.518</span>
<span id="cb42-384"><a href="#cb42-384"></a>    19       201          0.514          20        12          0.511          21        64          0.508</span>
<span id="cb42-385"><a href="#cb42-385"></a>    22       107          0.499          23       119          0.491          24        35          0.491</span>
<span id="cb42-386"><a href="#cb42-386"></a>    25        70          0.481          26       124          0.475          27       204          0.458</span>
<span id="cb42-387"><a href="#cb42-387"></a>    28        73          0.449          29       110          0.443          30       143          0.441</span>
<span id="cb42-388"><a href="#cb42-388"></a>    31        65          0.437          32        22          0.433          33        37          0.433</span>
<span id="cb42-389"><a href="#cb42-389"></a>    34       154          0.431          35        75          0.427          36       196          0.424</span>
<span id="cb42-390"><a href="#cb42-390"></a>    37         8          0.422          38       198          0.405          39        25          0.396</span>
<span id="cb42-391"><a href="#cb42-391"></a>    40       200          0.391          41        59          0.389          42       188          0.388</span>
<span id="cb42-392"><a href="#cb42-392"></a>    43        30          0.379          44       136          0.376          45        53          0.375</span>
<span id="cb42-393"><a href="#cb42-393"></a>    46       103          0.374          47        32          0.372          48       197          0.371</span>
<span id="cb42-394"><a href="#cb42-394"></a>    49        38          0.361          50       139          0.358          51        83          0.355</span>
<span id="cb42-395"><a href="#cb42-395"></a>    52       116          0.349          53        56          0.347          54       158          0.340</span>
<span id="cb42-396"><a href="#cb42-396"></a>    55       126          0.331          56       171          0.326          57       135          0.325</span>
<span id="cb42-397"><a href="#cb42-397"></a>    58       168          0.324          59       131          0.321          60         3          0.320</span>
<span id="cb42-398"><a href="#cb42-398"></a>    61       203          0.319          62       182          0.318          63        14          0.315</span>
<span id="cb42-399"><a href="#cb42-399"></a>    64       132          0.312          65        74          0.310          66         6          0.307</span>
<span id="cb42-400"><a href="#cb42-400"></a>    67        91          0.303          68       151          0.296          69        61          0.295</span>
<span id="cb42-401"><a href="#cb42-401"></a>    70       134          0.294          71       191          0.292          72        95          0.291</span>
<span id="cb42-402"><a href="#cb42-402"></a>    73       160          0.290          74        15          0.289          75        24          0.284</span>
<span id="cb42-403"><a href="#cb42-403"></a>    76       186          0.282          77        72          0.280          78        51          0.280</span>
<span id="cb42-404"><a href="#cb42-404"></a>    79       156          0.275          80       123          0.266          81       114          0.265</span>
<span id="cb42-405"><a href="#cb42-405"></a>    82       152          0.261          83       164          0.257          84         7          0.254</span>
<span id="cb42-406"><a href="#cb42-406"></a>    85       104          0.251          86       193          0.250          87        58          0.248</span>
<span id="cb42-407"><a href="#cb42-407"></a>    88        33          0.246          89        62          0.244          90        78          0.238</span>
<span id="cb42-408"><a href="#cb42-408"></a>    91       138          0.237          92       169          0.232          93       153          0.232</span>
<span id="cb42-409"><a href="#cb42-409"></a>    94       173          0.231          95       192          0.230          96       145          0.230</span>
<span id="cb42-410"><a href="#cb42-410"></a>    97       174          0.226          98       127          0.218          99       137          0.214</span>
<span id="cb42-411"><a href="#cb42-411"></a>   100       102          0.213         101       190          0.209         102       161          0.209</span>
<span id="cb42-412"><a href="#cb42-412"></a>   103        36          0.208         104        66          0.192         105        42          0.167</span>
<span id="cb42-413"><a href="#cb42-413"></a>   106        89          0.163         107       133          0.160         108       185          0.154</span>
<span id="cb42-414"><a href="#cb42-414"></a>   109         4          0.152         110       101          0.147         111        79          0.145</span>
<span id="cb42-415"><a href="#cb42-415"></a>   112       100          0.139         113       111          0.139         114        52          0.128</span>
<span id="cb42-416"><a href="#cb42-416"></a>   115        21          0.127         116        20          0.123         117        18          0.123</span>
<span id="cb42-417"><a href="#cb42-417"></a>   118       128          0.120         119        50          0.119         120       148          0.109</span>
<span id="cb42-418"><a href="#cb42-418"></a>   121        13          0.108         122        27          0.105         123        29          0.099</span>
<span id="cb42-419"><a href="#cb42-419"></a>   124        69          0.097         125       115          0.093         126        19          0.089</span>
<span id="cb42-420"><a href="#cb42-420"></a>   127       155          0.083         128       130          0.076         129       144          0.075</span>
<span id="cb42-421"><a href="#cb42-421"></a>   130       187          0.075         131       175          0.071         132       194          0.069</span>
<span id="cb42-422"><a href="#cb42-422"></a>   133        94          0.065         134       118          0.065         135        43          0.063</span>
<span id="cb42-423"><a href="#cb42-423"></a>   136        11          0.060         137        71          0.057         138        80          0.053</span>
<span id="cb42-424"><a href="#cb42-424"></a>   139       140          0.050         140        10          0.049         141        17          0.039</span>
<span id="cb42-425"><a href="#cb42-425"></a>   142       181          0.037         143        34          0.036         144       106          0.035</span>
<span id="cb42-426"><a href="#cb42-426"></a>   145       108          0.033         146         9          0.031         147        90          0.031</span>
<span id="cb42-427"><a href="#cb42-427"></a>   148        57          0.028         149        63          0.028         150        96          0.026</span>
<span id="cb42-428"><a href="#cb42-428"></a>   151       109          0.026         152       184          0.025         153       162          0.024</span>
<span id="cb42-429"><a href="#cb42-429"></a>   154       199          0.024         155        81          0.023         156        77          0.021</span>
<span id="cb42-430"><a href="#cb42-430"></a>   157       125          0.021         158        55          0.021         159        47          0.021</span>
<span id="cb42-431"><a href="#cb42-431"></a>   160       141          0.021         161       112          0.020         162        40          0.020</span>
<span id="cb42-432"><a href="#cb42-432"></a>   163       165          0.020         164       176          0.020         165       177          0.019</span>
<span id="cb42-433"><a href="#cb42-433"></a>   166        93          0.019         167       159          0.019         168        68          0.019</span>
<span id="cb42-434"><a href="#cb42-434"></a>   169       170          0.019         170        39          0.018         171       189          0.016</span>
<span id="cb42-435"><a href="#cb42-435"></a>   172        82          0.016         173        54          0.016         174        16          0.015</span>
<span id="cb42-436"><a href="#cb42-436"></a>   175       178          0.015         176        45          0.014         177       117          0.014</span>
<span id="cb42-437"><a href="#cb42-437"></a>   178        84          0.014         179        28          0.014         180       122          0.014</span>
<span id="cb42-438"><a href="#cb42-438"></a>   181        46          0.013         182       121          0.013         183        48          0.012</span>
<span id="cb42-439"><a href="#cb42-439"></a>   184        31          0.011         185       146          0.011         186        26          0.009</span>
<span id="cb42-440"><a href="#cb42-440"></a>   187       172          0.009         188        86          0.009         189       163          0.007</span>
<span id="cb42-441"><a href="#cb42-441"></a>   190        60          0.007         191       166          0.007         192        98          0.000</span>
<span id="cb42-442"><a href="#cb42-442"></a>   193        99         -0.007         194       105         -0.007         195        76         -0.010</span>
<span id="cb42-443"><a href="#cb42-443"></a>   196       113         -0.012         197        67         -0.015         198        41         -0.016</span>
<span id="cb42-444"><a href="#cb42-444"></a>   199       180         -0.019         200       195         -0.020         201       157         -0.022</span>
<span id="cb42-445"><a href="#cb42-445"></a>   202         2         -0.048         203        49         -0.049         204       120         -0.081</span>
<span id="cb42-446"><a href="#cb42-446"></a></span>
<span id="cb42-447"><a href="#cb42-447"></a> Results for Factor LOGV</span>
<span id="cb42-448"><a href="#cb42-448"></a></span>
<span id="cb42-449"><a href="#cb42-449"></a> Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score</span>
<span id="cb42-450"><a href="#cb42-450"></a>     1       171          1.801           2        97          1.493           3        95          1.471</span>
<span id="cb42-451"><a href="#cb42-451"></a>     4       132          1.452           5        72          1.393           6       169          1.383</span>
<span id="cb42-452"><a href="#cb42-452"></a>     7       118          1.326           8         6          1.308           9       152          1.301</span>
<span id="cb42-453"><a href="#cb42-453"></a>    10        83          1.262          11        32          1.154          12       100          1.087</span>
<span id="cb42-454"><a href="#cb42-454"></a>    13        38          0.990          14        24          0.910          15        69          0.906</span>
<span id="cb42-455"><a href="#cb42-455"></a>    16       196          0.906          17       103          0.880          18        33          0.849</span>
<span id="cb42-456"><a href="#cb42-456"></a>    19        56          0.822          20       164          0.817          21        14          0.798</span>
<span id="cb42-457"><a href="#cb42-457"></a>    22       120          0.776          23        23          0.738          24       151          0.720</span>
<span id="cb42-458"><a href="#cb42-458"></a>    25        59          0.712          26       203          0.700          27       101          0.693</span>
<span id="cb42-459"><a href="#cb42-459"></a>    28       119          0.692          29        12          0.686          30        50          0.646</span>
<span id="cb42-460"><a href="#cb42-460"></a>    31       129          0.626          32        42          0.621          33       114          0.607</span>
<span id="cb42-461"><a href="#cb42-461"></a>    34        74          0.603          35        22          0.579          36        30          0.551</span>
<span id="cb42-462"><a href="#cb42-462"></a>    37         2          0.542          38        91          0.533          39         1          0.519</span>
<span id="cb42-463"><a href="#cb42-463"></a>    40        44          0.482          41        80          0.480          42       124          0.473</span>
<span id="cb42-464"><a href="#cb42-464"></a>    43       149          0.452          44       123          0.425          45        53          0.390</span>
<span id="cb42-465"><a href="#cb42-465"></a>    46       111          0.381          47        37          0.371          48        27          0.362</span>
<span id="cb42-466"><a href="#cb42-466"></a>    49       153          0.356          50       173          0.348          51        78          0.329</span>
<span id="cb42-467"><a href="#cb42-467"></a>    52       125          0.324          53       168          0.322          54       144          0.293</span>
<span id="cb42-468"><a href="#cb42-468"></a>    55       147          0.289          56        43          0.285          57       183          0.256</span>
<span id="cb42-469"><a href="#cb42-469"></a>    58       167          0.224          59       199          0.164          60       107          0.158</span>
<span id="cb42-470"><a href="#cb42-470"></a>    61       145          0.153          62        88          0.146          63        10          0.120</span>
<span id="cb42-471"><a href="#cb42-471"></a>    64         8          0.094          65       204          0.089          66       150          0.085</span>
<span id="cb42-472"><a href="#cb42-472"></a>    67        18          0.058          68        13          0.047          69         7          0.009</span>
<span id="cb42-473"><a href="#cb42-473"></a>    70        87          0.007          71         4         -0.047          72       104         -0.048</span>
<span id="cb42-474"><a href="#cb42-474"></a>    73       200         -0.073          74       194         -0.087          75       148         -0.100</span>
<span id="cb42-475"><a href="#cb42-475"></a>    76        52         -0.100          77       136         -0.109          78        94         -0.117</span>
<span id="cb42-476"><a href="#cb42-476"></a>    79       110         -0.137          80       138         -0.143          81       192         -0.145</span>
<span id="cb42-477"><a href="#cb42-477"></a>    82        79         -0.148          83        61         -0.164          84       182         -0.178</span>
<span id="cb42-478"><a href="#cb42-478"></a>    85       127         -0.181          86        47         -0.184          87        35         -0.193</span>
<span id="cb42-479"><a href="#cb42-479"></a>    88        15         -0.196          89        51         -0.217          90        66         -0.233</span>
<span id="cb42-480"><a href="#cb42-480"></a>    91        64         -0.250          92         3         -0.260          93        36         -0.277</span>
<span id="cb42-481"><a href="#cb42-481"></a>    94       179         -0.292          95        71         -0.335          96       131         -0.350</span>
<span id="cb42-482"><a href="#cb42-482"></a>    97       166         -0.365          98        76         -0.384          99        70         -0.436</span>
<span id="cb42-483"><a href="#cb42-483"></a>   100        20         -0.451         101       197         -0.469         102        65         -0.472</span>
<span id="cb42-484"><a href="#cb42-484"></a>   103       174         -0.495         104       157         -0.495         105       109         -0.521</span>
<span id="cb42-485"><a href="#cb42-485"></a>   106        11         -0.528         107       135         -0.566         108       190         -0.586</span>
<span id="cb42-486"><a href="#cb42-486"></a>   109       202         -0.587         110        21         -0.594         111        85         -0.607</span>
<span id="cb42-487"><a href="#cb42-487"></a>   112        89         -0.628         113       193         -0.633         114        62         -0.648</span>
<span id="cb42-488"><a href="#cb42-488"></a>   115        75         -0.654         116       142         -0.655         117       134         -0.710</span>
<span id="cb42-489"><a href="#cb42-489"></a>   118       187         -0.711         119       198         -0.717         120        29         -0.721</span>
<span id="cb42-490"><a href="#cb42-490"></a>   121       102         -0.792         122        58         -0.813         123       106         -0.816</span>
<span id="cb42-491"><a href="#cb42-491"></a>   124       133         -0.840         125        25         -0.859         126       195         -0.903</span>
<span id="cb42-492"><a href="#cb42-492"></a>   127       162         -0.934         128       115         -0.967         129       161         -0.989</span>
<span id="cb42-493"><a href="#cb42-493"></a>   130       188         -0.990         131       130         -1.012         132       137         -1.027</span>
<span id="cb42-494"><a href="#cb42-494"></a>   133        60         -1.082         134        57         -1.133         135       143         -1.185</span>
<span id="cb42-495"><a href="#cb42-495"></a>   136        26         -1.189         137       158         -1.208         138       128         -1.232</span>
<span id="cb42-496"><a href="#cb42-496"></a>   139       201         -1.269         140       191         -1.271         141       185         -1.334</span>
<span id="cb42-497"><a href="#cb42-497"></a>   142       139         -1.335         143       116         -1.424         144       175         -1.433</span>
<span id="cb42-498"><a href="#cb42-498"></a>   145       155         -1.460         146       181         -1.497         147        86         -1.670</span>
<span id="cb42-499"><a href="#cb42-499"></a>   148       113         -1.696         149        96         -1.821         150       105         -1.962</span>
<span id="cb42-500"><a href="#cb42-500"></a>   151       180         -1.978         152         5         -1.986         153       126         -2.057</span>
<span id="cb42-501"><a href="#cb42-501"></a>   154        41         -2.178         155        49         -2.219         156        45         -2.257</span>
<span id="cb42-502"><a href="#cb42-502"></a>   157        73         -2.268         158       186         -2.276         159       140         -2.423</span>
<span id="cb42-503"><a href="#cb42-503"></a>   160        19         -2.508         161        67         -2.543         162        98         -2.814</span>
<span id="cb42-504"><a href="#cb42-504"></a>   163        16         -2.986         164       121         -3.190         165        34         -3.202</span>
<span id="cb42-505"><a href="#cb42-505"></a>   166        99         -3.234         167       154         -3.532         168       156         -3.610</span>
<span id="cb42-506"><a href="#cb42-506"></a>   169        17         -3.896         170       160         -4.161         171       146         -4.569</span>
<span id="cb42-507"><a href="#cb42-507"></a>   172        82         -4.574         173       172         -4.588         174       163         -4.599</span>
<span id="cb42-508"><a href="#cb42-508"></a>   175         9         -4.619         176        92         -4.986         177        63         -6.213</span>
<span id="cb42-509"><a href="#cb42-509"></a>   178       108         -6.213         179        93         -6.213         180        84         -6.213</span>
<span id="cb42-510"><a href="#cb42-510"></a>   181        54         -6.213         182        81         -6.213         183       141         -6.213</span>
<span id="cb42-511"><a href="#cb42-511"></a>   184        68         -6.213         185       165         -6.213         186       178         -6.213</span>
<span id="cb42-512"><a href="#cb42-512"></a>   187       122         -6.213         188       159         -6.213         189        55         -6.213</span>
<span id="cb42-513"><a href="#cb42-513"></a>   190       184         -6.213         191        48         -6.213         192       170         -6.213</span>
<span id="cb42-514"><a href="#cb42-514"></a>   193        39         -6.213         194        31         -6.213         195       176         -6.213</span>
<span id="cb42-515"><a href="#cb42-515"></a>   196       177         -6.213         197       112         -6.213         198       189         -6.214</span>
<span id="cb42-516"><a href="#cb42-516"></a>   199        28         -6.214         200        46         -6.214         201        90         -6.214</span>
<span id="cb42-517"><a href="#cb42-517"></a>   202       117         -6.214         203        40         -6.214         204        77         -6.214</span>
<span id="cb42-518"><a href="#cb42-518"></a></span>
<span id="cb42-519"><a href="#cb42-519"></a> Results for X (referred to as plausible label B_X)</span>
<span id="cb42-520"><a href="#cb42-520"></a></span>
<span id="cb42-521"><a href="#cb42-521"></a> Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score     Ranking  Cluster    Factor Score</span>
<span id="cb42-522"><a href="#cb42-522"></a>     1        85          3.459           2        51          3.280           3        97          3.219</span>
<span id="cb42-523"><a href="#cb42-523"></a>     4       196          3.096           5       179          3.033           6       107          2.829</span>
<span id="cb42-524"><a href="#cb42-524"></a>     7         5          2.753           8        87          2.679           9        12          2.672</span>
<span id="cb42-525"><a href="#cb42-525"></a>    10       129          2.665          11       149          2.651          12        72          2.597</span>
<span id="cb42-526"><a href="#cb42-526"></a>    13        95          2.498          14       182          2.482          15       202          2.445</span>
<span id="cb42-527"><a href="#cb42-527"></a>    16         3          2.434          17        37          2.434          18        44          2.408</span>
<span id="cb42-528"><a href="#cb42-528"></a>    19       124          2.395          20        50          2.359          21       151          2.314</span>
<span id="cb42-529"><a href="#cb42-529"></a>    22        32          2.267          23       125          2.229          24        74          2.223</span>
<span id="cb42-530"><a href="#cb42-530"></a>    25       123          2.213          26         8          2.202          27       171          2.135</span>
<span id="cb42-531"><a href="#cb42-531"></a>    28       158          2.108          29       119          2.084          30        23          2.073</span>
<span id="cb42-532"><a href="#cb42-532"></a>    31        38          2.060          32         6          2.055          33        22          2.040</span>
<span id="cb42-533"><a href="#cb42-533"></a>    34       185          2.039          35        24          2.035          36       145          2.024</span>
<span id="cb42-534"><a href="#cb42-534"></a>    37        14          1.997          38        29          1.949          39       193          1.917</span>
<span id="cb42-535"><a href="#cb42-535"></a>    40       120          1.866          41        83          1.854          42         4          1.824</span>
<span id="cb42-536"><a href="#cb42-536"></a>    43        59          1.794          44        65          1.787          45       132          1.693</span>
<span id="cb42-537"><a href="#cb42-537"></a>    46       203          1.687          47        33          1.661          48       197          1.619</span>
<span id="cb42-538"><a href="#cb42-538"></a>    49       147          1.615          50       152          1.547          51       100          1.458</span>
<span id="cb42-539"><a href="#cb42-539"></a>    52       136          1.421          53       153          1.407          54       115          1.354</span>
<span id="cb42-540"><a href="#cb42-540"></a>    55       114          1.337          56         1          1.323          57        25          1.298</span>
<span id="cb42-541"><a href="#cb42-541"></a>    58       110          1.263          59       195          1.262          60        91          1.261</span>
<span id="cb42-542"><a href="#cb42-542"></a>    61        69          1.258          62       174          1.256          63       103          1.253</span>
<span id="cb42-543"><a href="#cb42-543"></a>    64        35          1.201          65       101          1.201          66       169          1.193</span>
<span id="cb42-544"><a href="#cb42-544"></a>    67       204          1.177          68       183          1.156          69       167          1.152</span>
<span id="cb42-545"><a href="#cb42-545"></a>    70        94          1.131          71        52          1.131          72       164          1.111</span>
<span id="cb42-546"><a href="#cb42-546"></a>    73        64          1.107          74        20          0.946          75       190          0.926</span>
<span id="cb42-547"><a href="#cb42-547"></a>    76        61          0.908          77        30          0.903          78       102          0.856</span>
<span id="cb42-548"><a href="#cb42-548"></a>    79        88          0.838          80        71          0.796          81       118          0.774</span>
<span id="cb42-549"><a href="#cb42-549"></a>    82       134          0.772          83        56          0.768          84       131          0.757</span>
<span id="cb42-550"><a href="#cb42-550"></a>    85        80          0.750          86        10          0.722          87        78          0.713</span>
<span id="cb42-551"><a href="#cb42-551"></a>    88        53          0.693          89         2          0.677          90       111          0.649</span>
<span id="cb42-552"><a href="#cb42-552"></a>    91       135          0.632          92       173          0.625          93        66          0.617</span>
<span id="cb42-553"><a href="#cb42-553"></a>    94        58          0.604          95       104          0.581          96       168          0.571</span>
<span id="cb42-554"><a href="#cb42-554"></a>    97       144          0.567          98       200          0.565          99        18          0.550</span>
<span id="cb42-555"><a href="#cb42-555"></a>   100        42          0.547         101       150          0.501         102         7          0.481</span>
<span id="cb42-556"><a href="#cb42-556"></a>   103       138          0.473         104       194          0.456         105        79          0.447</span>
<span id="cb42-557"><a href="#cb42-557"></a>   106        13          0.438         107        75          0.422         108        70          0.414</span>
<span id="cb42-558"><a href="#cb42-558"></a>   109       192          0.392         110       133          0.385         111       166          0.376</span>
<span id="cb42-559"><a href="#cb42-559"></a>   112       199          0.376         113       198          0.360         114        15          0.352</span>
<span id="cb42-560"><a href="#cb42-560"></a>   115        27          0.338         116       157          0.335         117        89          0.331</span>
<span id="cb42-561"><a href="#cb42-561"></a>   118       137          0.321         119        43          0.312         120       142          0.312</span>
<span id="cb42-562"><a href="#cb42-562"></a>   121       109          0.303         122        36          0.297         123       130          0.281</span>
<span id="cb42-563"><a href="#cb42-563"></a>   124       148          0.279         125       191          0.276         126       106          0.274</span>
<span id="cb42-564"><a href="#cb42-564"></a>   127       161          0.273         128        11          0.272         129        21          0.271</span>
<span id="cb42-565"><a href="#cb42-565"></a>   130        76          0.267         131       127          0.265         132       139          0.261</span>
<span id="cb42-566"><a href="#cb42-566"></a>   133       155          0.256         134       116          0.253         135        47          0.233</span>
<span id="cb42-567"><a href="#cb42-567"></a>   136       188          0.223         137       201          0.200         138       143          0.185</span>
<span id="cb42-568"><a href="#cb42-568"></a>   139       126          0.177         140       175          0.165         141        62          0.159</span>
<span id="cb42-569"><a href="#cb42-569"></a>   142       128          0.144         143        26          0.142         144       105          0.142</span>
<span id="cb42-570"><a href="#cb42-570"></a>   145        60          0.141         146        41          0.129         147        57          0.123</span>
<span id="cb42-571"><a href="#cb42-571"></a>   148        49          0.121         149       180          0.111         150       186          0.103</span>
<span id="cb42-572"><a href="#cb42-572"></a>   151       113          0.099         152       181          0.092         153        19          0.089</span>
<span id="cb42-573"><a href="#cb42-573"></a>   154       162          0.080         155       187          0.077         156        73          0.070</span>
<span id="cb42-574"><a href="#cb42-574"></a>   157        86          0.069         158        67          0.063         159        45          0.043</span>
<span id="cb42-575"><a href="#cb42-575"></a>   160        96          0.043         161        98          0.040         162        99          0.039</span>
<span id="cb42-576"><a href="#cb42-576"></a>   163       154          0.038         164       140          0.032         165        16          0.030</span>
<span id="cb42-577"><a href="#cb42-577"></a>   166       156          0.029         167        34          0.023         168        17          0.021</span>
<span id="cb42-578"><a href="#cb42-578"></a>   169       121          0.021         170       146          0.010         171       172          0.010</span>
<span id="cb42-579"><a href="#cb42-579"></a>   172         9          0.010         173        82          0.010         174       163          0.009</span>
<span id="cb42-580"><a href="#cb42-580"></a>   175       160          0.006         176        92          0.004         177       112          0.000</span>
<span id="cb42-581"><a href="#cb42-581"></a>   178        28          0.000         179       177          0.000         180       189          0.000</span>
<span id="cb42-582"><a href="#cb42-582"></a>   181        90          0.000         182       117          0.000         183        48          0.000</span>
<span id="cb42-583"><a href="#cb42-583"></a>   184       170          0.000         185        68          0.000         186       108          0.000</span>
<span id="cb42-584"><a href="#cb42-584"></a>   187        55          0.000         188       184          0.000         189        39          0.000</span>
<span id="cb42-585"><a href="#cb42-585"></a>   190        31          0.000         191       141          0.000         192        40          0.000</span>
<span id="cb42-586"><a href="#cb42-586"></a>   193       159          0.000         194        93          0.000         195        54          0.000</span>
<span id="cb42-587"><a href="#cb42-587"></a>   196        84          0.000         197       176          0.000         198        77          0.000</span>
<span id="cb42-588"><a href="#cb42-588"></a>   199       178          0.000         200       165          0.000         201        63          0.000</span>
<span id="cb42-589"><a href="#cb42-589"></a>   202       122          0.000         203        46          0.000         204        81          0.000</span>
<span id="cb42-590"><a href="#cb42-590"></a></span>
<span id="cb42-591"><a href="#cb42-591"></a></span>
<span id="cb42-592"><a href="#cb42-592"></a>TECHNICAL 1 OUTPUT</span>
<span id="cb42-593"><a href="#cb42-593"></a></span>
<span id="cb42-594"><a href="#cb42-594"></a>     PARAMETER SPECIFICATION FOR WITHIN</span>
<span id="cb42-595"><a href="#cb42-595"></a></span>
<span id="cb42-596"><a href="#cb42-596"></a>           NU</span>
<span id="cb42-597"><a href="#cb42-597"></a>              X             X&amp;1</span>
<span id="cb42-598"><a href="#cb42-598"></a>              ________      ________</span>
<span id="cb42-599"><a href="#cb42-599"></a>                    0             0</span>
<span id="cb42-600"><a href="#cb42-600"></a></span>
<span id="cb42-601"><a href="#cb42-601"></a>           LAMBDA</span>
<span id="cb42-602"><a href="#cb42-602"></a>              X             X&amp;1</span>
<span id="cb42-603"><a href="#cb42-603"></a>              ________      ________</span>
<span id="cb42-604"><a href="#cb42-604"></a> X                  0             0</span>
<span id="cb42-605"><a href="#cb42-605"></a> X&amp;1                0             0</span>
<span id="cb42-606"><a href="#cb42-606"></a></span>
<span id="cb42-607"><a href="#cb42-607"></a>           THETA</span>
<span id="cb42-608"><a href="#cb42-608"></a>              X             X&amp;1</span>
<span id="cb42-609"><a href="#cb42-609"></a>              ________      ________</span>
<span id="cb42-610"><a href="#cb42-610"></a> X                  0</span>
<span id="cb42-611"><a href="#cb42-611"></a> X&amp;1                0             0</span>
<span id="cb42-612"><a href="#cb42-612"></a></span>
<span id="cb42-613"><a href="#cb42-613"></a>           ALPHA</span>
<span id="cb42-614"><a href="#cb42-614"></a>              X             X&amp;1</span>
<span id="cb42-615"><a href="#cb42-615"></a>              ________      ________</span>
<span id="cb42-616"><a href="#cb42-616"></a>                    0             0</span>
<span id="cb42-617"><a href="#cb42-617"></a></span>
<span id="cb42-618"><a href="#cb42-618"></a>           BETA</span>
<span id="cb42-619"><a href="#cb42-619"></a>              X             X&amp;1</span>
<span id="cb42-620"><a href="#cb42-620"></a>              ________      ________</span>
<span id="cb42-621"><a href="#cb42-621"></a> X                  0             0</span>
<span id="cb42-622"><a href="#cb42-622"></a> X&amp;1                0             0</span>
<span id="cb42-623"><a href="#cb42-623"></a></span>
<span id="cb42-624"><a href="#cb42-624"></a>           PSI</span>
<span id="cb42-625"><a href="#cb42-625"></a>              X             X&amp;1</span>
<span id="cb42-626"><a href="#cb42-626"></a>              ________      ________</span>
<span id="cb42-627"><a href="#cb42-627"></a> X                  0</span>
<span id="cb42-628"><a href="#cb42-628"></a> X&amp;1                0             0</span>
<span id="cb42-629"><a href="#cb42-629"></a></span>
<span id="cb42-630"><a href="#cb42-630"></a>     PARAMETER SPECIFICATION FOR BETWEEN</span>
<span id="cb42-631"><a href="#cb42-631"></a></span>
<span id="cb42-632"><a href="#cb42-632"></a>           NU</span>
<span id="cb42-633"><a href="#cb42-633"></a>              X</span>
<span id="cb42-634"><a href="#cb42-634"></a>              ________</span>
<span id="cb42-635"><a href="#cb42-635"></a>                    0</span>
<span id="cb42-636"><a href="#cb42-636"></a></span>
<span id="cb42-637"><a href="#cb42-637"></a>           LAMBDA</span>
<span id="cb42-638"><a href="#cb42-638"></a>              PHI           LOGV          X</span>
<span id="cb42-639"><a href="#cb42-639"></a>              ________      ________      ________</span>
<span id="cb42-640"><a href="#cb42-640"></a> X                  0             0             0</span>
<span id="cb42-641"><a href="#cb42-641"></a></span>
<span id="cb42-642"><a href="#cb42-642"></a>           THETA</span>
<span id="cb42-643"><a href="#cb42-643"></a>              X</span>
<span id="cb42-644"><a href="#cb42-644"></a>              ________</span>
<span id="cb42-645"><a href="#cb42-645"></a> X                  0</span>
<span id="cb42-646"><a href="#cb42-646"></a></span>
<span id="cb42-647"><a href="#cb42-647"></a>           ALPHA</span>
<span id="cb42-648"><a href="#cb42-648"></a>              PHI           LOGV          X</span>
<span id="cb42-649"><a href="#cb42-649"></a>              ________      ________      ________</span>
<span id="cb42-650"><a href="#cb42-650"></a>                    1             2             3</span>
<span id="cb42-651"><a href="#cb42-651"></a></span>
<span id="cb42-652"><a href="#cb42-652"></a>           BETA</span>
<span id="cb42-653"><a href="#cb42-653"></a>              PHI           LOGV          X</span>
<span id="cb42-654"><a href="#cb42-654"></a>              ________      ________      ________</span>
<span id="cb42-655"><a href="#cb42-655"></a> PHI                0             0             0</span>
<span id="cb42-656"><a href="#cb42-656"></a> LOGV               0             0             0</span>
<span id="cb42-657"><a href="#cb42-657"></a> X                  0             0             0</span>
<span id="cb42-658"><a href="#cb42-658"></a></span>
<span id="cb42-659"><a href="#cb42-659"></a>           PSI</span>
<span id="cb42-660"><a href="#cb42-660"></a>              PHI           LOGV          X</span>
<span id="cb42-661"><a href="#cb42-661"></a>              ________      ________      ________</span>
<span id="cb42-662"><a href="#cb42-662"></a> PHI                4</span>
<span id="cb42-663"><a href="#cb42-663"></a> LOGV               5             6</span>
<span id="cb42-664"><a href="#cb42-664"></a> X                  7             8             9</span>
<span id="cb42-665"><a href="#cb42-665"></a></span>
<span id="cb42-666"><a href="#cb42-666"></a>     STARTING VALUES FOR WITHIN</span>
<span id="cb42-667"><a href="#cb42-667"></a></span>
<span id="cb42-668"><a href="#cb42-668"></a>           NU</span>
<span id="cb42-669"><a href="#cb42-669"></a>              X             X&amp;1</span>
<span id="cb42-670"><a href="#cb42-670"></a>              ________      ________</span>
<span id="cb42-671"><a href="#cb42-671"></a>                0.000         0.000</span>
<span id="cb42-672"><a href="#cb42-672"></a></span>
<span id="cb42-673"><a href="#cb42-673"></a>           LAMBDA</span>
<span id="cb42-674"><a href="#cb42-674"></a>              X             X&amp;1</span>
<span id="cb42-675"><a href="#cb42-675"></a>              ________      ________</span>
<span id="cb42-676"><a href="#cb42-676"></a> X              1.000         0.000</span>
<span id="cb42-677"><a href="#cb42-677"></a> X&amp;1            0.000         1.000</span>
<span id="cb42-678"><a href="#cb42-678"></a></span>
<span id="cb42-679"><a href="#cb42-679"></a>           THETA</span>
<span id="cb42-680"><a href="#cb42-680"></a>              X             X&amp;1</span>
<span id="cb42-681"><a href="#cb42-681"></a>              ________      ________</span>
<span id="cb42-682"><a href="#cb42-682"></a> X              0.000</span>
<span id="cb42-683"><a href="#cb42-683"></a> X&amp;1            0.000         0.000</span>
<span id="cb42-684"><a href="#cb42-684"></a></span>
<span id="cb42-685"><a href="#cb42-685"></a>           ALPHA</span>
<span id="cb42-686"><a href="#cb42-686"></a>              X             X&amp;1</span>
<span id="cb42-687"><a href="#cb42-687"></a>              ________      ________</span>
<span id="cb42-688"><a href="#cb42-688"></a>                0.000         0.000</span>
<span id="cb42-689"><a href="#cb42-689"></a></span>
<span id="cb42-690"><a href="#cb42-690"></a>           BETA</span>
<span id="cb42-691"><a href="#cb42-691"></a>              X             X&amp;1</span>
<span id="cb42-692"><a href="#cb42-692"></a>              ________      ________</span>
<span id="cb42-693"><a href="#cb42-693"></a> X              0.000         0.000</span>
<span id="cb42-694"><a href="#cb42-694"></a> X&amp;1            0.000         0.000</span>
<span id="cb42-695"><a href="#cb42-695"></a></span>
<span id="cb42-696"><a href="#cb42-696"></a>           PSI</span>
<span id="cb42-697"><a href="#cb42-697"></a>              X             X&amp;1</span>
<span id="cb42-698"><a href="#cb42-698"></a>              ________      ________</span>
<span id="cb42-699"><a href="#cb42-699"></a> X              0.000</span>
<span id="cb42-700"><a href="#cb42-700"></a> X&amp;1            0.000         1.049</span>
<span id="cb42-701"><a href="#cb42-701"></a></span>
<span id="cb42-702"><a href="#cb42-702"></a>     STARTING VALUES FOR BETWEEN</span>
<span id="cb42-703"><a href="#cb42-703"></a></span>
<span id="cb42-704"><a href="#cb42-704"></a>           NU</span>
<span id="cb42-705"><a href="#cb42-705"></a>              X</span>
<span id="cb42-706"><a href="#cb42-706"></a>              ________</span>
<span id="cb42-707"><a href="#cb42-707"></a>                0.000</span>
<span id="cb42-708"><a href="#cb42-708"></a></span>
<span id="cb42-709"><a href="#cb42-709"></a>           LAMBDA</span>
<span id="cb42-710"><a href="#cb42-710"></a>              PHI           LOGV          X</span>
<span id="cb42-711"><a href="#cb42-711"></a>              ________      ________      ________</span>
<span id="cb42-712"><a href="#cb42-712"></a> X              0.000         0.000         1.000</span>
<span id="cb42-713"><a href="#cb42-713"></a></span>
<span id="cb42-714"><a href="#cb42-714"></a>           THETA</span>
<span id="cb42-715"><a href="#cb42-715"></a>              X</span>
<span id="cb42-716"><a href="#cb42-716"></a>              ________</span>
<span id="cb42-717"><a href="#cb42-717"></a> X              0.000</span>
<span id="cb42-718"><a href="#cb42-718"></a></span>
<span id="cb42-719"><a href="#cb42-719"></a>           ALPHA</span>
<span id="cb42-720"><a href="#cb42-720"></a>              PHI           LOGV          X</span>
<span id="cb42-721"><a href="#cb42-721"></a>              ________      ________      ________</span>
<span id="cb42-722"><a href="#cb42-722"></a>                0.000         0.000         0.892</span>
<span id="cb42-723"><a href="#cb42-723"></a></span>
<span id="cb42-724"><a href="#cb42-724"></a>           BETA</span>
<span id="cb42-725"><a href="#cb42-725"></a>              PHI           LOGV          X</span>
<span id="cb42-726"><a href="#cb42-726"></a>              ________      ________      ________</span>
<span id="cb42-727"><a href="#cb42-727"></a> PHI            0.000         0.000         0.000</span>
<span id="cb42-728"><a href="#cb42-728"></a> LOGV           0.000         0.000         0.000</span>
<span id="cb42-729"><a href="#cb42-729"></a> X              0.000         0.000         0.000</span>
<span id="cb42-730"><a href="#cb42-730"></a></span>
<span id="cb42-731"><a href="#cb42-731"></a>           PSI</span>
<span id="cb42-732"><a href="#cb42-732"></a>              PHI           LOGV          X</span>
<span id="cb42-733"><a href="#cb42-733"></a>              ________      ________      ________</span>
<span id="cb42-734"><a href="#cb42-734"></a> PHI            1.000</span>
<span id="cb42-735"><a href="#cb42-735"></a> LOGV           0.000         1.000</span>
<span id="cb42-736"><a href="#cb42-736"></a> X              0.000         0.000         1.051</span>
<span id="cb42-737"><a href="#cb42-737"></a></span>
<span id="cb42-738"><a href="#cb42-738"></a>     PRIORS FOR ALL PARAMETERS            PRIOR MEAN      PRIOR VARIANCE     PRIOR STD. DEV.</span>
<span id="cb42-739"><a href="#cb42-739"></a></span>
<span id="cb42-740"><a href="#cb42-740"></a>     Parameter 1~N(0.000,infinity)           0.0000            infinity            infinity</span>
<span id="cb42-741"><a href="#cb42-741"></a>     Parameter 2~N(0.000,infinity)           0.0000            infinity            infinity</span>
<span id="cb42-742"><a href="#cb42-742"></a>     Parameter 3~N(0.000,infinity)           0.0000            infinity            infinity</span>
<span id="cb42-743"><a href="#cb42-743"></a>     Parameter 4~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-744"><a href="#cb42-744"></a>     Parameter 5~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-745"><a href="#cb42-745"></a>     Parameter 6~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-746"><a href="#cb42-746"></a>     Parameter 7~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-747"><a href="#cb42-747"></a>     Parameter 8~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-748"><a href="#cb42-748"></a>     Parameter 9~IW(0.000,-4)              infinity            infinity            infinity</span>
<span id="cb42-749"><a href="#cb42-749"></a></span>
<span id="cb42-750"><a href="#cb42-750"></a></span>
<span id="cb42-751"><a href="#cb42-751"></a>TECHNICAL 2 OUTPUT</span>
<span id="cb42-752"><a href="#cb42-752"></a></span>
<span id="cb42-753"><a href="#cb42-753"></a></span>
<span id="cb42-754"><a href="#cb42-754"></a>TECHNICAL 3 OUTPUT</span>
<span id="cb42-755"><a href="#cb42-755"></a></span>
<span id="cb42-756"><a href="#cb42-756"></a>           ESTIMATED COVARIANCE MATRIX FOR PARAMETER ESTIMATES</span>
<span id="cb42-757"><a href="#cb42-757"></a>                     1             2             3             4             5</span>
<span id="cb42-758"><a href="#cb42-758"></a>              ________      ________      ________      ________      ________</span>
<span id="cb42-759"><a href="#cb42-759"></a>        1   0.303243D-03</span>
<span id="cb42-760"><a href="#cb42-760"></a>        2   0.111479D-02  0.283039D-01</span>
<span id="cb42-761"><a href="#cb42-761"></a>        3   0.573716D-03  0.676933D-02  0.443802D-02</span>
<span id="cb42-762"><a href="#cb42-762"></a>        4  -0.532720D-05  0.110025D-04 -0.339096D-05  0.391271D-04</span>
<span id="cb42-763"><a href="#cb42-763"></a>        5  -0.194184D-04  0.959434D-05 -0.223709D-05  0.151406D-03  0.225353D-02</span>
<span id="cb42-764"><a href="#cb42-764"></a>        6  -0.254633D-04 -0.198442D-02  0.203844D-03  0.528874D-03  0.143923D-01</span>
<span id="cb42-765"><a href="#cb42-765"></a>        7  -0.155307D-04 -0.632696D-04  0.219154D-04  0.734729D-04  0.609272D-03</span>
<span id="cb42-766"><a href="#cb42-766"></a>        8  -0.181356D-04 -0.550199D-03  0.392759D-03  0.269224D-03  0.525530D-02</span>
<span id="cb42-767"><a href="#cb42-767"></a>        9  -0.372339D-04 -0.473692D-03  0.237455D-03  0.130175D-03  0.166469D-02</span>
<span id="cb42-768"><a href="#cb42-768"></a></span>
<span id="cb42-769"><a href="#cb42-769"></a>           ESTIMATED COVARIANCE MATRIX FOR PARAMETER ESTIMATES</span>
<span id="cb42-770"><a href="#cb42-770"></a>                     6             7             8             9</span>
<span id="cb42-771"><a href="#cb42-771"></a>              ________      ________      ________      ________</span>
<span id="cb42-772"><a href="#cb42-772"></a>        6   0.331846D+00</span>
<span id="cb42-773"><a href="#cb42-773"></a>        7   0.346864D-02  0.388632D-03</span>
<span id="cb42-774"><a href="#cb42-774"></a>        8   0.814117D-01  0.196578D-02  0.368172D-01</span>
<span id="cb42-775"><a href="#cb42-775"></a>        9   0.193057D-01  0.115614D-02  0.130115D-01  0.880102D-02</span>
<span id="cb42-776"><a href="#cb42-776"></a></span>
<span id="cb42-777"><a href="#cb42-777"></a>           ESTIMATED CORRELATION MATRIX FOR PARAMETER ESTIMATES</span>
<span id="cb42-778"><a href="#cb42-778"></a>                     1             2             3             4             5</span>
<span id="cb42-779"><a href="#cb42-779"></a>              ________      ________      ________      ________      ________</span>
<span id="cb42-780"><a href="#cb42-780"></a>        1       1.000</span>
<span id="cb42-781"><a href="#cb42-781"></a>        2       0.381         1.000</span>
<span id="cb42-782"><a href="#cb42-782"></a>        3       0.495         0.604         1.000</span>
<span id="cb42-783"><a href="#cb42-783"></a>        4      -0.049         0.010        -0.008         1.000</span>
<span id="cb42-784"><a href="#cb42-784"></a>        5      -0.023         0.001        -0.001         0.510         1.000</span>
<span id="cb42-785"><a href="#cb42-785"></a>        6      -0.003        -0.020         0.005         0.147         0.526</span>
<span id="cb42-786"><a href="#cb42-786"></a>        7      -0.045        -0.019         0.017         0.596         0.651</span>
<span id="cb42-787"><a href="#cb42-787"></a>        8      -0.005        -0.017         0.031         0.224         0.577</span>
<span id="cb42-788"><a href="#cb42-788"></a>        9      -0.023        -0.030         0.038         0.222         0.374</span>
<span id="cb42-789"><a href="#cb42-789"></a></span>
<span id="cb42-790"><a href="#cb42-790"></a>           ESTIMATED CORRELATION MATRIX FOR PARAMETER ESTIMATES</span>
<span id="cb42-791"><a href="#cb42-791"></a>                     6             7             8             9</span>
<span id="cb42-792"><a href="#cb42-792"></a>              ________      ________      ________      ________</span>
<span id="cb42-793"><a href="#cb42-793"></a>        6       1.000</span>
<span id="cb42-794"><a href="#cb42-794"></a>        7       0.305         1.000</span>
<span id="cb42-795"><a href="#cb42-795"></a>        8       0.737         0.520         1.000</span>
<span id="cb42-796"><a href="#cb42-796"></a>        9       0.357         0.625         0.723         1.000</span>
<span id="cb42-797"><a href="#cb42-797"></a></span>
<span id="cb42-798"><a href="#cb42-798"></a></span>
<span id="cb42-799"><a href="#cb42-799"></a>TECHNICAL 8 OUTPUT</span>
<span id="cb42-800"><a href="#cb42-800"></a></span>
<span id="cb42-801"><a href="#cb42-801"></a></span>
<span id="cb42-802"><a href="#cb42-802"></a>   TECHNICAL 8 OUTPUT FOR BAYES ESTIMATION</span>
<span id="cb42-803"><a href="#cb42-803"></a></span>
<span id="cb42-804"><a href="#cb42-804"></a>     CHAIN    BSEED</span>
<span id="cb42-805"><a href="#cb42-805"></a>     1        0</span>
<span id="cb42-806"><a href="#cb42-806"></a>     2        285380</span>
<span id="cb42-807"><a href="#cb42-807"></a></span>
<span id="cb42-808"><a href="#cb42-808"></a>                     POTENTIAL       PARAMETER WITH</span>
<span id="cb42-809"><a href="#cb42-809"></a>     ITERATION    SCALE REDUCTION      HIGHEST PSR</span>
<span id="cb42-810"><a href="#cb42-810"></a>     100              1.056               6</span>
<span id="cb42-811"><a href="#cb42-811"></a>     200              1.000               1</span>
<span id="cb42-812"><a href="#cb42-812"></a>     300              1.007               6</span>
<span id="cb42-813"><a href="#cb42-813"></a>     400              1.000               6</span>
<span id="cb42-814"><a href="#cb42-814"></a>     500              1.002               5</span>
<span id="cb42-815"><a href="#cb42-815"></a>     600              1.008               5</span>
<span id="cb42-816"><a href="#cb42-816"></a>     700              1.002               5</span>
<span id="cb42-817"><a href="#cb42-817"></a>     800              1.001               5</span>
<span id="cb42-818"><a href="#cb42-818"></a>     900              1.003               6</span>
<span id="cb42-819"><a href="#cb42-819"></a>     1000             1.002               5</span>
<span id="cb42-820"><a href="#cb42-820"></a>     1100             1.002               5</span>
<span id="cb42-821"><a href="#cb42-821"></a>     1200             1.001               6</span>
<span id="cb42-822"><a href="#cb42-822"></a>     1300             1.000               5</span>
<span id="cb42-823"><a href="#cb42-823"></a>     1400             1.000               1</span>
<span id="cb42-824"><a href="#cb42-824"></a>     1500             1.000               5</span>
<span id="cb42-825"><a href="#cb42-825"></a>     1600             1.001               5</span>
<span id="cb42-826"><a href="#cb42-826"></a>     1700             1.000               5</span>
<span id="cb42-827"><a href="#cb42-827"></a>     1800             1.001               5</span>
<span id="cb42-828"><a href="#cb42-828"></a>     1900             1.000               3</span>
<span id="cb42-829"><a href="#cb42-829"></a>     2000             1.001               3</span>
<span id="cb42-830"><a href="#cb42-830"></a></span>
<span id="cb42-831"><a href="#cb42-831"></a></span>
<span id="cb42-832"><a href="#cb42-832"></a>SUMMARIES OF PLAUSIBLE VALUES (N = NUMBER OF OBSERVATIONS * NUMBER OF IMPUTATIONS)</span>
<span id="cb42-833"><a href="#cb42-833"></a></span>
<span id="cb42-834"><a href="#cb42-834"></a>     SAMPLE STATISTICS</span>
<span id="cb42-835"><a href="#cb42-835"></a></span>
<span id="cb42-836"><a href="#cb42-836"></a>           Means</span>
<span id="cb42-837"><a href="#cb42-837"></a>              PHI           LOGV          B_X</span>
<span id="cb42-838"><a href="#cb42-838"></a>              ________      ________      ________</span>
<span id="cb42-839"><a href="#cb42-839"></a>                0.222        -1.237         0.907</span>
<span id="cb42-840"><a href="#cb42-840"></a></span>
<span id="cb42-841"><a href="#cb42-841"></a>           Covariances</span>
<span id="cb42-842"><a href="#cb42-842"></a>              PHI           LOGV          B_X</span>
<span id="cb42-843"><a href="#cb42-843"></a>              ________      ________      ________</span>
<span id="cb42-844"><a href="#cb42-844"></a> PHI            0.050</span>
<span id="cb42-845"><a href="#cb42-845"></a> LOGV           0.221         5.341</span>
<span id="cb42-846"><a href="#cb42-846"></a> B_X            0.117         1.304         0.888</span>
<span id="cb42-847"><a href="#cb42-847"></a></span>
<span id="cb42-848"><a href="#cb42-848"></a>           Correlations</span>
<span id="cb42-849"><a href="#cb42-849"></a>              PHI           LOGV          B_X</span>
<span id="cb42-850"><a href="#cb42-850"></a>              ________      ________      ________</span>
<span id="cb42-851"><a href="#cb42-851"></a> PHI            1.000</span>
<span id="cb42-852"><a href="#cb42-852"></a> LOGV           0.428         1.000</span>
<span id="cb42-853"><a href="#cb42-853"></a> B_X            0.558         0.599         1.000</span>
<span id="cb42-854"><a href="#cb42-854"></a></span>
<span id="cb42-855"><a href="#cb42-855"></a></span>
<span id="cb42-856"><a href="#cb42-856"></a>SUMMARY OF PLAUSIBLE STANDARD DEVIATION (N = NUMBER OF OBSERVATIONS)</span>
<span id="cb42-857"><a href="#cb42-857"></a></span>
<span id="cb42-858"><a href="#cb42-858"></a>     SAMPLE STATISTICS</span>
<span id="cb42-859"><a href="#cb42-859"></a></span>
<span id="cb42-860"><a href="#cb42-860"></a>           Means</span>
<span id="cb42-861"><a href="#cb42-861"></a>              PHI_SD        LOGV_SD       B_X_SD</span>
<span id="cb42-862"><a href="#cb42-862"></a>              ________      ________      ________</span>
<span id="cb42-863"><a href="#cb42-863"></a>                0.094         0.126         0.114</span>
<span id="cb42-864"><a href="#cb42-864"></a></span>
<span id="cb42-865"><a href="#cb42-865"></a>           Covariances</span>
<span id="cb42-866"><a href="#cb42-866"></a>              PHI_SD        LOGV_SD       B_X_SD</span>
<span id="cb42-867"><a href="#cb42-867"></a>              ________      ________      ________</span>
<span id="cb42-868"><a href="#cb42-868"></a> PHI_SD         0.000</span>
<span id="cb42-869"><a href="#cb42-869"></a> LOGV_SD        0.000         0.002</span>
<span id="cb42-870"><a href="#cb42-870"></a> B_X_SD         0.000         0.002         0.008</span>
<span id="cb42-871"><a href="#cb42-871"></a></span>
<span id="cb42-872"><a href="#cb42-872"></a>           Correlations</span>
<span id="cb42-873"><a href="#cb42-873"></a>              PHI_SD        LOGV_SD       B_X_SD</span>
<span id="cb42-874"><a href="#cb42-874"></a>              ________      ________      ________</span>
<span id="cb42-875"><a href="#cb42-875"></a> PHI_SD         1.000</span>
<span id="cb42-876"><a href="#cb42-876"></a> LOGV_SD       -0.028         1.000</span>
<span id="cb42-877"><a href="#cb42-877"></a> B_X_SD        -0.257         0.444         1.000</span>
<span id="cb42-878"><a href="#cb42-878"></a></span>
<span id="cb42-879"><a href="#cb42-879"></a></span>
<span id="cb42-880"><a href="#cb42-880"></a>PLOT INFORMATION</span>
<span id="cb42-881"><a href="#cb42-881"></a></span>
<span id="cb42-882"><a href="#cb42-882"></a>The following plots are available:</span>
<span id="cb42-883"><a href="#cb42-883"></a></span>
<span id="cb42-884"><a href="#cb42-884"></a>  Histograms (sample values, estimated factor scores)</span>
<span id="cb42-885"><a href="#cb42-885"></a>  Scatterplots (sample values, estimated factor scores)</span>
<span id="cb42-886"><a href="#cb42-886"></a>  Between-level histograms (sample values, sample/estimated means/variances, estimated factor scores)</span>
<span id="cb42-887"><a href="#cb42-887"></a>  Between-level scatterplots (sample values, sample/estimated means/variances, estimated factor scores)</span>
<span id="cb42-888"><a href="#cb42-888"></a>  Time series plots (sample values, ACF, PACF, estimated factor scores)</span>
<span id="cb42-889"><a href="#cb42-889"></a>  Histogram of subjects per time point</span>
<span id="cb42-890"><a href="#cb42-890"></a>  Time interval plots</span>
<span id="cb42-891"><a href="#cb42-891"></a>  Bayesian posterior parameter distributions</span>
<span id="cb42-892"><a href="#cb42-892"></a>  Bayesian posterior parameter trace plots</span>
<span id="cb42-893"><a href="#cb42-893"></a>  Bayesian autocorrelation plots</span>
<span id="cb42-894"><a href="#cb42-894"></a>  Latent variable distribution plots</span>
<span id="cb42-895"><a href="#cb42-895"></a></span>
<span id="cb42-896"><a href="#cb42-896"></a>DIAGRAM INFORMATION</span>
<span id="cb42-897"><a href="#cb42-897"></a></span>
<span id="cb42-898"><a href="#cb42-898"></a>  Mplus diagrams are currently not available for multilevel analysis.</span>
<span id="cb42-899"><a href="#cb42-899"></a>  No diagram output was produced.</span>
<span id="cb42-900"><a href="#cb42-900"></a></span>
<span id="cb42-901"><a href="#cb42-901"></a>     Beginning Time:  13:15:14</span>
<span id="cb42-902"><a href="#cb42-902"></a>        Ending Time:  13:37:51</span>
<span id="cb42-903"><a href="#cb42-903"></a>       Elapsed Time:  00:22:37</span>
<span id="cb42-904"><a href="#cb42-904"></a></span>
<span id="cb42-905"><a href="#cb42-905"></a></span>
<span id="cb42-906"><a href="#cb42-906"></a></span>
<span id="cb42-907"><a href="#cb42-907"></a>MUTHEN &amp; MUTHEN</span>
<span id="cb42-908"><a href="#cb42-908"></a>3463 Stoner Ave.</span>
<span id="cb42-909"><a href="#cb42-909"></a>Los Angeles, CA  90066</span>
<span id="cb42-910"><a href="#cb42-910"></a></span>
<span id="cb42-911"><a href="#cb42-911"></a>Tel: (310) 391-9971</span>
<span id="cb42-912"><a href="#cb42-912"></a>Fax: (310) 391-8971</span>
<span id="cb42-913"><a href="#cb42-913"></a>Web: www.StatModel.com</span>
<span id="cb42-914"><a href="#cb42-914"></a>Support: Support@StatModel.com</span>
<span id="cb42-915"><a href="#cb42-915"></a></span>
<span id="cb42-916"><a href="#cb42-916"></a>Copyright (c) 1998-2021 Muthen &amp; Muthen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<!-- -->


</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-bengtsson_2021_UnifyingFrameworkParallel" class="csl-entry" role="doc-biblioentry">
Bengtsson, Henrik. 2020. <span>“A Unifying Framework for Parallel and Distributed Processing in r Using Futures,”</span> August. <a href="https://arxiv.org/abs/2008.00553">https://arxiv.org/abs/2008.00553</a>.
</div>
<div id="ref-bien_2016_SimulatorEngineStreamline" class="csl-entry" role="doc-biblioentry">
Bien, Jacob. 2016. <span>“The Simulator: An Engine to Streamline Simulations.”</span> <em>arXiv:1607.00021 [Stat]</em>, June. <a href="http://arxiv.org/abs/1607.00021">http://arxiv.org/abs/1607.00021</a>.
</div>
<div id="ref-hallquist_2018_MplusAutomationPackageFacilitating" class="csl-entry" role="doc-biblioentry">
Hallquist, Michael N., and Joshua F. Wiley. 2018. <span>“<span><em>MplusAutomation</em></span> : An R Package for Facilitating Large-Scale Latent Variable Analyses in M <span><em>Plus</em></span>.”</span> <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 25 (4): 621–38. <a href="https://doi.org/10.1080/10705511.2017.1402334">https://doi.org/10.1080/10705511.2017.1402334</a>.
</div>
<div id="ref-haqiqatkhah_2022_SkewnessStagingDoes" class="csl-entry" role="doc-biblioentry">
Haqiqatkhah, MH Manuel, Oisín Ryan, and Ellen L. Hamaker. 2022. <span>“Skewness and Staging: Does the Floor Effect Induce Bias in Multilevel AR(1) Models?”</span> <a href="https://doi.org/10.31234/osf.io/myuvr">https://doi.org/10.31234/osf.io/myuvr</a>.
</div>
<div id="ref-muthen_2017_MplusUserGuide" class="csl-entry" role="doc-biblioentry">
Muthén, Linda K., and Bengt O. Muthén. 2017. <em>Mplus User<span>’</span>s Guide</em>. Eighth Edition. Los Angeles, CA: Muthén &amp; Muthén.
</div>
<div id="ref-schmiedek_2010_HundredDaysCognitive" class="csl-entry" role="doc-biblioentry">
Schmiedek, Florian, Martin Lövdén, and Ulman Lindenberger. 2010. <span>“Hundred Days of Cognitive Training Enhance Broad Cognitive Abilities in Adulthood: Findings from the COGITO Study.”</span> <em>Frontiers in Aging Neuroscience</em> 2. <a href="https://doi.org/10.3389/fnagi.2010.00027">https://doi.org/10.3389/fnagi.2010.00027</a>.
</div>
<div id="ref-tierney_2021_SnowSimpleNetwork" class="csl-entry" role="doc-biblioentry">
Tierney, Luke, A. J. Rossini, Na Li, and H. Sevcikova. 2021. <em>Snow: Simple Network of Workstations</em>. <a href="https://CRAN.R-project.org/package=snow">https://CRAN.R-project.org/package=snow</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The <span class="math inline">\(\chi^2\)</span>AR(1), in a more general form, can have an intercept (<span class="math inline">\(X_{t} = c + \phi X_{t-1} + a_t, \quad a_t \sim \chi^2(\nu)\)</span>. Since the intercept was set to zero in the simulation study, we discussed a zero-intercept version of this model (<span class="math inline">\(c=0\)</span>) in the paper. See the Supplemental Materials for more details.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">---</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="an">title:</span><span class="co"> "Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?"</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="an">subtitle:</span><span class="co"> "Reproducible codes"</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="an">author:</span><span class="co"> "MH Manuel Haqiqatkhah"</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="an">format:</span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="co">  html:</span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">    code-fold: true</span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">    output-file: "index.html"</span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co">    toc: true</span></span>
<span id="cb43-13"><a href="#cb43-13"></a><span class="co">    toc-location: left</span></span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="co">    number-sections: true</span></span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="co">    number-offset: -1</span></span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="co">    link-external-newwindow: true</span></span>
<span id="cb43-17"><a href="#cb43-17"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="co">    self-contained: false</span></span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="co">    self-contained-math: false</span></span>
<span id="cb43-20"><a href="#cb43-20"></a><span class="co">    code-summary: "Click to expand the code"</span></span>
<span id="cb43-21"><a href="#cb43-21"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb43-22"><a href="#cb43-22"></a><span class="co">    reference-location: document</span></span>
<span id="cb43-23"><a href="#cb43-23"></a><span class="co">    citation-location: document</span></span>
<span id="cb43-24"><a href="#cb43-24"></a><span class="co">    theme:</span></span>
<span id="cb43-25"><a href="#cb43-25"></a><span class="co">      light: litera</span></span>
<span id="cb43-26"><a href="#cb43-26"></a><span class="co">      dark: darkly</span></span>
<span id="cb43-27"><a href="#cb43-27"></a><span class="co">    # comments:</span></span>
<span id="cb43-28"><a href="#cb43-28"></a><span class="co">    #   hypothesis: true</span></span>
<span id="cb43-29"><a href="#cb43-29"></a><span class="co">  pdf:</span></span>
<span id="cb43-30"><a href="#cb43-30"></a><span class="co">    number-sections: true</span></span>
<span id="cb43-31"><a href="#cb43-31"></a><span class="co">    number-depth: 8</span></span>
<span id="cb43-32"><a href="#cb43-32"></a><span class="co">    #number-offset: -1</span></span>
<span id="cb43-33"><a href="#cb43-33"></a><span class="co">    toc: true</span></span>
<span id="cb43-34"><a href="#cb43-34"></a><span class="co">    output-file: Code documentations</span></span>
<span id="cb43-35"><a href="#cb43-35"></a><span class="co">    toc-depth: 8</span></span>
<span id="cb43-36"><a href="#cb43-36"></a><span class="co">## For html</span></span>
<span id="cb43-37"><a href="#cb43-37"></a><span class="an">execute:</span></span>
<span id="cb43-38"><a href="#cb43-38"></a><span class="co">  enabled: true</span></span>
<span id="cb43-39"><a href="#cb43-39"></a><span class="co">  echo: true</span></span>
<span id="cb43-40"><a href="#cb43-40"></a><span class="co">  include: true</span></span>
<span id="cb43-41"><a href="#cb43-41"></a><span class="co">  warning: false</span></span>
<span id="cb43-42"><a href="#cb43-42"></a><span class="co">  error: false</span></span>
<span id="cb43-43"><a href="#cb43-43"></a><span class="co">  freeze: auto</span></span>
<span id="cb43-44"><a href="#cb43-44"></a><span class="co">  cache: refresh</span></span>
<span id="cb43-45"><a href="#cb43-45"></a><span class="co">## For pdf</span></span>
<span id="cb43-46"><a href="#cb43-46"></a><span class="co"># execute:</span></span>
<span id="cb43-47"><a href="#cb43-47"></a><span class="co">#   enabled: true</span></span>
<span id="cb43-48"><a href="#cb43-48"></a><span class="co">#   echo: false</span></span>
<span id="cb43-49"><a href="#cb43-49"></a><span class="co">#   include: false</span></span>
<span id="cb43-50"><a href="#cb43-50"></a><span class="co">#   warning: false</span></span>
<span id="cb43-51"><a href="#cb43-51"></a><span class="co">#   error: false</span></span>
<span id="cb43-52"><a href="#cb43-52"></a><span class="co">#   freeze: auto</span></span>
<span id="cb43-53"><a href="#cb43-53"></a><span class="co">#   cache: refresh</span></span>
<span id="cb43-54"><a href="#cb43-54"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb43-55"><a href="#cb43-55"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb43-56"><a href="#cb43-56"></a><span class="co">---</span></span>
<span id="cb43-57"><a href="#cb43-57"></a></span>
<span id="cb43-58"><a href="#cb43-58"></a><span class="fu"># Introduction {#sec-introduction}</span></span>
<span id="cb43-59"><a href="#cb43-59"></a></span>
<span id="cb43-60"><a href="#cb43-60"></a>This document contains the reproducible code for the manuscript *Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?* by @haqiqatkhah_2022_SkewnessStagingDoes. Please cite this document with the following info:</span>
<span id="cb43-61"><a href="#cb43-61"></a></span>
<span id="cb43-62"><a href="#cb43-62"></a><span class="at">&gt; Haqiqatkhah, M. M., Ryan, O., &amp; Hamaker, E. L. (2022). *Skewness and staging: Does the floor effect induce bias in multilevel AR(1) models?* PsyArXiv. </span><span class="ot">&lt;https://doi.org/10.31234/osf.io/myuvr&gt;</span></span>
<span id="cb43-63"><a href="#cb43-63"></a></span>
<span id="cb43-64"><a href="#cb43-64"></a>In this study, we simulated multilevel data from three data generating mechanisms (DGMs), namely, the AR(1), $\chi^2$AR(1), BinAR(1), and PoDAR(1) models with different parameter sets. The simulation was conducted using the following modular pipeline design, inspired by Bien's R package <span class="in">`simulator`</span> <span class="co">[</span><span class="ot">-@bien_2016_SimulatorEngineStreamline</span><span class="co">]</span>, consisting of the following **components**:</span>
<span id="cb43-65"><a href="#cb43-65"></a></span>
<span id="cb43-66"><a href="#cb43-66"></a>A.  *Simulation*: generating the datasets</span>
<span id="cb43-67"><a href="#cb43-67"></a>B.  *Analysis*: modeling the data</span>
<span id="cb43-68"><a href="#cb43-68"></a>C.  *Harvesting*: collecting the relevant parameter estimates</span>
<span id="cb43-69"><a href="#cb43-69"></a>D.  *Reporting*: making tables and plots</span>
<span id="cb43-70"><a href="#cb43-70"></a></span>
<span id="cb43-71"><a href="#cb43-71"></a>And the components were placed in a **pipeline**, that managed:</span>
<span id="cb43-72"><a href="#cb43-72"></a></span>
<span id="cb43-73"><a href="#cb43-73"></a><span class="ss">1.  </span>Making the simulation design matrix that include all relevant conditions</span>
<span id="cb43-74"><a href="#cb43-74"></a><span class="ss">2.  </span>Book-keeping data files belonging to each replication of each condition</span>
<span id="cb43-75"><a href="#cb43-75"></a><span class="ss">3.  </span>Performing simulations in batch</span>
<span id="cb43-76"><a href="#cb43-76"></a><span class="ss">4.  </span>Performing Analyses in batch</span>
<span id="cb43-77"><a href="#cb43-77"></a><span class="ss">5.  </span>Collecting the data in batch</span>
<span id="cb43-78"><a href="#cb43-78"></a></span>
<span id="cb43-79"><a href="#cb43-79"></a>This document is structured as follows. In @sec-components, we explain the four components and the functions used therein. Then, in @sec-pipeline we explain the wrapper functions used in the pipeline, and show how the pipeline was---and can be---executed. Then, in @sec-simulation-results, we discuss how the harvested data was used to make the figures used in the paper (and others that were not included). Finally, in @sec-additional-analyses-and-figures we discuss how supplementary plots were made and how the empirical data analysis <span class="co">[</span><span class="ot">on COGITO data; @schmiedek_2010_HundredDaysCognitive</span><span class="co">]</span> was done. Note that although the codes provided here are cleaned as much as possible, they are not necessarily succinctly written; some functions were written to accommodate the most general functionalities which turned out to be not necessary for the simulation study.</span>
<span id="cb43-80"><a href="#cb43-80"></a></span>
<span id="cb43-81"><a href="#cb43-81"></a>::: callout-important</span>
<span id="cb43-82"><a href="#cb43-82"></a><span class="fu">## Addendum: Version 2</span></span>
<span id="cb43-83"><a href="#cb43-83"></a></span>
<span id="cb43-84"><a href="#cb43-84"></a>Following a request from a reviewer to implement and run another set of analyses, some additional functions and adaptations have been made. These changes are specified with <span class="in">`v2`</span> throughout this document and in codes and do not change the legacy code and text.</span>
<span id="cb43-85"><a href="#cb43-85"></a>:::</span>
<span id="cb43-86"><a href="#cb43-86"></a></span>
<span id="cb43-87"><a href="#cb43-87"></a>The <span class="co">[</span><span class="ot">GitHub {{&lt; fa brands github &gt;}} repository of this study</span><span class="co">](https://github.com/psyguy/skewness-staging)</span> contains all of the code necessary to run the study (in the <span class="in">`scripts`</span> folder <span class="co">[</span><span class="ot">{{&lt; fa globe &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/tree/main/scripts)</span>). Furthermore, because running the whole study would take a huge amount of time (it took us more than 88 days on a 24-core server and produced 2.69 TB of data), the the raw and summarized datasets of the estimated parameters are provided in <span class="in">`simulation-files/harvests`</span> <span class="co">[</span><span class="ot">{{&lt; fa globe &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/tree/main/simulation-files/harvest-files)</span>. To give an impression of the simulated datasets and the analysis output files, the <span class="in">`.rds`</span> files of the first replication of the study are also provided in <span class="in">`simulation-files`</span> folder <span class="co">[</span><span class="ot">{{&lt; fa globe &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/tree/main/simulation-files)</span>, and the *M*plus files of the first replication of the $N=100, T=100$ condition is provided in the <span class="in">`Mplus-files`</span> folder <span class="co">[</span><span class="ot">{{&lt; fa globe &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/tree/main/Mplus-files)</span>. Finally, all the figures that can be generated based on the study results are provided in the <span class="in">`figures`</span> folder <span class="co">[</span><span class="ot">{{&lt; fa globe &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/tree/main/figures)</span>. The figures are also referenced individually in @sec-simulation-results and @sec-additional-analyses-and-figures of this document.</span>
<span id="cb43-88"><a href="#cb43-88"></a></span>
<span id="cb43-89"><a href="#cb43-89"></a>To replicate the study from the scratch, you should first either clone the repository (using <span class="in">`git clone https://github.com/psyguy/skewness-staging.git`</span>) or <span class="co">[</span><span class="ot">download the repository as a zip file {{&lt; fa download &gt;}}</span><span class="co">](https://github.com/psyguy/skewness-staging/archive/refs/heads/main.zip)</span> and extract it on your machine. Then you can sequentially run the <span class="in">`.R`</span> files you find in the <span class="in">`scripts`</span> folder. Note that you would need to have a licensed version of *M*plus version 8.6 <span class="co">[</span><span class="ot">@muthen_2017_MplusUserGuide</span><span class="co">]</span> on your machine to run the whole study. Instead of running the scripts separately, if you have <span class="co">[</span><span class="ot">Quarto installed {{&lt; fa globe &gt;}}</span><span class="co">](https://quarto.org/docs/get-started/)</span>, you can also compile <span class="in">`Code documentations.qmd`</span> located in the root directory using Quarto after setting the following variables to <span class="in">`TRUE`</span>:</span>
<span id="cb43-90"><a href="#cb43-90"></a></span>
<span id="cb43-93"><a href="#cb43-93"></a><span class="in">```{r}</span></span>
<span id="cb43-94"><a href="#cb43-94"></a><span class="co">#| eval: true</span></span>
<span id="cb43-95"><a href="#cb43-95"></a><span class="co">#| echo: true</span></span>
<span id="cb43-96"><a href="#cb43-96"></a><span class="co">#| code-fold: false</span></span>
<span id="cb43-97"><a href="#cb43-97"></a>study_RunPipeline <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb43-98"><a href="#cb43-98"></a>study_MakeMainPlots <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb43-99"><a href="#cb43-99"></a>study_MakeAdditionalPlots <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb43-100"><a href="#cb43-100"></a><span class="in">```</span></span>
<span id="cb43-101"><a href="#cb43-101"></a></span>
<span id="cb43-102"><a href="#cb43-102"></a>Finally, in case you want to change the scripts (e.g., to run a smaller portion of the simulation, or try other parameters, etc.), you should look up the <span class="in">`kintr`</span> parameters called in each chunk (with <span class="in">`&lt;&lt;some_param&gt;&gt;`</span>) and find the corresponding code (under <span class="in">`## @knitr some_param`</span>) in the <span class="in">`scripts`</span> folder.</span>
<span id="cb43-103"><a href="#cb43-103"></a></span>
<span id="cb43-106"><a href="#cb43-106"></a><span class="in">```{r}</span></span>
<span id="cb43-107"><a href="#cb43-107"></a><span class="co">#| label: setup</span></span>
<span id="cb43-108"><a href="#cb43-108"></a><span class="co">#| echo: false</span></span>
<span id="cb43-109"><a href="#cb43-109"></a><span class="co">#| include: false</span></span>
<span id="cb43-110"><a href="#cb43-110"></a><span class="co">#| eval: true</span></span>
<span id="cb43-111"><a href="#cb43-111"></a><span class="co">#| cache: false</span></span>
<span id="cb43-112"><a href="#cb43-112"></a><span class="co">#| freeze: false</span></span>
<span id="cb43-113"><a href="#cb43-113"></a></span>
<span id="cb43-114"><a href="#cb43-114"></a><span class="fu">library</span>(knitr)</span>
<span id="cb43-115"><a href="#cb43-115"></a></span>
<span id="cb43-116"><a href="#cb43-116"></a>scripts <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"scripts/"</span>,</span>
<span id="cb43-117"><a href="#cb43-117"></a>                      <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-118"><a href="#cb43-118"></a></span>
<span id="cb43-119"><a href="#cb43-119"></a><span class="fu">sapply</span>(scripts, knitr<span class="sc">::</span>read_chunk)</span>
<span id="cb43-120"><a href="#cb43-120"></a></span>
<span id="cb43-121"><a href="#cb43-121"></a>study_Initialize <span class="ot">&lt;-</span> study_RunPipeline <span class="sc">|</span> study_MakeMainPlots <span class="sc">|</span> study_MakeAdditionalPlots</span>
<span id="cb43-122"><a href="#cb43-122"></a></span>
<span id="cb43-123"><a href="#cb43-123"></a><span class="in">```</span></span>
<span id="cb43-124"><a href="#cb43-124"></a></span>
<span id="cb43-125"><a href="#cb43-125"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-126"><a href="#cb43-126"></a><span class="co">#| include: false</span></span>
<span id="cb43-127"><a href="#cb43-127"></a><span class="co">#| echo: false</span></span>
<span id="cb43-128"><a href="#cb43-128"></a><span class="sc">&lt;</span><span class="er">&lt;</span>load_packages<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-129"><a href="#cb43-129"></a><span class="in">```</span></span>
<span id="cb43-130"><a href="#cb43-130"></a></span>
<span id="cb43-131"><a href="#cb43-131"></a><span class="fu"># Core components {#sec-components}</span></span>
<span id="cb43-132"><a href="#cb43-132"></a></span>
<span id="cb43-133"><a href="#cb43-133"></a><span class="fu">## The *Simulation* component {#sec-simulation-component}</span></span>
<span id="cb43-134"><a href="#cb43-134"></a></span>
<span id="cb43-135"><a href="#cb43-135"></a>The Simulation component consists of three sets of functions:</span>
<span id="cb43-136"><a href="#cb43-136"></a></span>
<span id="cb43-137"><a href="#cb43-137"></a>i.  Functions that implement the DGMs and generate univariate ($N=1$) time series of length $T$ from the parameters given to them;</span>
<span id="cb43-138"><a href="#cb43-138"></a>ii. Wrappers that interface the DGM functions;</span>
<span id="cb43-139"><a href="#cb43-139"></a>iii. A wrapper to generate datasets (consisting on $N$ time series of length $T$) with a given DGM</span>
<span id="cb43-140"><a href="#cb43-140"></a></span>
<span id="cb43-141"><a href="#cb43-141"></a><span class="fu">### Data-generating models specifications {#sec-dgm-specifications}</span></span>
<span id="cb43-142"><a href="#cb43-142"></a></span>
<span id="cb43-143"><a href="#cb43-143"></a>First we define functions for each data-generating models (DGMs) that can produce univariate, single-subject ($N=1$) time series of desired length $T$ (default: <span class="in">`T = 100`</span>) with the two canonical parameters and a given random seed (default: <span class="in">`seed = 0`</span>). All model(-implied) parameters are saved in a list (called <span class="in">`pa`</span>).</span>
<span id="cb43-144"><a href="#cb43-144"></a></span>
<span id="cb43-145"><a href="#cb43-145"></a>For each model, the first observation ($X_1$) is randomly drawn from the model-implied marginal distribution, to eliminate the need for removing the burn-in window in the beginning of the data. After the data is generated, in case the argument <span class="in">`only.ts`</span> is set to be <span class="in">`TRUE`</span>, the raw data (as a vector of length <span class="in">`T`</span>) is returned. Otherwise, the function calculates empirical dynamic ($\phi$) and marginal ($\mu$, $\sigma^2$, and $\gamma$) parameters based on the simulated data, and save it in a list (<span class="in">`Empirical.Parameters`</span>). Furthermore, two <span class="in">`r ifelse(knitr::is_html_output(), r"($\mathrm{\LaTeX{}}$)", r"(\LaTeX{})")`</span>-ready strings (<span class="in">`Model.Description`</span> and <span class="in">`Model.Description.Short`</span>) are made which include a summary of the model parameters (that can be used, e.g., in plots). Finally, in case <span class="in">`only.ts != TRUE`</span>, the function returns a list consisting of the time series (stored in <span class="in">`x`</span>), verbal description of the dataset (<span class="in">`Model.Description`</span> and <span class="in">`Model.Description.Short`</span>), theoretical (i.e., model-implied) parameters (<span class="in">`Model.Parameters`</span>), and empirical (i.e., sample) estimated parameters (<span class="in">`Empirical.Parameters`</span>).</span>
<span id="cb43-146"><a href="#cb43-146"></a></span>
<span id="cb43-147"><a href="#cb43-147"></a>::: panel-tabset</span>
<span id="cb43-148"><a href="#cb43-148"></a><span class="fu">#### The AR(1) model</span></span>
<span id="cb43-149"><a href="#cb43-149"></a></span>
<span id="cb43-150"><a href="#cb43-150"></a>The canonical parameters of the AR(1) model with normally distributed residuals (which we referred to as <span class="in">`NAR(1)`</span> in the simulation) are the autoregressive parameter $\phi$ (default: <span class="in">`phi = 0.4`</span>), mean $\mu$ (default: <span class="in">`Mean = 50`</span>), and the marginal variance $\sigma^2$ (default: <span class="in">`var.marginal = 4`</span>). Based on the marginal variance, the residual variance (<span class="in">`var.resid`</span>) is calculated via $\sigma^2_\epsilon = \sigma^2 (1 - \phi^2)$.</span>
<span id="cb43-151"><a href="#cb43-151"></a></span>
<span id="cb43-152"><a href="#cb43-152"></a><span class="fu">##### Construction</span></span>
<span id="cb43-153"><a href="#cb43-153"></a></span>
<span id="cb43-154"><a href="#cb43-154"></a>The time series is constructed by first generating a zero-centered time series $\tilde X_t$ (<span class="in">`x_cent`</span>). To do so, first the initial observation in the time series (<span class="in">`x_cent[1]`</span>) is sampled from normal distribution with mean zero and a variance equal to the marginal variance of the model:</span>
<span id="cb43-155"><a href="#cb43-155"></a></span>
<span id="cb43-156"><a href="#cb43-156"></a>$$</span>
<span id="cb43-157"><a href="#cb43-157"></a>\tilde X_1 \sim \mathcal{N}(0, \sigma^2)</span>
<span id="cb43-158"><a href="#cb43-158"></a>$$</span>
<span id="cb43-159"><a href="#cb43-159"></a></span>
<span id="cb43-160"><a href="#cb43-160"></a>Then, the remainder of the time series is generated using the definition of the AR(1) model (note that here the residual variance is used in the normal distribution):</span>
<span id="cb43-161"><a href="#cb43-161"></a></span>
<span id="cb43-162"><a href="#cb43-162"></a>$$</span>
<span id="cb43-163"><a href="#cb43-163"></a>\begin{aligned}</span>
<span id="cb43-164"><a href="#cb43-164"></a>\tilde X_{t} &amp;= \phi \tilde X_{t-1} + \epsilon_{t} <span class="sc">\\</span></span>
<span id="cb43-165"><a href="#cb43-165"></a>\epsilon_{t} &amp;\sim \mathcal{N}(0, {\sigma^2_{\epsilon}})</span>
<span id="cb43-166"><a href="#cb43-166"></a>\end{aligned}</span>
<span id="cb43-167"><a href="#cb43-167"></a>$$</span>
<span id="cb43-168"><a href="#cb43-168"></a></span>
<span id="cb43-169"><a href="#cb43-169"></a>Finally, the mean is added to the centered zero-centered time series to reach the final time series with mean $\mu$:</span>
<span id="cb43-170"><a href="#cb43-170"></a></span>
<span id="cb43-171"><a href="#cb43-171"></a>$$</span>
<span id="cb43-172"><a href="#cb43-172"></a>X_t = \tilde X_t + \mu</span>
<span id="cb43-173"><a href="#cb43-173"></a>$$</span>
<span id="cb43-174"><a href="#cb43-174"></a></span>
<span id="cb43-175"><a href="#cb43-175"></a><span class="fu">##### Code</span></span>
<span id="cb43-176"><a href="#cb43-176"></a></span>
<span id="cb43-177"><a href="#cb43-177"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-178"><a href="#cb43-178"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_nar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-179"><a href="#cb43-179"></a><span class="in">```</span></span>
<span id="cb43-180"><a href="#cb43-180"></a></span>
<span id="cb43-181"><a href="#cb43-181"></a><span class="fu">#### The $\chi^2$AR(1) model</span></span>
<span id="cb43-182"><a href="#cb43-182"></a></span>
<span id="cb43-183"><a href="#cb43-183"></a>The canonical parameters of the $\chi^2$AR(1) model (which we referred to as <span class="in">`ChiAR(1)`</span> in the simulation) are the autoregressive parameter $\phi$ (default: <span class="in">`phi = 0.4`</span>), and degrees of freedom $\nu$ (default: <span class="in">`nu = 3`</span>). We set the intercept to zero (<span class="in">`c = 0`</span>).<span class="ot">[^1]</span></span>
<span id="cb43-184"><a href="#cb43-184"></a></span>
<span id="cb43-185"><a href="#cb43-185"></a><span class="fu">##### Construction</span></span>
<span id="cb43-186"><a href="#cb43-186"></a></span>
<span id="cb43-187"><a href="#cb43-187"></a>Similar to the AR(1) model, we need to sample the first observation of the $\chi^2$AR(1) model from its marginal distribution. However, since this model does not have a closed-form marginal distribution, as an approximation, we instead sample <span class="in">`x[1]`</span> from a $\chi^2$ distribution with $\nu$ degrees of freedom:</span>
<span id="cb43-188"><a href="#cb43-188"></a></span>
<span id="cb43-189"><a href="#cb43-189"></a>$$</span>
<span id="cb43-190"><a href="#cb43-190"></a>X_1 \sim \chi^2(\nu)</span>
<span id="cb43-191"><a href="#cb43-191"></a>$$</span>
<span id="cb43-192"><a href="#cb43-192"></a></span>
<span id="cb43-193"><a href="#cb43-193"></a>Then, we generate the remainder of the time series using the definition of the $\chi^2$AR(1) model:</span>
<span id="cb43-194"><a href="#cb43-194"></a></span>
<span id="cb43-195"><a href="#cb43-195"></a>$$</span>
<span id="cb43-196"><a href="#cb43-196"></a>\begin{aligned}</span>
<span id="cb43-197"><a href="#cb43-197"></a>X_{t} &amp;= c + \phi X_{t-1} + a_{t} <span class="sc">\\</span></span>
<span id="cb43-198"><a href="#cb43-198"></a>a_{t} &amp;\sim \chi^2(\nu).</span>
<span id="cb43-199"><a href="#cb43-199"></a>\end{aligned}</span>
<span id="cb43-200"><a href="#cb43-200"></a>$$</span>
<span id="cb43-201"><a href="#cb43-201"></a></span>
<span id="cb43-202"><a href="#cb43-202"></a><span class="fu">##### Code</span></span>
<span id="cb43-203"><a href="#cb43-203"></a></span>
<span id="cb43-204"><a href="#cb43-204"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-205"><a href="#cb43-205"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_chiar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-206"><a href="#cb43-206"></a><span class="in">```</span></span>
<span id="cb43-207"><a href="#cb43-207"></a></span>
<span id="cb43-208"><a href="#cb43-208"></a><span class="fu">#### The BinAR(1) model</span></span>
<span id="cb43-209"><a href="#cb43-209"></a></span>
<span id="cb43-210"><a href="#cb43-210"></a>The canonical parameters of the BinAR(1) model (which we referred to as <span class="in">`BinAR(1)`</span> in the simulation) are the survival probability $\alpha$ (default: <span class="in">`alpha = 0.5`</span>) and the revival probability $\beta$ (default: <span class="in">`beta = 0.4`</span>). By default, the maximum value on scale $k$ was set to <span class="in">`k = 10`</span>.</span>
<span id="cb43-211"><a href="#cb43-211"></a></span>
<span id="cb43-212"><a href="#cb43-212"></a><span class="fu">##### Construction</span></span>
<span id="cb43-213"><a href="#cb43-213"></a></span>
<span id="cb43-214"><a href="#cb43-214"></a>We first calculate the $\theta$ parameter, which characterizes the marginal distribution of the BinaR(1) model:</span>
<span id="cb43-215"><a href="#cb43-215"></a></span>
<span id="cb43-216"><a href="#cb43-216"></a>$$</span>
<span id="cb43-217"><a href="#cb43-217"></a>\theta = \frac{k \beta}{1-(\alpha-\beta)}</span>
<span id="cb43-218"><a href="#cb43-218"></a>$$ Then we draw $X_1$ (<span class="in">`x[1]`</span>) from the marginal distribution of the model:</span>
<span id="cb43-219"><a href="#cb43-219"></a></span>
<span id="cb43-220"><a href="#cb43-220"></a>$$</span>
<span id="cb43-221"><a href="#cb43-221"></a>X_1 \sim Binom(k, \theta)</span>
<span id="cb43-222"><a href="#cb43-222"></a>$$</span>
<span id="cb43-223"><a href="#cb43-223"></a></span>
<span id="cb43-224"><a href="#cb43-224"></a>The rest of time series is generated sequentially, for each time point $t$, by drawing values for the number of survived (<span class="in">`S_t[t]`</span>) and revived (<span class="in">`R_t[t]`</span>) elements of the BinAR(1) model based on the previous observations ($X_{t-1}$), and then adding them:</span>
<span id="cb43-225"><a href="#cb43-225"></a></span>
<span id="cb43-226"><a href="#cb43-226"></a>$$</span>
<span id="cb43-227"><a href="#cb43-227"></a>\begin{aligned}</span>
<span id="cb43-228"><a href="#cb43-228"></a>S_{t} &amp;\sim Binom(X_{t-1}, \alpha) <span class="sc">\\</span></span>
<span id="cb43-229"><a href="#cb43-229"></a>R_t &amp;\sim Binom(k -X_{t-1}, \beta) <span class="sc">\\</span></span>
<span id="cb43-230"><a href="#cb43-230"></a>X_{t} &amp;= S_t + R_t</span>
<span id="cb43-231"><a href="#cb43-231"></a>\end{aligned}</span>
<span id="cb43-232"><a href="#cb43-232"></a>$$</span>
<span id="cb43-233"><a href="#cb43-233"></a></span>
<span id="cb43-234"><a href="#cb43-234"></a><span class="fu">##### Code</span></span>
<span id="cb43-235"><a href="#cb43-235"></a></span>
<span id="cb43-236"><a href="#cb43-236"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-237"><a href="#cb43-237"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_binar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-238"><a href="#cb43-238"></a><span class="in">```</span></span>
<span id="cb43-239"><a href="#cb43-239"></a></span>
<span id="cb43-240"><a href="#cb43-240"></a><span class="fu">#### The PoDAR(1) model</span></span>
<span id="cb43-241"><a href="#cb43-241"></a></span>
<span id="cb43-242"><a href="#cb43-242"></a>The canonical parameters of the PoDAR(1) model (which we referred to as <span class="in">`PoDAR(1)`</span> in the simulation) are the persistence probability $\tau$ (default: <span class="in">`tau = 0.7`</span>) and the average rate $\lambda$ (default: <span class="in">`lambda = 0.5`</span>).</span>
<span id="cb43-243"><a href="#cb43-243"></a></span>
<span id="cb43-244"><a href="#cb43-244"></a><span class="fu">##### Construction</span></span>
<span id="cb43-245"><a href="#cb43-245"></a></span>
<span id="cb43-246"><a href="#cb43-246"></a>To generate the time series, we first draw the first observation $X_1$ (<span class="in">`x[1]`</span>) from a Poisson distribution with rate $\lambda$:</span>
<span id="cb43-247"><a href="#cb43-247"></a></span>
<span id="cb43-248"><a href="#cb43-248"></a>$$</span>
<span id="cb43-249"><a href="#cb43-249"></a>X_1 \sim Poisson(\lambda)</span>
<span id="cb43-250"><a href="#cb43-250"></a>$$</span>
<span id="cb43-251"><a href="#cb43-251"></a></span>
<span id="cb43-252"><a href="#cb43-252"></a>And generate the rest of the time series by first drawing $Z_t$ from a Poisson distribution with rate $\lambda$ and $P_t$ from a binomial distribution with size probability of success $\tau$ (that is equivalent to a Bernoulli distribution with probability $\tau$). Then, we calculate $X_t$ based on the previous observation (<span class="in">`x[t-1]`</span>) and values of $Z_t$ (<span class="in">`Z_t[t]`</span>) and $P_t$ (<span class="in">`P_t[t]`</span>), using the definition of the PoDAR(1) model:</span>
<span id="cb43-253"><a href="#cb43-253"></a></span>
<span id="cb43-254"><a href="#cb43-254"></a>$$</span>
<span id="cb43-255"><a href="#cb43-255"></a>\begin{aligned}</span>
<span id="cb43-256"><a href="#cb43-256"></a>Z_t &amp;\sim Poisson(\lambda) <span class="sc">\\</span></span>
<span id="cb43-257"><a href="#cb43-257"></a>P_t &amp;\sim Binom(1, \tau) <span class="sc">\\</span></span>
<span id="cb43-258"><a href="#cb43-258"></a>X_t &amp;= P_t X_{t-1} + (1-P_t) Z_t</span>
<span id="cb43-259"><a href="#cb43-259"></a>\end{aligned}</span>
<span id="cb43-260"><a href="#cb43-260"></a>$$</span>
<span id="cb43-261"><a href="#cb43-261"></a></span>
<span id="cb43-262"><a href="#cb43-262"></a><span class="fu">##### Code</span></span>
<span id="cb43-263"><a href="#cb43-263"></a></span>
<span id="cb43-264"><a href="#cb43-264"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-265"><a href="#cb43-265"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_podar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-266"><a href="#cb43-266"></a><span class="in">```</span></span>
<span id="cb43-267"><a href="#cb43-267"></a>:::</span>
<span id="cb43-268"><a href="#cb43-268"></a></span>
<span id="cb43-269"><a href="#cb43-269"></a><span class="ot">[^1]: </span>The $\chi^2$AR(1), in a more general form, can have an intercept ($X_{t} = c + \phi X_{t-1} + a_t, \quad a_t \sim \chi^2(\nu)$. Since the intercept was set to zero in the simulation study, we discussed a zero-intercept version of this model ($c=0$) in the paper. See the Supplemental Materials for more details.</span>
<span id="cb43-270"><a href="#cb43-270"></a></span>
<span id="cb43-271"><a href="#cb43-271"></a><span class="fu">### General DGM wrappers {#sec-general-dgm-wrappers}</span></span>
<span id="cb43-272"><a href="#cb43-272"></a></span>
<span id="cb43-273"><a href="#cb43-273"></a>Given that, in each model, two canonical parameters characterize the dynamic and marginal features of the generated time series, and given that we have analytic formulas that link the canonical parameters to the model-implied $\phi$, $\mu$, $\sigma^2$, and $\gamma$, we use a function (<span class="in">`dgm_parameterizer`</span>) to calculate canonical parameters from two given parameters, and make a complete list of parameters (called <span class="in">`pa`</span>). This list also includes non-parameter variables, importantly, the time series length $T$ (saved in <span class="in">`pa$T`</span>) and the random seed used in the <span class="in">`dgm_*`</span> functions (saved in <span class="in">`pa$seed`</span>). A wrapper function (<span class="in">`dgm_generator`</span>) is used as an interface to all <span class="in">`dgm_*`</span> functions, which first makes sure the given parameters are sufficient for data generation, makes a complete parameter list <span class="in">`pa`</span> with the help of <span class="in">`dgm_parameterizer`</span>, and passes <span class="in">`pa`</span> to the respective DGM generating function.</span>
<span id="cb43-274"><a href="#cb43-274"></a></span>
<span id="cb43-275"><a href="#cb43-275"></a>::: panel-tabset</span>
<span id="cb43-276"><a href="#cb43-276"></a><span class="fu">#### Parameter conversions</span></span>
<span id="cb43-277"><a href="#cb43-277"></a></span>
<span id="cb43-278"><a href="#cb43-278"></a>The function <span class="in">`dgm_parameterizer`</span> calculates canonical/model-implied parameters of a given DGM (specified using the <span class="in">`Model`</span> argument) based on the parameters given to it as arguments, and saves them in a list of parameters (<span class="in">`pa`</span>), which s returned by the function. The function makes sure that the set of parameters provided are sufficient to characterize the dynamic parameter of the model (i.e., the autoregression $\phi$) and at least one of the marginal parameters (importantly, the mean $\mu$) but giving default values to some parameters.</span>
<span id="cb43-279"><a href="#cb43-279"></a></span>
<span id="cb43-280"><a href="#cb43-280"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-281"><a href="#cb43-281"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_parameterizer<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-282"><a href="#cb43-282"></a><span class="in">```</span></span>
<span id="cb43-283"><a href="#cb43-283"></a></span>
<span id="cb43-284"><a href="#cb43-284"></a><span class="fu">#### Wrapper around `dgm_*` functions</span></span>
<span id="cb43-285"><a href="#cb43-285"></a></span>
<span id="cb43-286"><a href="#cb43-286"></a>The function <span class="in">`dgm_generator`</span> gets a set of parameters (either as separate arguments, or a list of parameters, like the one returned by <span class="in">`dgm_parameterizer`</span>), saves them in a list called <span class="in">`pa`</span>. It checks whether $\phi$ is included in the list (if not, sets the default value <span class="in">`pa$phi = 0.2`</span>), and checks if at least one other parameter (which, together with $\phi$, is required to characterize the marginal properties of the DGMs) is calculated for it (if not, it sets the default value <span class="in">`pa$Mean = 5`</span> for $\mu$). Furthermore, if the DGM name, time series length, and the random seed are not provided, it gives them default values (respectively: <span class="in">`Model = "ChiAR(1)"`</span>, <span class="in">`T = 100`</span>, and <span class="in">`seed = 0`</span>) and adds them to <span class="in">`pa`</span>.</span>
<span id="cb43-287"><a href="#cb43-287"></a></span>
<span id="cb43-288"><a href="#cb43-288"></a>Then, it passes the <span class="in">`pa`</span> list to <span class="in">`dgm_parameterizer`</span> to do the necessary conversions to complete the list of canonical and model-implied parameters. Finally, given the model name, it checks if non-canonical parameters $k$ and $c$ are set (otherwise assigns appropriate defaults to them), and passes the complete parameter list to the respective DGM function.</span>
<span id="cb43-289"><a href="#cb43-289"></a></span>
<span id="cb43-290"><a href="#cb43-290"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-291"><a href="#cb43-291"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_generator<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-292"><a href="#cb43-292"></a><span class="in">```</span></span>
<span id="cb43-293"><a href="#cb43-293"></a>:::</span>
<span id="cb43-294"><a href="#cb43-294"></a></span>
<span id="cb43-295"><a href="#cb43-295"></a><span class="fu">### Dataset generation {#sec-dataset-generation}</span></span>
<span id="cb43-296"><a href="#cb43-296"></a></span>
<span id="cb43-297"><a href="#cb43-297"></a>The machinery described above can be used to generate individual ($N=1$) time series. However, for the simulation study, we need datasets comprising of multiple ($N=25, 50, 100$) individuals. As we discussed in the paper, in our study, all individuals in a dataset of a DGM share the same autoregressive parameter ($\phi_i=0.4$) and the individual differences are only in the individual means ($\mathbb{\mu} = <span class="co">[</span><span class="ot">\mu_1 , \mu_2, \dots, \mu_N</span><span class="co">]</span>$). Thus, we write a function (<span class="in">`dgm_make.sample`</span>) that can generate, for each DGM, a dataset of $N$ individuals based on an $N$-dimensional vector of individual means, all with the same $\phi_i$. We then need to find the appropriate parameters for the level-2 distributions (Gaussian and $\chi^2$ distributions) for each DGM, such that the we get a considerable proportion of individuals with considerably high skewness while respecting the lower and upper bounds of values supported by each model. Finally, with a wrapper function (<span class="in">`make_datasets`</span>), we facilitate making dataset by automatically generating the means vector suitable for each DGM.</span>
<span id="cb43-298"><a href="#cb43-298"></a></span>
<span id="cb43-299"><a href="#cb43-299"></a>::: panel-tabset</span>
<span id="cb43-300"><a href="#cb43-300"></a><span class="fu">#### Making individual datasets</span></span>
<span id="cb43-301"><a href="#cb43-301"></a></span>
<span id="cb43-302"><a href="#cb43-302"></a>The function <span class="in">`dgm_make.sample`</span> generates a dataset of time series of length <span class="in">`T`</span> with the autoregressive parameter <span class="in">`phi`</span> from a desired DGM (determined by the <span class="in">`Model`</span> argument) given a vector of means (passed as the argument <span class="in">`Means`</span>). The length of <span class="in">`Means`</span> determine the number of individuals in the dataset (<span class="in">`N &lt;- length(Means)`</span>). If <span class="in">`Means`</span> is not provided, a randomly generated vector of $N = 100$ is used as default. Since each individual time series is generated with a random seed, we need a vector of <span class="in">`N`</span> unique seeds, which can be provided using the <span class="in">`seeds`</span> argument. In case <span class="in">`seeds`</span> is not provided, it is generated based on the provided means (<span class="in">`seeds.from.means`</span>), and if it is a scalar, the seeds vector is created by adding the scalar to the <span class="in">`seeds.from.means`</span> (which would allow generating different datasets with the same mean distributions).</span>
<span id="cb43-303"><a href="#cb43-303"></a></span>
<span id="cb43-304"><a href="#cb43-304"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-305"><a href="#cb43-305"></a><span class="sc">&lt;</span><span class="er">&lt;</span>dgm_make.sample<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-306"><a href="#cb43-306"></a><span class="in">```</span></span>
<span id="cb43-307"><a href="#cb43-307"></a></span>
<span id="cb43-308"><a href="#cb43-308"></a><span class="fu">#### Determining level-2 distribution parameters</span></span>
<span id="cb43-309"><a href="#cb43-309"></a></span>
<span id="cb43-310"><a href="#cb43-310"></a>For each alternative DGM---the $\chi^2$AR(1), BinAR(1), and PoDAR(1) models---we should determine appropriate parameters for the level-2 distribution of means such that we have enough skewness in the generated datasets. To do so, we make a function (<span class="in">`Mean.vs.Skewness`</span>) to help us experiment with different values for $\mu$ and $\sigma^2$ (of the Gaussian level-2 distribution) and $\nu$ (of the $\chi^2$ level-2 distribution) for each alternative DGM. Note that we start by generating more than enough samples for each distribution ($10 \times N$) and subsample $N$ values after applying the model-specific lower and upper bounds.</span>
<span id="cb43-311"><a href="#cb43-311"></a></span>
<span id="cb43-314"><a href="#cb43-314"></a><span class="in">```{r}</span></span>
<span id="cb43-315"><a href="#cb43-315"></a><span class="co">#| eval: true</span></span>
<span id="cb43-316"><a href="#cb43-316"></a><span class="co">#| echo: false</span></span>
<span id="cb43-317"><a href="#cb43-317"></a><span class="co">#| include: false</span></span>
<span id="cb43-318"><a href="#cb43-318"></a><span class="sc">&lt;</span><span class="er">&lt;</span>Mean.vs.Skewness<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-319"><a href="#cb43-319"></a><span class="in">```</span></span>
<span id="cb43-320"><a href="#cb43-320"></a></span>
<span id="cb43-321"><a href="#cb43-321"></a>We notice that we get the desired distribution of skewness with the following parameters:</span>
<span id="cb43-322"><a href="#cb43-322"></a></span>
<span id="cb43-323"><a href="#cb43-323"></a>| Model         | $\mu$ | $\sigma^2$ | $\nu$ |</span>
<span id="cb43-324"><a href="#cb43-324"></a>|---------------|-------|------------|-------|</span>
<span id="cb43-325"><a href="#cb43-325"></a>| $\chi^2$AR(1) | 10    | 10         | 5     |</span>
<span id="cb43-326"><a href="#cb43-326"></a>| BinAR(1)      | 2     | 1          | 2.9   |</span>
<span id="cb43-327"><a href="#cb43-327"></a>| PoDAR(1)      | 4     | 4          | 1.5   |</span>
<span id="cb43-328"><a href="#cb43-328"></a></span>
<span id="cb43-329"><a href="#cb43-329"></a>: Parameters of level-2 distribution of means</span>
<span id="cb43-330"><a href="#cb43-330"></a></span>
<span id="cb43-331"><a href="#cb43-331"></a>Giving us the following distributions:</span>
<span id="cb43-332"><a href="#cb43-332"></a></span>
<span id="cb43-335"><a href="#cb43-335"></a><span class="in">```{r}</span></span>
<span id="cb43-336"><a href="#cb43-336"></a><span class="co">#| eval: false</span></span>
<span id="cb43-337"><a href="#cb43-337"></a><span class="co">#| echo: false</span></span>
<span id="cb43-338"><a href="#cb43-338"></a><span class="co">#| include: false</span></span>
<span id="cb43-339"><a href="#cb43-339"></a></span>
<span id="cb43-340"><a href="#cb43-340"></a></span>
<span id="cb43-341"><a href="#cb43-341"></a>gaussian.means <span class="ot">&lt;-</span></span>
<span id="cb43-342"><a href="#cb43-342"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"Chi2AR"</span>,</span>
<span id="cb43-343"><a href="#cb43-343"></a>     <span class="at">l2.mean =</span> <span class="dv">10</span>,</span>
<span id="cb43-344"><a href="#cb43-344"></a>     <span class="at">l2.var =</span> <span class="dv">10</span>,</span>
<span id="cb43-345"><a href="#cb43-345"></a>     <span class="at">seed =</span> <span class="dv">1</span>)) <span class="sc">/</span></span>
<span id="cb43-346"><a href="#cb43-346"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"BinAR"</span>,</span>
<span id="cb43-347"><a href="#cb43-347"></a>     <span class="at">l2.mean =</span> <span class="dv">2</span>,</span>
<span id="cb43-348"><a href="#cb43-348"></a>     <span class="at">l2.var =</span> <span class="dv">1</span>,</span>
<span id="cb43-349"><a href="#cb43-349"></a>     <span class="at">seed =</span> <span class="dv">4</span>)) <span class="sc">/</span></span>
<span id="cb43-350"><a href="#cb43-350"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"PoDAR"</span>,</span>
<span id="cb43-351"><a href="#cb43-351"></a>                   <span class="at">l2.mean =</span> <span class="dv">4</span>,</span>
<span id="cb43-352"><a href="#cb43-352"></a>     <span class="at">seed =</span> <span class="dv">2</span>))</span>
<span id="cb43-353"><a href="#cb43-353"></a></span>
<span id="cb43-354"><a href="#cb43-354"></a>chi2.means <span class="ot">&lt;-</span></span>
<span id="cb43-355"><a href="#cb43-355"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"Chi2AR"</span>,</span>
<span id="cb43-356"><a href="#cb43-356"></a>     <span class="at">chi2.df =</span> <span class="dv">5</span>,</span>
<span id="cb43-357"><a href="#cb43-357"></a>     <span class="at">seed =</span> <span class="dv">1</span>)) <span class="sc">/</span></span>
<span id="cb43-358"><a href="#cb43-358"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"BinAR"</span>,</span>
<span id="cb43-359"><a href="#cb43-359"></a>     <span class="at">chi2.df =</span> <span class="fl">2.9</span>,</span>
<span id="cb43-360"><a href="#cb43-360"></a>     <span class="at">seed =</span> <span class="dv">1</span>)) <span class="sc">/</span></span>
<span id="cb43-361"><a href="#cb43-361"></a>  <span class="fu">wrap_elements</span>(<span class="fu">Mean.vs.Skewness</span>(<span class="st">"PoDAR"</span>,</span>
<span id="cb43-362"><a href="#cb43-362"></a>                   <span class="at">chi2.df =</span> <span class="fl">1.5</span>,</span>
<span id="cb43-363"><a href="#cb43-363"></a>     <span class="at">seed =</span> <span class="dv">4</span>))</span>
<span id="cb43-364"><a href="#cb43-364"></a></span>
<span id="cb43-365"><a href="#cb43-365"></a><span class="fu">ggsave</span>(<span class="st">"Mean_vs_Skewness.png"</span>,</span>
<span id="cb43-366"><a href="#cb43-366"></a>       <span class="fu">wrap_elements</span>(gaussian.means) <span class="sc">+</span></span>
<span id="cb43-367"><a href="#cb43-367"></a>       <span class="fu">wrap_elements</span>(chi2.means),</span>
<span id="cb43-368"><a href="#cb43-368"></a>       <span class="at">path =</span> <span class="st">"additional-files"</span>,</span>
<span id="cb43-369"><a href="#cb43-369"></a>       <span class="at">width =</span> <span class="dv">40</span>,</span>
<span id="cb43-370"><a href="#cb43-370"></a>       <span class="at">height =</span> <span class="dv">60</span>,</span>
<span id="cb43-371"><a href="#cb43-371"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb43-372"><a href="#cb43-372"></a><span class="in">```</span></span>
<span id="cb43-373"><a href="#cb43-373"></a></span>
<span id="cb43-374"><a href="#cb43-374"></a><span class="al">![](additional-files/Mean_vs_Skewness.png)</span></span>
<span id="cb43-375"><a href="#cb43-375"></a></span>
<span id="cb43-376"><a href="#cb43-376"></a><span class="fu">#### Automate dataset generation</span></span>
<span id="cb43-377"><a href="#cb43-377"></a></span>
<span id="cb43-378"><a href="#cb43-378"></a>We then use a wrapper (<span class="in">`make_datasets`</span>) around <span class="in">`dgm_make.sample`</span> that generates datasets for all four DGMs with the appropriate level-2 parameters specified above. Note that here we first generate more than enough (i.e., $2 \times N$) samples of means to make sure we end up with $N$ samples after applying the upper and lower bounds. The datasets are then saved, with some additional variables in separate <span class="in">`.rds`</span> files, using wrapper functions described in @sec-pipeline-functions.</span>
<span id="cb43-379"><a href="#cb43-379"></a></span>
<span id="cb43-380"><a href="#cb43-380"></a>::: callout-note</span>
<span id="cb43-381"><a href="#cb43-381"></a><span class="fu">## Addendum: Version 2</span></span>
<span id="cb43-382"><a href="#cb43-382"></a></span>
<span id="cb43-383"><a href="#cb43-383"></a>By setting <span class="in">`version = "v2"`</span> in <span class="in">`make_datasets`</span> (now the default), the vector of <span class="in">`Phis`</span> is randomly drawn from $\mathcal{N}(0.4, \sqrt{0.1})$. More specifically, like the means, $2 \times N$ values of $\phi$ are generated, the values not between 0 and 1 are removed, and $N$ values are randomly drawn from the remaining.</span>
<span id="cb43-384"><a href="#cb43-384"></a></span>
<span id="cb43-385"><a href="#cb43-385"></a>The function returns a list in this case, which contain the generated dataset <span class="in">`dataset`</span>, and the vectors of means <span class="in">`Means`</span> and $\phi$s <span class="in">`Phis`</span> used to generate it.</span>
<span id="cb43-386"><a href="#cb43-386"></a>:::</span>
<span id="cb43-387"><a href="#cb43-387"></a></span>
<span id="cb43-388"><a href="#cb43-388"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-389"><a href="#cb43-389"></a><span class="sc">&lt;</span><span class="er">&lt;</span>make_datasets<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-390"><a href="#cb43-390"></a><span class="in">```</span></span>
<span id="cb43-391"><a href="#cb43-391"></a>:::</span>
<span id="cb43-392"><a href="#cb43-392"></a></span>
<span id="cb43-393"><a href="#cb43-393"></a><span class="fu">## The *Analysis* component {#sec-analysis-component}</span></span>
<span id="cb43-394"><a href="#cb43-394"></a></span>
<span id="cb43-395"><a href="#cb43-395"></a>We analyzed each dataset with AR(1) models with fixed and random residual variance using *M*plus v. 8.1 [@muthen_2017_MplusUserGuide]. To interface *M*plus from R, we used the package `MplusAutomation` [@hallquist_2018_MplusAutomationPackageFacilitating] and wrote a function (`run_MplusAutomation`) that for each iteration of each condition would save the dataset as a `.dat` file, generate the `.inp` input script for the desired analysis type, and run the model for that dataset. *M*plus then saves the output files (<span class="in">`.out`</span> and <span class="in">`.gh5`</span>). After the analysis, <span class="in">`run_MplusAutomation`</span> extracts parameter estimates and returns them in an <span class="in">`R`</span> object, which, with some additional variables, are saved in separate <span class="in">`.rds`</span> files using wrapper functions described in @sec-pipeline-functions.</span>
<span id="cb43-396"><a href="#cb43-396"></a></span>
<span id="cb43-397"><a href="#cb43-397"></a>::: callout-note</span>
<span id="cb43-398"><a href="#cb43-398"></a><span class="fu">## Addendum: Version 2</span></span>
<span id="cb43-399"><a href="#cb43-399"></a></span>
<span id="cb43-400"><a href="#cb43-400"></a>In <span class="in">`v2`</span>, to make the analysis and data storage more efficient, <span class="in">`run_MplusAutomation`</span> removes the *M*plus files generated by <span class="in">`MplusAutomation::mplusModeler`</span> (<span class="in">`.inp`</span>, <span class="in">`.dat`</span>, <span class="in">`.out`</span>, and <span class="in">`.gh5`</span>), and drops <span class="in">`$results$gh5`</span> from <span class="in">`mplusModeler`</span>'s output (which would save a lot of space).</span>
<span id="cb43-401"><a href="#cb43-401"></a>:::</span>
<span id="cb43-402"><a href="#cb43-402"></a></span>
<span id="cb43-403"><a href="#cb43-403"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-404"><a href="#cb43-404"></a><span class="sc">&lt;</span><span class="er">&lt;</span>run_MplusAutomation<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-405"><a href="#cb43-405"></a><span class="in">```</span></span>
<span id="cb43-406"><a href="#cb43-406"></a></span>
<span id="cb43-407"><a href="#cb43-407"></a>In each analysis, we simulated two MCMC chains (<span class="in">`CHAINS = 2`</span>), and to reduce autocorrelation in the estimated parameters, by defining <span class="in">`THIN = 5`</span> we asked *M*plus to save every 5th sample. By setting `BITERATIONS = 5000(2000)`, we made sure to have between 2000 to 5000 samples (after thinning) for each parameter from each chain. *M*plus considers the first half of each chain as burn-in samples and discards them, thus, in total, we got at least 2000 "independent" samples from both chains combined. Finally, with `FACTORS = ALL (500)` we asked *M*plus to draw 500 samples for each individuals when estimating level-1 parameters. We visually inspected the traceplots and autocorrelation plots of parameter estimates and of a sample of analyzed datasets and good convergence was observed. Furthermore, to make sure the number of iterations and thinning used in the analyses provide sufficiently accurate estimates, we re-analyzed two replications of each alternative DGM with Gaussian and $\chi^2$-distributed means with $N=100$ and $T=100$ with <span class="in">`BITERATIONS = 12500(5000)`</span> and <span class="in">`THIN = 20`</span>, which led to estimates of the parameters of interest (<span class="in">`unstd X.WITH.PHI`</span>, <span class="in">`unstd Variances.PHI`</span>, and <span class="in">`stdyx X.WITH.PHI`</span>) almost identical (up to the third decimal) to those estimated with <span class="in">`BITERATIONS = 5000(2000)`</span> and <span class="in">`THIN = 5`</span> (see below).</span>
<span id="cb43-408"><a href="#cb43-408"></a></span>
<span id="cb43-409"><a href="#cb43-409"></a>The generated input files looked like the following. Note that the <span class="in">`TITLE`</span> and <span class="in">`DATA`</span> strings in the <span class="in">`.inp`</span> files are unique to the dataset being analyzed and included the unique dataset seed <span class="in">`uSeed`</span> (passed to <span class="in">`make_datasets`</span> to generate datasets), the number of individuals in the dataset <span class="in">`N`</span>, the length of the time series <span class="in">`T`</span>, the model types used (<span class="in">`resid.fixed`</span> or <span class="in">`resid.random`</span>), and the replication number <span class="in">`Rep`</span> (see @sec-bookkeeping for further details).</span>
<span id="cb43-410"><a href="#cb43-410"></a></span>
<span id="cb43-411"><a href="#cb43-411"></a>::: panel-tabset</span>
<span id="cb43-412"><a href="#cb43-412"></a><span class="fu">### Fixed residual variance</span></span>
<span id="cb43-413"><a href="#cb43-413"></a></span>
<span id="cb43-414"><a href="#cb43-414"></a>By estimating the covariances between mean and autoregression (<span class="in">`x phi WITH x phi`</span> under the <span class="in">`BETWEEN%`</span> command), the following *M*plus script runs an AR(1) with random effect mean and autoregressive parameter but with fixed effect residual variance.</span>
<span id="cb43-415"><a href="#cb43-415"></a></span>
<span id="cb43-418"><a href="#cb43-418"></a><span class="in">```{inp}</span></span>
<span id="cb43-419"><a href="#cb43-419"></a><span class="in">#| label: Mplus-input_fixed-resid</span></span>
<span id="cb43-420"><a href="#cb43-420"></a><span class="in">#| file: scripts/Mplus-input_fixed-resid.inp</span></span>
<span id="cb43-421"><a href="#cb43-421"></a><span class="in">```</span></span>
<span id="cb43-422"><a href="#cb43-422"></a></span>
<span id="cb43-423"><a href="#cb43-423"></a><span class="fu">### Random residual variance</span></span>
<span id="cb43-424"><a href="#cb43-424"></a></span>
<span id="cb43-425"><a href="#cb43-425"></a>By estimating the logarithm of the residual variance at level 1 (by <span class="in">`logv | x`</span> under the <span class="in">`%WITHIN%`</span> command) and estimating the covariances between the level-2 mean, autoregression, and residual variance (<span class="in">`x phi logv WITH x phi logv`</span> under the <span class="in">`%BETWEEN%`</span> command), the following *M*plus script runs an AR(1) model with random effect mean, autoregressive parameter, and residual variance.</span>
<span id="cb43-426"><a href="#cb43-426"></a></span>
<span id="cb43-429"><a href="#cb43-429"></a><span class="in">```{inp}</span></span>
<span id="cb43-430"><a href="#cb43-430"></a><span class="in">#| label: Mplus-input_random-resid</span></span>
<span id="cb43-431"><a href="#cb43-431"></a><span class="in">#| file: scripts/Mplus-input_random-resid.inp</span></span>
<span id="cb43-432"><a href="#cb43-432"></a><span class="in">```</span></span>
<span id="cb43-433"><a href="#cb43-433"></a></span>
<span id="cb43-434"><a href="#cb43-434"></a><span class="fu">### Comparing different `ANALYSIS` parameters</span></span>
<span id="cb43-435"><a href="#cb43-435"></a></span>
<span id="cb43-436"><a href="#cb43-436"></a>The table below shows the estimated parameters of two replications of with <span class="in">`BITERATIONS = 5000(2000)`</span> and <span class="in">`THIN = 5`</span> (specified in the table with <span class="in">`2k x 5`</span>) and <span class="in">`BITERATIONS = 12500(5000)`</span> and <span class="in">`THIN = 20`</span> (specified in the table with <span class="in">`5k x 20`</span>). The relevant parameters (level-2 correlations <span class="in">`X.WITH.PHI  unstd`</span>, covariances <span class="in">`X.WITH.PHI stdyx`</span>, and variance <span class="in">`Variances.PHI unstd`</span>) are highlighted with orange.</span>
<span id="cb43-437"><a href="#cb43-437"></a></span>
<span id="cb43-438"><a href="#cb43-438"></a><span class="in">```{=html}</span></span>
<span id="cb43-439"><a href="#cb43-439"></a><span class="in">&lt;iframe width="700" height="500" src="./additional-files/hyperparameters.html" title="Quarto Documentation"&gt;&lt;/iframe&gt;</span></span>
<span id="cb43-440"><a href="#cb43-440"></a><span class="in">```</span></span>
<span id="cb43-441"><a href="#cb43-441"></a>:::</span>
<span id="cb43-442"><a href="#cb43-442"></a></span>
<span id="cb43-443"><a href="#cb43-443"></a><span class="fu">## The *Harvesting* component {#sec-harvesting-component}</span></span>
<span id="cb43-444"><a href="#cb43-444"></a></span>
<span id="cb43-445"><a href="#cb43-445"></a>Extracting parameter estimates of individual analyses</span>
<span id="cb43-446"><a href="#cb43-446"></a></span>
<span id="cb43-447"><a href="#cb43-447"></a>The function <span class="in">`fit_extract`</span> gets an <span class="in">`.rds`</span> file generated by <span class="in">`do_fit_doFuture`</span> (see @sec-pipeline-functions)---which includes book-keeping information and Mplus output object that was generated by <span class="in">`run_MplusAutomation`</span> (see @sec-analysis-component)---and extracts the <span class="in">`unstandardized`</span> and <span class="in">`stdyx.standardized`</span> *M*plus parameter estimates and stores them, along with the additional book-keeping information, in a dataframe.</span>
<span id="cb43-448"><a href="#cb43-448"></a></span>
<span id="cb43-449"><a href="#cb43-449"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-450"><a href="#cb43-450"></a><span class="sc">&lt;</span><span class="er">&lt;</span>fit_extract<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-451"><a href="#cb43-451"></a><span class="in">```</span></span>
<span id="cb43-452"><a href="#cb43-452"></a></span>
<span id="cb43-453"><a href="#cb43-453"></a><span class="fu">## The *Reporting* component {#sec-reporting-component}</span></span>
<span id="cb43-454"><a href="#cb43-454"></a></span>
<span id="cb43-455"><a href="#cb43-455"></a>This component includes a function that clean the harvested dataset (and extract the relevant information) and functions to generate dataset profile plots, results figures, and parameter estimates coverage plots.</span>
<span id="cb43-456"><a href="#cb43-456"></a></span>
<span id="cb43-457"><a href="#cb43-457"></a>Given that the figures contain customized typefaces (from the <span class="in">`CMU Serif`</span> and <span class="in">`Merriweather`</span> font families), we need to make load the fonts:</span>
<span id="cb43-458"><a href="#cb43-458"></a></span>
<span id="cb43-459"><a href="#cb43-459"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-460"><a href="#cb43-460"></a><span class="sc">&lt;</span><span class="er">&lt;</span>report_initialization<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-461"><a href="#cb43-461"></a><span class="in">```</span></span>
<span id="cb43-462"><a href="#cb43-462"></a></span>
<span id="cb43-463"><a href="#cb43-463"></a><span class="fu">### Cleaning the harvested dataset {#sec-report-clean-harvest}</span></span>
<span id="cb43-464"><a href="#cb43-464"></a></span>
<span id="cb43-465"><a href="#cb43-465"></a>Given that the output of <span class="in">`fit_extract`</span> has too much information in it, the function <span class="in">`harvest_cleanup`</span> extracts the relevant parameter estimates---the point estimates and the upper and lower 2.5 crediblity intervals of level-2 covariance (<span class="in">`unstd X.WITH.PHI)`</span>, level-2 correlation (<span class="in">`stdyx X.WITH.PHI`</span>), and fixed-effect autoregressive parameter at level 2 (<span class="in">`unstd Means.PHI`</span>)---cleans the datasets and makes it *tidy*, and calculates the outcomes of interest, namely, the (absolute) average estimates, mean absolute and squared error, root mean squared error, estimation bias and variance, number and percentage of of non-converged datasets, and the percentages of significantly positive or negative or non-significant parameter estimates.</span>
<span id="cb43-466"><a href="#cb43-466"></a></span>
<span id="cb43-467"><a href="#cb43-467"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-468"><a href="#cb43-468"></a><span class="sc">&lt;</span><span class="er">&lt;</span>harvest_cleanup<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-469"><a href="#cb43-469"></a><span class="in">```</span></span>
<span id="cb43-470"><a href="#cb43-470"></a></span>
<span id="cb43-471"><a href="#cb43-471"></a><span class="fu">### Making distribution plots of simulated datasets {#sec-make-distribution-plots}</span></span>
<span id="cb43-472"><a href="#cb43-472"></a></span>
<span id="cb43-473"><a href="#cb43-473"></a>These functions visualize datasets (simulated or empirical) by generating individual histograms and pairplots of summary statistics of datasets, and a function to generate (and combine) these two plots for any given dataset simulated by <span class="in">`do_sim_parallel`</span> in the pipeline (see @sec-pipeline-functions).</span>
<span id="cb43-474"><a href="#cb43-474"></a></span>
<span id="cb43-475"><a href="#cb43-475"></a>::: panel-tabset</span>
<span id="cb43-476"><a href="#cb43-476"></a><span class="fu">#### Individual histograms</span></span>
<span id="cb43-477"><a href="#cb43-477"></a></span>
<span id="cb43-478"><a href="#cb43-478"></a>The function <span class="in">`plot_histograms`</span> makes person histograms of the individuals in a dataset (stored as dataframes) and arranges them based on individual means.</span>
<span id="cb43-479"><a href="#cb43-479"></a></span>
<span id="cb43-480"><a href="#cb43-480"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-481"><a href="#cb43-481"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_histograms<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-482"><a href="#cb43-482"></a><span class="in">```</span></span>
<span id="cb43-483"><a href="#cb43-483"></a></span>
<span id="cb43-484"><a href="#cb43-484"></a><span class="fu">#### Pairplots of summary statistics</span></span>
<span id="cb43-485"><a href="#cb43-485"></a></span>
<span id="cb43-486"><a href="#cb43-486"></a>The function <span class="in">`plot_pairplots`</span> calculates the mean, variance, and skewness of each individual in a dataset (stored as dataframes) and generates pairplots of their joint distribution.</span>
<span id="cb43-487"><a href="#cb43-487"></a></span>
<span id="cb43-488"><a href="#cb43-488"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-489"><a href="#cb43-489"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_pairplots<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-490"><a href="#cb43-490"></a><span class="in">```</span></span>
<span id="cb43-491"><a href="#cb43-491"></a></span>
<span id="cb43-492"><a href="#cb43-492"></a><span class="fu">#### Profile plots of simulated datasets</span></span>
<span id="cb43-493"><a href="#cb43-493"></a></span>
<span id="cb43-494"><a href="#cb43-494"></a>The function <span class="in">`plot_dataset.profile`</span> gets a simulated object (generated by <span class="in">`do_sim_parallel`</span>) and combines individual histograms and pairplots in a single figure.</span>
<span id="cb43-495"><a href="#cb43-495"></a></span>
<span id="cb43-496"><a href="#cb43-496"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-497"><a href="#cb43-497"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_dataset.profile<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-498"><a href="#cb43-498"></a><span class="in">```</span></span>
<span id="cb43-499"><a href="#cb43-499"></a></span>
<span id="cb43-500"><a href="#cb43-500"></a>We also write the function <span class="in">`save_dataset_profile`</span> to put together two dataset profile plots to get to plots similar to those in Figures S1, S2, S4, and S5 in the Supplemental Materials, and save the final figure as a PDF file.</span>
<span id="cb43-501"><a href="#cb43-501"></a></span>
<span id="cb43-502"><a href="#cb43-502"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-503"><a href="#cb43-503"></a><span class="sc">&lt;</span><span class="er">&lt;</span>save_dataset_profile<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-504"><a href="#cb43-504"></a><span class="in">```</span></span>
<span id="cb43-505"><a href="#cb43-505"></a>:::</span>
<span id="cb43-506"><a href="#cb43-506"></a></span>
<span id="cb43-507"><a href="#cb43-507"></a><span class="fu">### Making plots of estimation results {#sec-report-estimation-plots}</span></span>
<span id="cb43-508"><a href="#cb43-508"></a></span>
<span id="cb43-509"><a href="#cb43-509"></a>The functions here make the main figures of the paper, which include aspects of model fit (e.g., estimation bias and RMSE, and Type-I error rates, etc.).</span>
<span id="cb43-510"><a href="#cb43-510"></a></span>
<span id="cb43-511"><a href="#cb43-511"></a>::: panel-tabset</span>
<span id="cb43-512"><a href="#cb43-512"></a><span class="fu">#### Plots for a given level-2 distribution</span></span>
<span id="cb43-513"><a href="#cb43-513"></a></span>
<span id="cb43-514"><a href="#cb43-514"></a>The function <span class="in">`plot_Model.x.Resid`</span> makes a figure with two columns (for the models with fixed or random residual variance), that show the outcomes of a fit measure (e.g., bias) for all the four DGMs with a given level-2 distribution of means for different $N$s and $T$s.</span>
<span id="cb43-515"><a href="#cb43-515"></a></span>
<span id="cb43-516"><a href="#cb43-516"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-517"><a href="#cb43-517"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_Model.x.Resid<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-518"><a href="#cb43-518"></a><span class="in">```</span></span>
<span id="cb43-519"><a href="#cb43-519"></a></span>
<span id="cb43-520"><a href="#cb43-520"></a><span class="fu">#### Combined plots of results</span></span>
<span id="cb43-521"><a href="#cb43-521"></a></span>
<span id="cb43-522"><a href="#cb43-522"></a>The function <span class="in">`plot_quadrants`</span> makes a larger figure that includes four *quadrants*, each generated with <span class="in">`plot_Model.x.Resid`</span>., that show the main results of the paper.</span>
<span id="cb43-523"><a href="#cb43-523"></a></span>
<span id="cb43-524"><a href="#cb43-524"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-525"><a href="#cb43-525"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_quadrants<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-526"><a href="#cb43-526"></a><span class="in">```</span></span>
<span id="cb43-527"><a href="#cb43-527"></a>:::</span>
<span id="cb43-528"><a href="#cb43-528"></a></span>
<span id="cb43-529"><a href="#cb43-529"></a><span class="fu">### Making plots of parameter estimates coverage {#sec-report-caterpillar-plots}</span></span>
<span id="cb43-530"><a href="#cb43-530"></a></span>
<span id="cb43-531"><a href="#cb43-531"></a>The function <span class="in">`plot_caterpillar`</span> , for a given condition and a given parameter, makes plots of 95% confidence intervals (as vertical bars) of all converged replications within that condition. The lines are ordered based on the point estimates and are colored based on whether they crossed zero (the correct estimate) or whether the whole 95% interval was bellow or above zero (significantly negative or positive estimates).</span>
<span id="cb43-532"><a href="#cb43-532"></a></span>
<span id="cb43-533"><a href="#cb43-533"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-534"><a href="#cb43-534"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_caterpillar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-535"><a href="#cb43-535"></a><span class="in">```</span></span>
<span id="cb43-536"><a href="#cb43-536"></a></span>
<span id="cb43-537"><a href="#cb43-537"></a><span class="fu">### Making plots for DGM time series</span></span>
<span id="cb43-538"><a href="#cb43-538"></a></span>
<span id="cb43-539"><a href="#cb43-539"></a>A function was also made to make profiles of individual time series, that include the time series itself, its marginal distribution, and its sample ACF.</span>
<span id="cb43-540"><a href="#cb43-540"></a></span>
<span id="cb43-541"><a href="#cb43-541"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-542"><a href="#cb43-542"></a><span class="sc">&lt;</span><span class="er">&lt;</span>plot_dgm.profile<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-543"><a href="#cb43-543"></a><span class="in">```</span></span>
<span id="cb43-544"><a href="#cb43-544"></a></span>
<span id="cb43-545"><a href="#cb43-545"></a><span class="fu"># Pipeline {#sec-pipeline}</span></span>
<span id="cb43-546"><a href="#cb43-546"></a></span>
<span id="cb43-547"><a href="#cb43-547"></a>We implemented each of these tasks in separate functions that were essentially wrapper functions (with parallel-computing implementation) around the modular components. Using these wrapper functions, each replication of each simulated condition was saved in a separate <span class="in">`.rds`</span> file. These data files were fed to the analysis wrapper function whose output was saved in separate <span class="in">`.rds`</span> data files. To collect relevant parameter estimates, another wrapper function was used to read the data files and save the desired parameters in a dataframe, which then used in reporting.</span>
<span id="cb43-548"><a href="#cb43-548"></a></span>
<span id="cb43-549"><a href="#cb43-549"></a><span class="fu">## Book-keeping {#sec-bookkeeping}</span></span>
<span id="cb43-550"><a href="#cb43-550"></a></span>
<span id="cb43-551"><a href="#cb43-551"></a>The outcomes of the components are saved in separate <span class="in">`.rds`</span> files and indexed by unique, descriptive names, and each replication is given a unique numeric identifier that is also used as the random seed used to generate the dataset within each replication. The file names and address are stored in two dataframes along with model parameters used to generate each dataset, and these dataframes are used when reading and writing data files in other components.</span>
<span id="cb43-552"><a href="#cb43-552"></a></span>
<span id="cb43-553"><a href="#cb43-553"></a>::: panel-tabset</span>
<span id="cb43-554"><a href="#cb43-554"></a><span class="fu">### Simulation file references {#sec-bookkeeping-simulation-files}</span></span>
<span id="cb43-555"><a href="#cb43-555"></a></span>
<span id="cb43-556"><a href="#cb43-556"></a>The function <span class="in">`make_sim_refs`</span> makes a table consisting of all possible combinations of each conditions (that are provided as a list <span class="in">`conditions`</span>), and replicates it <span class="in">`Reps`</span> times (number of replications, $R = 1000$). Then, to make sure that each simulated dataset is produced with a unique random seed, the function generates a unique <span class="in">`uSeed`</span> based on the number (and values) of conditions and the replication number. Furthermore, an initial simulation seed (<span class="in">`simSeed`</span>) is included in generation of <span class="in">`uSeed`</span> which makes it possible to have different *batches* of simulations (for instance, if one wants to run the simulation for another 1000 times).</span>
<span id="cb43-557"><a href="#cb43-557"></a></span>
<span id="cb43-558"><a href="#cb43-558"></a>For each condition, a unique seed is generated by weighting different conditions (that are indexed in a vector <span class="in">`d.integer`</span>) by prime numbers (that are not among the prime factors of the number of conditions) and summing them up (which is done with dot-producting <span class="in">`d.integer %*% primes.seq`</span>). Then, to make unique seeds per replications, the replication number is concatenated to the left side of <span class="in">`d.integer %*% primes.seq`</span>, and everything is put into a dataframe (called <span class="in">`d.headers`</span>, that is eventually returned by the function) with unique file names for individual <span class="in">`.rds`</span> files (that include <span class="in">`uSeed`</span> as well as the replication number and the value of condition used in data generation, e.g., <span class="in">`sim_uSeed-13293_l2.dist-Chi2_Model-BinAR_N-100_phi-0.4_T-100_sim.Seed-0_Rep-1`</span>) and the address of the folder in which the <span class="in">`.rds`</span> files were stored. Finally, if desired, the simulation reference table <span class="in">`d.headers`</span> is saved as <span class="in">`.csv`</span> and <span class="in">`.rds`</span>.</span>
<span id="cb43-559"><a href="#cb43-559"></a></span>
<span id="cb43-560"><a href="#cb43-560"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-561"><a href="#cb43-561"></a><span class="sc">&lt;</span><span class="er">&lt;</span>make_sim_refs<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-562"><a href="#cb43-562"></a><span class="in">```</span></span>
<span id="cb43-563"><a href="#cb43-563"></a></span>
<span id="cb43-564"><a href="#cb43-564"></a><span class="co">[</span><span class="ot">***Note that***</span><span class="co">]</span>{.underline} initially, we started by having two values for the length of the time series ($T = 30$ corresponding to one month of measurements, and $T = 100$ for a reasonably long time series) and one sample size ($N = 100$, and subsample the datasets for $N = 25$ and $N = 50$), and we decided to include five DGMs in the simulations: the AR(1), $\chi^2$AR(1), BinAR(1), PoDAR(1) models, and a DAR(1) model with binomial marginal distribution). Eventually (and midway through the simulations), we decided to omit the $T = 30$ condition and the DAR(1) model from our simulation. However, as omitting these would have led to change in the calculations of <span class="in">`uSeed`</span>, we decided to keep it the simulation reference table intact and omit <span class="in">`Model == "DAR"`</span> and <span class="in">`T == 30`</span> later on (see @sec-pipeline-code for details).</span>
<span id="cb43-565"><a href="#cb43-565"></a></span>
<span id="cb43-566"><a href="#cb43-566"></a><span class="co">[</span><span class="ot">***Further note that***</span><span class="co">]</span>{.underline} we only generated datasets with $N = 100$ and $T = 100$, and sub-sampled other sample sizes and time series lengths ($N = 25, 50$ and $T = 25, 50$) from them. Although this had computational benefits (less simulation time, and less storage required), the main motivation behind this decision was to be able to mimic empirical data collection: Sub-sampling the large datasets would be equated with collecting less data than the ideal case in which we have many participants with many measurements (so sub-sampling what *could have been* collected). Furthermore, comparing the datasets with the same DGM and level-2 distribution would be more meaningful: All datasets with same <span class="in">`Rep`</span> value within the same DGM (say, PoDAR(1) model) and with the same level-2 distribution (say, $\chi^2$ distribution) have the same <span class="in">`uSeed`</span>, thus they can be matched. Consequently, the differences we observe for different $N$s and $T$s within each cell of the figures reported in the paper can mimic the effect of "non-ideal" sampling.</span>
<span id="cb43-567"><a href="#cb43-567"></a></span>
<span id="cb43-568"><a href="#cb43-568"></a>Changing the conditions (omitting <span class="in">`Model == "DAR"`</span> and <span class="in">`T == 30`</span> from the simulation reference dataset, and adding additional conditions for <span class="in">`N`</span> and <span class="in">`T`</span>) is done when running the pipeline (see @sec-pipeline-code) and the sub-sampling is implemented when running the analysis in <span class="in">`do_fit_doFuture`</span> (see @sec-pipeline-functions).</span>
<span id="cb43-569"><a href="#cb43-569"></a></span>
<span id="cb43-570"><a href="#cb43-570"></a><span class="fu">### Analysis outputs file references {#sec-bookkeeping-analysis-files}</span></span>
<span id="cb43-571"><a href="#cb43-571"></a></span>
<span id="cb43-572"><a href="#cb43-572"></a>Another dataframe was generated to include the references of analyses results per simulation condition and analysis condition (or *hyperparameter*s), and file names and directory of individual <span class="in">`.rds`</span> analysis outputs. The hyperparameters included the analysis type (with fixed vs. random residual variance) and the number of iterations and thinning in the MCMC algorithm, which were then used as arguments of <span class="in">`run_MplusAutomation`</span>.</span>
<span id="cb43-573"><a href="#cb43-573"></a></span>
<span id="cb43-574"><a href="#cb43-574"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-575"><a href="#cb43-575"></a><span class="sc">&lt;</span><span class="er">&lt;</span>make_fit_refs<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-576"><a href="#cb43-576"></a><span class="in">```</span></span>
<span id="cb43-577"><a href="#cb43-577"></a>:::</span>
<span id="cb43-578"><a href="#cb43-578"></a></span>
<span id="cb43-579"><a href="#cb43-579"></a><span class="fu">## Pipeline functions {#sec-pipeline-functions}</span></span>
<span id="cb43-580"><a href="#cb43-580"></a></span>
<span id="cb43-581"><a href="#cb43-581"></a>We implemented the components described in @sec-components using the following functions.</span>
<span id="cb43-582"><a href="#cb43-582"></a></span>
<span id="cb43-583"><a href="#cb43-583"></a>::: panel-tabset</span>
<span id="cb43-584"><a href="#cb43-584"></a><span class="fu">### Simulation in parallel</span></span>
<span id="cb43-585"><a href="#cb43-585"></a></span>
<span id="cb43-586"><a href="#cb43-586"></a>The function <span class="in">`do_sim_parallel`</span> is a wrapper around <span class="in">`make_datasets`</span> (see @sec-dataset-generation) and uses the <span class="in">`clusterApplyLB`</span> function from the package <span class="in">`snow`</span> <span class="co">[</span><span class="ot">@tierney_2021_SnowSimpleNetwork</span><span class="co">]</span> for parallelization. This wrapper gets the dataframe of simulation file references (<span class="in">`sim_refs`</span>, which is the output of <span class="in">`make_sim_refs`</span>), and for each of its rows, simulates an $N \times T$ dataframe and stores it with other information in the same row---and also additional info about the time the simulating the dataset started and ended---in a list, and saves each list as a separate <span class="in">`.rds`</span> file in the target folder (specified with <span class="in">`sim.Path`</span>). Having the additional data in the saved files allow using them independent from the table of references. Note that to prevent the overload of the hard drive with many parallel write requests (to save the simulated datasets), for the first <span class="in">`nClust`</span> rounds, using the <span class="in">`Sys.sleep`</span> function, the data generation is started after a varying amount of delay. Given that every dataset simulation in the first round may take different amount of times, after the first round is complete, the simulations on different cores fall out of sync and there is no more need for adding delays for the next rounds.</span>
<span id="cb43-587"><a href="#cb43-587"></a></span>
<span id="cb43-588"><a href="#cb43-588"></a>::: callout-note</span>
<span id="cb43-589"><a href="#cb43-589"></a><span class="fu">## Addendum: Version 2</span></span>
<span id="cb43-590"><a href="#cb43-590"></a></span>
<span id="cb43-591"><a href="#cb43-591"></a>In <span class="in">`v2`</span>, <span class="in">`make_dataset`</span> returns a list. Note that <span class="in">`do_sim_parallel`</span> also saves the vectors of means and $\phi$s in the saved simulation file as <span class="in">`$given.Means`</span> and <span class="in">`$given.Phis`</span>.</span>
<span id="cb43-592"><a href="#cb43-592"></a>:::</span>
<span id="cb43-593"><a href="#cb43-593"></a></span>
<span id="cb43-594"><a href="#cb43-594"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-595"><a href="#cb43-595"></a><span class="sc">&lt;</span><span class="er">&lt;</span>do_sim_parallel<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-596"><a href="#cb43-596"></a><span class="in">```</span></span>
<span id="cb43-597"><a href="#cb43-597"></a></span>
<span id="cb43-598"><a href="#cb43-598"></a><span class="fu">### Analysis in parallel</span></span>
<span id="cb43-599"><a href="#cb43-599"></a></span>
<span id="cb43-600"><a href="#cb43-600"></a>The function <span class="in">`do_fit_doFuture`</span> is a wrapper around <span class="in">`run_MplusAutomation`</span> (see @sec-analysis-component) and uses the package <span class="in">`doFuture`</span> <span class="co">[</span><span class="ot">@bengtsson_2021_UnifyingFrameworkParallel</span><span class="co">]</span> as a parallelization backend to <span class="in">`plyr::a_ply`</span>. The function gets a dataframe containing references of analyses results (<span class="in">`fit_refs`</span>, which is the output of <span class="in">`make_fit_refs`</span>), and row by row reads the simulated datasets, sub-samples the data if $N &lt; 100$ or $T &lt; 100$ (see the second note under <span class="in">`make_sim_refs`</span> in @sec-bookkeeping) and runs the analysis based on the hyperparameters specified in <span class="in">`fit_refs`</span>. It then saves the outcome of the analysis (the *M*plus model object produced by `MplusAutomation::mplusModeler` and returned by `run_MplusAutomation`), which includes *M*plus outputs and parameter estimates) with additional information (other values in the same row of `fit_refs` as well as timings) in separate `.rds` files in the target folder. Note that, again, to prevent the overload of the hard drive with many parallel read and write requests (to read the simulated datasets and save the *M*plus outputs), for the first <span class="in">`nClust`</span> rounds, using the <span class="in">`Sys.sleep`</span> function, the data analysis is started after a varying amount of delay. Given that every analysis instance in the first round take different amount of times, after the first round is complete the analyses on cores fall out of sync and there is no more need for adding delays for the next rounds.</span>
<span id="cb43-601"><a href="#cb43-601"></a></span>
<span id="cb43-602"><a href="#cb43-602"></a>::: callout-note</span>
<span id="cb43-603"><a href="#cb43-603"></a><span class="fu">## Addendum: Version 2</span></span>
<span id="cb43-604"><a href="#cb43-604"></a></span>
<span id="cb43-605"><a href="#cb43-605"></a>In <span class="in">`v2`</span>, the <span class="in">`given.Means`</span> and <span class="in">`given.Phis`</span> of the $N$ subjects included in the analysis, as well as the sample summary statistics of the sub-sampled dataset (<span class="in">`sample.Means`</span>, <span class="in">`sample.Variances`</span>, and <span class="in">`sample.Skewnesses`</span>) are also saved in the fit object.</span>
<span id="cb43-606"><a href="#cb43-606"></a>:::</span>
<span id="cb43-607"><a href="#cb43-607"></a></span>
<span id="cb43-608"><a href="#cb43-608"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-609"><a href="#cb43-609"></a><span class="sc">&lt;</span><span class="er">&lt;</span>do_fit_doFuture<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-610"><a href="#cb43-610"></a><span class="in">```</span></span>
<span id="cb43-611"><a href="#cb43-611"></a></span>
<span id="cb43-612"><a href="#cb43-612"></a><span class="fu">### Harvesting in parallel</span></span>
<span id="cb43-613"><a href="#cb43-613"></a></span>
<span id="cb43-614"><a href="#cb43-614"></a>The function <span class="in">`do_harvest_doFuture`</span> is a wrapper around <span class="in">`fit_extract`</span> (see @sec-harvesting-component) and uses the package <span class="in">`doFuture`</span> as a parallelization backend to <span class="in">`foreach`</span>. It gets a list of <span class="in">`.rds`</span> files (that can be taken from or <span class="in">`fit_refs`</span>, or by using <span class="in">`list.files`</span> function in the directory in which the analysis results are saved) and returns a large dataframe including parameter estimates (and additional information) extracted by <span class="in">`fit_extract`</span>. Again, like in <span class="in">`do_sim_parallel`</span> and <span class="in">`do_fit_doFuture`</span>, the first <span class="in">`nClust`</span> files are read with varying amount of delay to prevent the overload of the hard drive by multiple read requests.</span>
<span id="cb43-615"><a href="#cb43-615"></a></span>
<span id="cb43-616"><a href="#cb43-616"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-617"><a href="#cb43-617"></a><span class="sc">&lt;</span><span class="er">&lt;</span>do_harvest_doFuture<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-618"><a href="#cb43-618"></a><span class="in">```</span></span>
<span id="cb43-619"><a href="#cb43-619"></a>:::</span>
<span id="cb43-620"><a href="#cb43-620"></a></span>
<span id="cb43-621"><a href="#cb43-621"></a><span class="fu">## Pipeline code {#sec-pipeline-code}</span></span>
<span id="cb43-622"><a href="#cb43-622"></a></span>
<span id="cb43-623"><a href="#cb43-623"></a>The following is the code we used to run the whole pipeline, which consists of three chunk that are responsible of the following:</span>
<span id="cb43-624"><a href="#cb43-624"></a></span>
<span id="cb43-625"><a href="#cb43-625"></a><span class="ss">1.  </span>Creating the book-keeping reference files (using functions described in @sec-bookkeeping).</span>
<span id="cb43-626"><a href="#cb43-626"></a><span class="ss">2.  </span>Running the whole simulation study (using <span class="in">`do_sim_parallel`</span> and <span class="in">`do_fit_doFuture`</span> described in @sec-pipeline-functions). The codes in this chunk can be interrupted (deliberately or otherwise) and resumed by running it again.</span>
<span id="cb43-627"><a href="#cb43-627"></a><span class="ss">3.  </span>Harvesting the parameter estimates and storing them in a single dataframe (using <span class="in">`do_harvest_doFuture`</span> of @sec-pipeline-functions). The resulting dataframe is then used to make the plots using in @sec-simulation-results)</span>
<span id="cb43-628"><a href="#cb43-628"></a></span>
<span id="cb43-629"><a href="#cb43-629"></a>But first we need to set the directories in which the results of each chunk is saved:</span>
<span id="cb43-630"><a href="#cb43-630"></a></span>
<span id="cb43-631"><a href="#cb43-631"></a><span class="in">```{r, eval = study_Initialize}</span></span>
<span id="cb43-632"><a href="#cb43-632"></a><span class="co">#| code-fold: false</span></span>
<span id="cb43-633"><a href="#cb43-633"></a><span class="co">#| echo: true</span></span>
<span id="cb43-634"><a href="#cb43-634"></a><span class="sc">&lt;</span><span class="er">&lt;</span>pipeline_set_directories<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-635"><a href="#cb43-635"></a><span class="in">```</span></span>
<span id="cb43-636"><a href="#cb43-636"></a></span>
<span id="cb43-637"><a href="#cb43-637"></a>::: panel-tabset</span>
<span id="cb43-638"><a href="#cb43-638"></a><span class="fu">### Making references</span></span>
<span id="cb43-639"><a href="#cb43-639"></a></span>
<span id="cb43-640"><a href="#cb43-640"></a>The following code makes <span class="in">`sim_refs`</span> and <span class="in">`fit_refs`</span> tables and make backups of them. In line 17 the rows with <span class="in">`T != 100`</span> and <span class="in">`Model == "DAR"`</span> are omitted, and with the codes in lines 22-31 we add other values of $N$s and $T$s (see the notes under <span class="in">`make_sim_refs`</span> in @sec-bookkeeping).</span>
<span id="cb43-641"><a href="#cb43-641"></a></span>
<span id="cb43-642"><a href="#cb43-642"></a><span class="in">```{r, eval = study_RunPipeline}</span></span>
<span id="cb43-643"><a href="#cb43-643"></a><span class="sc">&lt;</span><span class="er">&lt;</span>pipeline_make_references<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-644"><a href="#cb43-644"></a><span class="in">```</span></span>
<span id="cb43-645"><a href="#cb43-645"></a></span>
<span id="cb43-646"><a href="#cb43-646"></a><span class="fu">### Running the study</span></span>
<span id="cb43-647"><a href="#cb43-647"></a></span>
<span id="cb43-648"><a href="#cb43-648"></a>Here we reads the reference tables <span class="in">`sim_refs`</span> and <span class="in">`fit_refs`</span>. We then make a list of already simulated files (that are located in the <span class="in">`sim.Path`</span> directory) and a list of analysis output files (that are located in the <span class="in">`fit.Path`</span> directory). Then, by comparing <span class="in">`sim_refs`</span> and <span class="in">`fit_refs`</span> with the the lists of simulated and analyzed files, we only simulate/analyze the datasets that have not been yet simulated/analyzed. This allows us resume the simulation study after an interruption to the R session.</span>
<span id="cb43-649"><a href="#cb43-649"></a></span>
<span id="cb43-650"><a href="#cb43-650"></a><span class="in">```{r, eval = study_RunPipeline}</span></span>
<span id="cb43-651"><a href="#cb43-651"></a><span class="sc">&lt;</span><span class="er">&lt;</span>pipeline_run_study<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-652"><a href="#cb43-652"></a><span class="in">```</span></span>
<span id="cb43-653"><a href="#cb43-653"></a></span>
<span id="cb43-654"><a href="#cb43-654"></a><span class="fu">### Harvesting and cleaning the results</span></span>
<span id="cb43-655"><a href="#cb43-655"></a></span>
<span id="cb43-656"><a href="#cb43-656"></a>Finally, the analyzed datasets are read using <span class="in">`do_harvest_doFuture`</span> in parallel and stored in an <span class="in">`.rds`</span> file suffixed with date and time (to prevent over-writing the previously saved harvest files). Furthermore, using the function <span class="in">`harvest_cleanup`</span> (of @sec-report-clean-harvest), an abridged version (<span class="in">`d_abridged`</span>, including all results of all replications for the parameters of interest) and a more summarized version (<span class="in">`d_important`</span>, containing the outcome measures of interest per condition) of the raw harvest dataframe are made and saved in two <span class="in">`.rds`</span> files (again suffixed with date and time).</span>
<span id="cb43-657"><a href="#cb43-657"></a></span>
<span id="cb43-658"><a href="#cb43-658"></a><span class="in">```{r, eval = study_RunPipeline}</span></span>
<span id="cb43-659"><a href="#cb43-659"></a><span class="sc">&lt;</span><span class="er">&lt;</span>pipeline_harvest_results<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-660"><a href="#cb43-660"></a><span class="in">```</span></span>
<span id="cb43-661"><a href="#cb43-661"></a>:::</span>
<span id="cb43-662"><a href="#cb43-662"></a></span>
<span id="cb43-663"><a href="#cb43-663"></a><span class="fu"># Simulation results {#sec-simulation-results}</span></span>
<span id="cb43-664"><a href="#cb43-664"></a></span>
<span id="cb43-665"><a href="#cb43-665"></a>We read the abridged harvested data file (<span class="in">`harvest-important_***.rds`</span>) and make the outcome plots using <span class="in">`plot_Model.x.Resid`</span> and <span class="in">`plot_quadrants`</span> functions (of @sec-report-estimation-plots ) and the MCMC estimates coverage plots using the function <span class="in">`plot_caterpillar`</span> (of @sec-report-caterpillar-plots). To ensure small file size and good resolutions, all plots are saved in separate PDF files (which can easily be included in a <span class="in">`r ifelse(knitr::is_html_output(), r"($\mathrm{\LaTeX{}}$)", r"(\LaTeX{})")`</span> script) in a specific directory. Before going any further, we should read the abridged harvest dataframe and set the plot output folder.</span>
<span id="cb43-666"><a href="#cb43-666"></a></span>
<span id="cb43-667"><a href="#cb43-667"></a><span class="in">```{r, eval = study_MakeMainPlots}</span></span>
<span id="cb43-668"><a href="#cb43-668"></a><span class="co">#| echo: true</span></span>
<span id="cb43-669"><a href="#cb43-669"></a><span class="co">#| code-fold: false</span></span>
<span id="cb43-670"><a href="#cb43-670"></a><span class="sc">&lt;</span><span class="er">&lt;</span>results_read_harvest<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-671"><a href="#cb43-671"></a><span class="in">```</span></span>
<span id="cb43-672"><a href="#cb43-672"></a></span>
<span id="cb43-673"><a href="#cb43-673"></a><span class="fu">## Plots main results</span></span>
<span id="cb43-674"><a href="#cb43-674"></a></span>
<span id="cb43-675"><a href="#cb43-675"></a>::: panel-tabset</span>
<span id="cb43-676"><a href="#cb43-676"></a><span class="fu">### Plots of a single outcome measure</span></span>
<span id="cb43-677"><a href="#cb43-677"></a></span>
<span id="cb43-678"><a href="#cb43-678"></a>The left and right panels (including results for Gaussian and $\chi^2$ distributed means) are made for each outcome measure of interest using <span class="in">`plot_Model.x.Resid`</span>, combined using the package <span class="in">`patchwork`</span>, and saved as PDF files.</span>
<span id="cb43-679"><a href="#cb43-679"></a></span>
<span id="cb43-680"><a href="#cb43-680"></a><span class="in">```{r, eval = study_MakeMainPlots}</span></span>
<span id="cb43-681"><a href="#cb43-681"></a><span class="sc">&lt;</span><span class="er">&lt;</span>results_plots_measures_single<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-682"><a href="#cb43-682"></a><span class="in">```</span></span>
<span id="cb43-683"><a href="#cb43-683"></a></span>
<span id="cb43-684"><a href="#cb43-684"></a>::: {.content-visible when-format="html"}</span>
<span id="cb43-685"><a href="#cb43-685"></a>The generated plots are located in <span class="in">`figures`</span> folder and can be accessed via the following tables:</span>
<span id="cb43-686"><a href="#cb43-686"></a></span>
<span id="cb43-687"><a href="#cb43-687"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-688"><a href="#cb43-688"></a>| Outcome measures           | Correlations                                                          | Covariances                                                          |</span>
<span id="cb43-689"><a href="#cb43-689"></a>+============================+=======================================================================+======================================================================+</span>
<span id="cb43-690"><a href="#cb43-690"></a>| Bias                       | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Bias).pdf)             | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Bias).pdf)             |</span>
<span id="cb43-691"><a href="#cb43-691"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-692"><a href="#cb43-692"></a>| Variance                   | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Variance).pdf)         | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Variance).pdf)         |</span>
<span id="cb43-693"><a href="#cb43-693"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-694"><a href="#cb43-694"></a>| RMSE                       | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(RMSE).pdf)             | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(RMSE).pdf)             |</span>
<span id="cb43-695"><a href="#cb43-695"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-696"><a href="#cb43-696"></a>| MAE                        | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(MAE).pdf)              | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(MAE).pdf)              |</span>
<span id="cb43-697"><a href="#cb43-697"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-698"><a href="#cb43-698"></a>| Positive Type-I error rate | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Positive%20error).pdf) | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Positive%20error).pdf) |</span>
<span id="cb43-699"><a href="#cb43-699"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-700"><a href="#cb43-700"></a>| Negative Type-I error rate | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Negative%20error).pdf) | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Negative%20error).pdf) |</span>
<span id="cb43-701"><a href="#cb43-701"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-702"><a href="#cb43-702"></a>| Total Type-I error rate    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Total%20error).pdf)    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Total%20error).pdf)    |</span>
<span id="cb43-703"><a href="#cb43-703"></a>+----------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------------+</span>
<span id="cb43-704"><a href="#cb43-704"></a></span>
<span id="cb43-705"><a href="#cb43-705"></a>: Individual plots of outcome measures</span>
<span id="cb43-706"><a href="#cb43-706"></a>:::</span>
<span id="cb43-707"><a href="#cb43-707"></a></span>
<span id="cb43-708"><a href="#cb43-708"></a><span class="fu">### Plots of two outcome measures combined</span></span>
<span id="cb43-709"><a href="#cb43-709"></a></span>
<span id="cb43-710"><a href="#cb43-710"></a>The plots containing pairs of outcome measures (respectively including results for Gaussian and $\chi^2$ distributed means) are made for each outcome measure of interest, combined using the package <span class="in">`patchwork`</span>, and saved as PDF files.</span>
<span id="cb43-711"><a href="#cb43-711"></a></span>
<span id="cb43-712"><a href="#cb43-712"></a><span class="in">```{r, eval = study_MakeMainPlots}</span></span>
<span id="cb43-713"><a href="#cb43-713"></a><span class="sc">&lt;</span><span class="er">&lt;</span>results_plots_measures_pairs<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-714"><a href="#cb43-714"></a><span class="in">```</span></span>
<span id="cb43-715"><a href="#cb43-715"></a></span>
<span id="cb43-716"><a href="#cb43-716"></a>The generated plots are located in <span class="in">`figures`</span> folder and can be accessed via the following tables:</span>
<span id="cb43-717"><a href="#cb43-717"></a></span>
<span id="cb43-718"><a href="#cb43-718"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-719"><a href="#cb43-719"></a>| Outcome measures                   | Correlations                                                                                   | Covariances                                                                                   |</span>
<span id="cb43-720"><a href="#cb43-720"></a>+====================================+================================================================================================+===============================================================================================+</span>
<span id="cb43-721"><a href="#cb43-721"></a>| Bias and Variance                  | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Bias%20and%20Variance).pdf)                     | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Bias%20and%20Variance).pdf)                     |</span>
<span id="cb43-722"><a href="#cb43-722"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-723"><a href="#cb43-723"></a>| Bias and RMSE                      | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Bias%20and%20RMSE).pdf)                         | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Bias%20and%20RMSE).pdf)                         |</span>
<span id="cb43-724"><a href="#cb43-724"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-725"><a href="#cb43-725"></a>| Bias and MAE                       | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Bias%20and%20MAE).pdf)                          | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Bias%20and%20MAE).pdf)                          |</span>
<span id="cb43-726"><a href="#cb43-726"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-727"><a href="#cb43-727"></a>| Positive and negative Type-I error | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Positive%20error%20and%20Negative%20error).pdf) | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Positive%20error%20and%20Negative%20error).pdf) |</span>
<span id="cb43-728"><a href="#cb43-728"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-729"><a href="#cb43-729"></a>| Positive and total Type-I error    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Positive%20error%20and%20Total%20error).pdf)    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Positive%20error%20and%20Total%20error).pdf)    |</span>
<span id="cb43-730"><a href="#cb43-730"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-731"><a href="#cb43-731"></a>| Negative and total Type-I error    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Correlation%20(Negative%20error%20and%20Total%20error).pdf)    | <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">]</span>(./figures/Covariance%20(Negative%20error%20and%20Total%20error).pdf)    |</span>
<span id="cb43-732"><a href="#cb43-732"></a>+------------------------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+</span>
<span id="cb43-733"><a href="#cb43-733"></a></span>
<span id="cb43-734"><a href="#cb43-734"></a>: Combined plots of two outcome measures</span>
<span id="cb43-735"><a href="#cb43-735"></a>:::</span>
<span id="cb43-736"><a href="#cb43-736"></a></span>
<span id="cb43-737"><a href="#cb43-737"></a><span class="fu">## Plots of MCMC parameter estimates coverage</span></span>
<span id="cb43-738"><a href="#cb43-738"></a></span>
<span id="cb43-739"><a href="#cb43-739"></a>It should be noted that <span class="in">`plot_caterpillar`</span> requires the abridged dataset of harvested results (<span class="in">`d_abridged`</span>) that contain estimates of all replications within each condition.</span>
<span id="cb43-740"><a href="#cb43-740"></a></span>
<span id="cb43-741"><a href="#cb43-741"></a><span class="in">```{r, eval = study_MakeMainPlots}</span></span>
<span id="cb43-742"><a href="#cb43-742"></a><span class="sc">&lt;</span><span class="er">&lt;</span>results_plots_caterpillar<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-743"><a href="#cb43-743"></a><span class="in">```</span></span>
<span id="cb43-744"><a href="#cb43-744"></a></span>
<span id="cb43-745"><a href="#cb43-745"></a>::: {.content-visible when-format="html"}</span>
<span id="cb43-746"><a href="#cb43-746"></a>The generated plots are located in <span class="in">`figures`</span> folder and can be accessed via the following tables:</span>
<span id="cb43-747"><a href="#cb43-747"></a></span>
<span id="cb43-748"><a href="#cb43-748"></a>+-------------------+-----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-749"><a href="#cb43-749"></a>| Model             | Gaussian-distributed means                                                                                | $\chi^2$-distributed means                                                                            |</span>
<span id="cb43-750"><a href="#cb43-750"></a>+===================+===========================================================================================================+=======================================================================================================+</span>
<span id="cb43-751"><a href="#cb43-751"></a>| **AR(1)**         | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Gaussian-resid.fixed.pdf)</span>      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Chi2-resid.fixed.pdf)</span>      |</span>
<span id="cb43-752"><a href="#cb43-752"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-753"><a href="#cb43-753"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Gaussian-resid.random.pdf)</span>    | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Chi2-resid.random.pdf)</span>    |</span>
<span id="cb43-754"><a href="#cb43-754"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-755"><a href="#cb43-755"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Gaussian-both.pdf)</span>                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-NAR-Chi2-both.pdf)</span>                   |</span>
<span id="cb43-756"><a href="#cb43-756"></a>+-------------------+-----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-757"><a href="#cb43-757"></a>| $\chi^2$**AR(1)** | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Gaussian-resid.fixed.pdf)</span>   | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Chi2-resid.fixed.pdf)</span>   |</span>
<span id="cb43-758"><a href="#cb43-758"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-759"><a href="#cb43-759"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Gaussian-resid.random.pdf)</span> | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Chi2-resid.random.pdf)</span> |</span>
<span id="cb43-760"><a href="#cb43-760"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-761"><a href="#cb43-761"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Gaussian-both.pdf)</span>                | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-Chi2AR-Chi2-both.pdf)</span>                |</span>
<span id="cb43-762"><a href="#cb43-762"></a>+-------------------+-----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-763"><a href="#cb43-763"></a>| **BinAR(1)**      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Gaussian-resid.fixed.pdf)</span>    | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Chi2-resid.fixed.pdf)</span>    |</span>
<span id="cb43-764"><a href="#cb43-764"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-765"><a href="#cb43-765"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Gaussian-resid.random.pdf)</span>  | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Chi2-resid.random.pdf)</span>  |</span>
<span id="cb43-766"><a href="#cb43-766"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-767"><a href="#cb43-767"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Gaussian-both.pdf)</span>                 | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-BinAR-Chi2-both.pdf)</span>                 |</span>
<span id="cb43-768"><a href="#cb43-768"></a>+-------------------+-----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-769"><a href="#cb43-769"></a>| **PoDAR(1)**      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Gaussian-resid.fixed.pdf)</span>    | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Chi2-resid.fixed.pdf)</span>    |</span>
<span id="cb43-770"><a href="#cb43-770"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-771"><a href="#cb43-771"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Gaussian-resid.random.pdf)</span>  | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Chi2-resid.random.pdf)</span>  |</span>
<span id="cb43-772"><a href="#cb43-772"></a>|                   |                                                                                                           |                                                                                                       |</span>
<span id="cb43-773"><a href="#cb43-773"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Gaussian-both.pdf)</span>                 | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Correlation-PoDAR-Chi2-both.pdf)</span>                 |</span>
<span id="cb43-774"><a href="#cb43-774"></a>+-------------------+-----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-775"><a href="#cb43-775"></a></span>
<span id="cb43-776"><a href="#cb43-776"></a>: MCMC parameter estimates coverage plots for **correlations**</span>
<span id="cb43-777"><a href="#cb43-777"></a></span>
<span id="cb43-778"><a href="#cb43-778"></a>+-------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-779"><a href="#cb43-779"></a>| Model             | Gaussian-distributed means                                                                               | $\chi^2$-distributed means                                                                           |</span>
<span id="cb43-780"><a href="#cb43-780"></a>+===================+==========================================================================================================+======================================================================================================+</span>
<span id="cb43-781"><a href="#cb43-781"></a>| **AR(1)**         | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Gaussian-resid.fixed.pdf)</span>      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Chi2-resid.fixed.pdf)</span>      |</span>
<span id="cb43-782"><a href="#cb43-782"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-783"><a href="#cb43-783"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Gaussian-resid.random.pdf)</span>    | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Chi2-resid.random.pdf)</span>    |</span>
<span id="cb43-784"><a href="#cb43-784"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-785"><a href="#cb43-785"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Gaussian-both.pdf)</span>                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-NAR-Chi2-both.pdf)</span>                   |</span>
<span id="cb43-786"><a href="#cb43-786"></a>+-------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-787"><a href="#cb43-787"></a>| $\chi^2$**AR(1)** | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Gaussian-resid.fixed.pdf)</span>   | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Chi2-resid.fixed.pdf)</span>   |</span>
<span id="cb43-788"><a href="#cb43-788"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-789"><a href="#cb43-789"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Gaussian-resid.random.pdf)</span> | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Chi2-resid.random.pdf)</span> |</span>
<span id="cb43-790"><a href="#cb43-790"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-791"><a href="#cb43-791"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Gaussian-both.pdf)</span>                | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-Chi2AR-Chi2-both.pdf)</span>                |</span>
<span id="cb43-792"><a href="#cb43-792"></a>+-------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-793"><a href="#cb43-793"></a>| **BinAR(1)**      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Gaussian-resid.fixed.pdf)</span>    | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Chi2-resid.fixed.pdf)</span>    |</span>
<span id="cb43-794"><a href="#cb43-794"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-795"><a href="#cb43-795"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Gaussian-resid.random.pdf)</span>  | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Chi2-resid.random.pdf)</span>  |</span>
<span id="cb43-796"><a href="#cb43-796"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-797"><a href="#cb43-797"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Gaussian-both.pdf)</span>                 | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-BinAR-Chi2-both.pdf)</span>                 |</span>
<span id="cb43-798"><a href="#cb43-798"></a>+-------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-799"><a href="#cb43-799"></a>| **PoDAR(1)**      | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Gaussian-resid.fixed.pdf)</span>    | Fixed res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Chi2-resid.fixed.pdf)</span>    |</span>
<span id="cb43-800"><a href="#cb43-800"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-801"><a href="#cb43-801"></a>|                   | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Gaussian-resid.random.pdf)</span>  | Random res. var <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Chi2-resid.random.pdf)</span>  |</span>
<span id="cb43-802"><a href="#cb43-802"></a>|                   |                                                                                                          |                                                                                                      |</span>
<span id="cb43-803"><a href="#cb43-803"></a>|                   | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Gaussian-both.pdf)</span>                 | Combined <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/caterpillar-Covariance-PoDAR-Chi2-both.pdf)</span>                 |</span>
<span id="cb43-804"><a href="#cb43-804"></a>+-------------------+----------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+</span>
<span id="cb43-805"><a href="#cb43-805"></a></span>
<span id="cb43-806"><a href="#cb43-806"></a>: MCMC parameter estimates coverage plots for **covariances**</span>
<span id="cb43-807"><a href="#cb43-807"></a>:::</span>
<span id="cb43-808"><a href="#cb43-808"></a></span>
<span id="cb43-809"><a href="#cb43-809"></a><span class="fu"># Additional figures and analyses {#sec-additional-analyses-and-figures}</span></span>
<span id="cb43-810"><a href="#cb43-810"></a></span>
<span id="cb43-811"><a href="#cb43-811"></a><span class="fu">## DGM time series plots {#sec-additional-DGM-time-series-plots}</span></span>
<span id="cb43-812"><a href="#cb43-812"></a></span>
<span id="cb43-813"><a href="#cb43-813"></a>We make plots including time series plots, marginal distributions, and sample ACFs for three time series generated by each DGMs.</span>
<span id="cb43-814"><a href="#cb43-814"></a></span>
<span id="cb43-815"><a href="#cb43-815"></a>::: panel-tabset</span>
<span id="cb43-816"><a href="#cb43-816"></a><span class="fu">### Combining DGM outputs in one dataframe</span></span>
<span id="cb43-817"><a href="#cb43-817"></a></span>
<span id="cb43-818"><a href="#cb43-818"></a><span class="in">```{r, eval = study_MakeAdditionalPlots}</span></span>
<span id="cb43-819"><a href="#cb43-819"></a><span class="sc">&lt;</span><span class="er">&lt;</span>make_dgm_df<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-820"><a href="#cb43-820"></a><span class="in">```</span></span>
<span id="cb43-821"><a href="#cb43-821"></a></span>
<span id="cb43-822"><a href="#cb43-822"></a><span class="fu">### Making the plots</span></span>
<span id="cb43-823"><a href="#cb43-823"></a></span>
<span id="cb43-824"><a href="#cb43-824"></a><span class="in">```{r, eval = study_MakeAdditionalPlots}</span></span>
<span id="cb43-825"><a href="#cb43-825"></a><span class="sc">&lt;</span><span class="er">&lt;</span>additional_plots_dgms<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-826"><a href="#cb43-826"></a><span class="in">```</span></span>
<span id="cb43-827"><a href="#cb43-827"></a></span>
<span id="cb43-828"><a href="#cb43-828"></a><span class="fu">### Saving the plots</span></span>
<span id="cb43-829"><a href="#cb43-829"></a></span>
<span id="cb43-830"><a href="#cb43-830"></a><span class="in">```{r, eval = study_MakeAdditionalPlots}</span></span>
<span id="cb43-831"><a href="#cb43-831"></a><span class="sc">&lt;</span><span class="er">&lt;</span>additional_plots_dgms_save<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-832"><a href="#cb43-832"></a><span class="in">```</span></span>
<span id="cb43-833"><a href="#cb43-833"></a>:::</span>
<span id="cb43-834"><a href="#cb43-834"></a></span>
<span id="cb43-835"><a href="#cb43-835"></a>::: {.content-visible when-format="html"}</span>
<span id="cb43-836"><a href="#cb43-836"></a>The generated time series plots of the AR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20NAR.pdf)</span>, $\chi^2$AR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20Chi2AR.pdf)</span>, BinAR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20BinAR.pdf)</span>, and PoDAR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20PoDAR.pdf)</span> models are saved in the <span class="in">`figures`</span> folder (see also combined plots, <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20alternative%20DGMs.pdf)</span> and <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/Profile%20four%20DGMs.pdf)</span>).</span>
<span id="cb43-837"><a href="#cb43-837"></a>:::</span>
<span id="cb43-838"><a href="#cb43-838"></a></span>
<span id="cb43-839"><a href="#cb43-839"></a><span class="fu">## Profiles of the simulated datasets {#sec-profiles-of-simulated-datasets}</span></span>
<span id="cb43-840"><a href="#cb43-840"></a></span>
<span id="cb43-841"><a href="#cb43-841"></a>We read the first replication of simulated datasets with $N = 100, T = 100$ and plot using the function <span class="in">`plot_dataset.profile`</span> (from @sec-make-distribution-plots).</span>
<span id="cb43-842"><a href="#cb43-842"></a></span>
<span id="cb43-843"><a href="#cb43-843"></a><span class="in">```{r, eval = study_MakeAdditionalPlots}</span></span>
<span id="cb43-844"><a href="#cb43-844"></a><span class="sc">&lt;</span><span class="er">&lt;</span>additional_plots_dataset_profiles<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb43-845"><a href="#cb43-845"></a><span class="in">```</span></span>
<span id="cb43-846"><a href="#cb43-846"></a></span>
<span id="cb43-847"><a href="#cb43-847"></a>::: {.content-visible when-format="html"}</span>
<span id="cb43-848"><a href="#cb43-848"></a>The generated distribution plots of the AR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/profiles-dataset-nar.pdf)</span>, $\chi^2$AR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/profiles-dataset-chiar.pdf)</span>, BinAR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/profiles-dataset-binar.pdf)</span>, and PoDAR(1) <span class="co">[</span><span class="ot">{{&lt; fa file-pdf &gt;}}</span><span class="co">](./figures/profiles-dataset-podar.pdf)</span> models are saved in the figures folder.</span>
<span id="cb43-849"><a href="#cb43-849"></a>:::</span>
<span id="cb43-850"><a href="#cb43-850"></a></span>
<span id="cb43-851"><a href="#cb43-851"></a><span class="fu">## COGITO data analysis {#sec-cogito-data-analysis}</span></span>
<span id="cb43-852"><a href="#cb43-852"></a></span>
<span id="cb43-853"><a href="#cb43-853"></a>In the paper, we reported an analysis of distress time series in of the COGITO dataset @schmiedek_2010_HundredDaysCognitive. Because we are not allowed to make the dataset public, here we provide the *M*plus input script and the analysis output.</span>
<span id="cb43-854"><a href="#cb43-854"></a></span>
<span id="cb43-855"><a href="#cb43-855"></a>::: panel-tabset</span>
<span id="cb43-856"><a href="#cb43-856"></a><span class="fu">### *M*plus input</span></span>
<span id="cb43-857"><a href="#cb43-857"></a></span>
<span id="cb43-860"><a href="#cb43-860"></a><span class="in">```{inp}</span></span>
<span id="cb43-861"><a href="#cb43-861"></a><span class="in">#| label: Mplus-input_cogito-distress</span></span>
<span id="cb43-862"><a href="#cb43-862"></a><span class="in">#| file: scripts/Mplus_cogito-distress.inp</span></span>
<span id="cb43-863"><a href="#cb43-863"></a><span class="in">```</span></span>
<span id="cb43-864"><a href="#cb43-864"></a></span>
<span id="cb43-865"><a href="#cb43-865"></a><span class="fu">### *M*plus output</span></span>
<span id="cb43-866"><a href="#cb43-866"></a></span>
<span id="cb43-869"><a href="#cb43-869"></a><span class="in">```{out}</span></span>
<span id="cb43-870"><a href="#cb43-870"></a><span class="in">#| label: Mplus-output_cogito</span></span>
<span id="cb43-871"><a href="#cb43-871"></a><span class="in">#| file: scripts/Mplus_cogito-distress.out</span></span>
<span id="cb43-872"><a href="#cb43-872"></a><span class="in">```</span></span>
<span id="cb43-873"><a href="#cb43-873"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>